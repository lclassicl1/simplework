<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µì‹ ì‚¬ ì–‘ì‹ ë³€í™˜ê¸°</title>
    <!-- SheetJS ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* ëª¨ë¸ ê²€ìƒ‰ ê²°ê³¼ ìŠ¤íƒ€ì¼ */
        .model-result:hover {
            background-color: #f5f5f5;
        }

        /* ê²€ìƒ‰ ê²°ê³¼ ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        #modelSearchResults::-webkit-scrollbar {
            width: 8px;
        }

        #modelSearchResults::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        #modelSearchResults::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        #modelSearchResults::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Toast Notification Styles */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
            font-size: 14px;
            font-weight: 500;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }

        .layout-container {
            display: flex;
            gap: 20px;
        }

        .input-column {
            flex: 1;
        }

        .output-column {
            flex: 1;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        select, textarea, input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        select {
            background-color: white;
            cursor: pointer;
        }

        textarea {
            resize: vertical;
        }

        .input-textarea {
            min-height: 300px;
        }

        .output-textarea {
            min-height: 300px;
        }
        
        /* ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ ì „ìš© textarea ìŠ¤íƒ€ì¼ */
        .drblack-request-textarea {
            min-height: 150px;  /* ê¸°ì¡´ ë†’ì´ì˜ ì ˆë°˜ */
            height: 150px;      /* ê³ ì • ë†’ì´ ì„¤ì • */
            resize: vertical;   /* ì„¸ë¡œ í¬ê¸° ì¡°ì ˆë§Œ ê°€ëŠ¥í•˜ë„ë¡ */
        }

        /* ì˜¤ì•¤í‹° ì‹ ì¡°ìš”ì²­ ì „ìš© textarea ìŠ¤íƒ€ì¼ */
        #ontRequestText {
            height: 120px !important;
            min-height: 120px;
            resize: vertical;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #convertBtn {
            background-color: #4CAF50;
            color: white;
            flex: 2;
        }

        #convertBtn:hover {
            background-color: #45a049;
        }

        #copyBtn {
            background-color: #2196F3;
            color: white;
            flex: 1;
        }

        #copyBtn:hover {
            background-color: #0b7dda;
        }

        #clearBtn {
            background-color: #f44336;
            color: white;
            flex: 1;
        }

        #clearBtn:hover {
            background-color: #d32f2f;
        }

        #outputText {
            background-color: #f9f9f9;
        }

        .output-section {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .output-section h3 {
            margin-bottom: 10px;
            color: #333;
        }
        
        /* URL ì„ íƒë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .url-container {
            margin-bottom: 20px;
            width: 50%;
            margin-right: auto;
            margin-left: 0;
        }
        
        .url-select {
            width: auto;
            min-width: 200px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            background-color: #f8f9fa;
            cursor: pointer;
        }
        
        /* ëŒ€ë¦¬ì  ë©”ëª¨ íŒì—… ìŠ¤íƒ€ì¼ */
        .info-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 14px;
            cursor: pointer;
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
        }
        
        .info-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .popup-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        /* ì´ë ¥ ëª©ë¡ ìŠ¤íƒ€ì¼ */
        .history-list {
            margin: 10px 0;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .history-item {
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .history-item:hover {
            background-color: #f5f5f5;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .history-name {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .history-phone {
            color: #555;
            flex-grow: 1;
        }
        
        .history-time {
            color: #888;
            font-size: 0.9em;
        }
        
        .history-details {
            margin: 5px 0;
            color: #333;
        }
        
        .history-model {
            display: inline-block;
            margin-right: 10px;
        }
        
        .history-plan {
            color: #2c7be5;
        }
        
        .history-footer {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            color: #666;
        }
        
        .no-history {
            text-align: center;
            padding: 20px;
            color: #888;
        }
        
        .history-actions {
            text-align: right;
            margin-top: 15px;
        }
        
        .btn-clear-history {
            background-color: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .btn-clear-history:hover {
            background-color: #cc0000;
        }
        
        .popup-close {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }
        
        .popup-title {
            margin-top: 0;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .memo-content {
            white-space: pre-line;
            line-height: 1.5;
        }
        
        /* í‚¤-ê°’ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .key-value-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }
        
        .key-value-table th {
            background-color: #f5f5f5;
            padding: 6px 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #ddd;
            width: 30%;
            font-size: 12px;
        }
        
        .key-value-table td {
            padding: 5px 8px;
            border: 1px solid #ddd;
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s;
            font-size: 13px;
            line-height: 1.3;
        }
        
        .key-value-table td:hover {
            background-color: #f0f8ff;
        }
        
        .key-value-table td::after {
            content: "í´ë¦­í•˜ì—¬ ë³µì‚¬";
            position: absolute;
            right: 8px;
            color: #999;
            font-size: 10px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .key-value-table td:hover::after {
            opacity: 1;
        }
        
        .key-value-table td.copied {
            background-color: #e6ffe6;
        }
        
        .key-value-table td.copied::after {
            content: "ë³µì‚¬ë¨!";
            color: #4CAF50;
            opacity: 1;
            font-size: 10px;
        }
        
        .copy-notice {
            text-align: center;
            margin-bottom: 10px;
            color: #666;
            font-style: italic;
            font-size: 12px;
        }

        @media (max-width: 900px) {
            .layout-container {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }

        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ */
        .output-textarea {
            width: 100%;
            min-height: 200px;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: 'Nanum Gothic', sans-serif;
            font-size: 14px;
            resize: vertical;
        }
        
        /* ACT íƒë°°ìš© ì‘ì€ textarea */
        .act-stock-textarea {
            min-height: 100px !important;
            height: 100px !important;
        }

        /* ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        #passwordModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .password-modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            text-align: center;
            min-width: 300px;
        }

        .password-modal-content h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .password-input {
            width: 200px;
            padding: 15px;
            font-size: 18px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
            letter-spacing: 3px;
        }

        .password-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .password-submit {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }

        .password-submit:hover {
            background-color: #45a049;
        }

        .password-error {
            color: #f44336;
            margin-top: 10px;
            font-size: 14px;
        }

        .main-content {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ëª¨ë‹¬ -->
    <div id="passwordModal">
        <div class="password-modal-content">
            <h2>ğŸ”’ ì ‘ê·¼ ì¸ì¦</h2>
            <p>4ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
            <input type="password" id="passwordInput" class="password-input" maxlength="4" placeholder="****" autocomplete="off">
            <br>
            <button onclick="checkPassword()" class="password-submit">í™•ì¸</button>
            <div id="passwordError" class="password-error" style="display: none;"></div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="main-content">
        <div class="container">
        <h1>ì–´ë“œë¯¼ ì–‘ì‹ ë³€í™˜ê¸°</h1>
        
        <div class="url-container" style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; flex-wrap: nowrap; width: 100%;">
            <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                <label for="usefulUrls" style="font-size: 14px; color: #555;">ìœ ìš©í•œ ì‚¬ì´íŠ¸:</label>
                <select id="usefulUrls" onchange="openSelectedUrl()" style="min-width: 200px; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <!-- ì‚¬ì´íŠ¸ ëª©ë¡ì€ ì´ê³³ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </select>
            </div>
            
                          <div style="display: flex; flex-direction: column; gap: 8px; margin-left: 20px;">
                  <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                      <label for="excelFile" style="font-size: 14px; color: #555;">ì–´ë“œë¯¼ ì—‘ì…€ ì²¨ë¶€ë¡œ ì ‘ìˆ˜í™•ì¸/ì‹ ì¡°ìš”ì²­ ì–‘ì‹ ë§Œë“¤ê¸°:</label>
                      <input type="file" id="excelFile" accept=".xlsx, .xls" style="font-size: 14px;"/>
                      <span id="extractCount" style="font-size: 14px; color: #2196F3; margin-left: 10px; font-weight: bold;"></span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                      <label for="excelFile2" style="font-size: 14px; color: #555;">ì–´ë“œë¯¼ ì—‘ì…€ ì²¨ë¶€ë¡œ ë°°ì†¡ìš”ì²­ ì–‘ì‹ ë§Œë“¤ê¸°(ëŒ€ë¦¬ì  ë¨¼ì € ì„ íƒ í•„ìˆ˜)</label>
                      <input type="file" id="excelFile2" accept=".xlsx, .xls" style="font-size: 14px;"/>
                      <span id="extractCount2" style="font-size: 14px; color: #e91e63; margin-left: 10px; font-weight: bold;"></span>
                  </div>
              </div>
            
            <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap; margin-left: auto;">
                <label for="modelSearch" style="font-size: 14px; color: #555;">ëª¨ë¸ ê²€ìƒ‰:</label>
                <div style="position: relative; min-width: 250px;">
                    <input type="text" id="modelSearch" 
                           placeholder="ì˜ˆ: S24, ì•„ì´í°" 
                           style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                    <div id="modelSearchResults" style="display: none; position: absolute; top: 100%; left: 0; right: 0; 
                          background: white; border: 1px solid #ddd; border-radius: 4px; max-height: 300px; 
                          overflow-y: auto; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="layout-container">
            <!-- ì…ë ¥ ì»¨í…Œì´ë„ˆ (ì™¼ìª½ ì˜ì—­) -->
            <div class="input-column">
                <div class="form-row">
                    <div class="form-group">
                        <label for="telecom">í†µì‹ ì‚¬ ì„ íƒ:</label>
                        <select id="telecom" onchange="updateAgencies()">
                            <option value="">í†µì‹ ì‚¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="SK">SK</option>
                            <option value="KT">KT</option>
                            <option value="LG">LG</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="agency">ëŒ€ë¦¬ì  ì„ íƒ:</label>
                        <div style="display: flex; align-items: center;">
                            <select id="agency" disabled>
                                <option value="">ëŒ€ë¦¬ì ì„ ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                            <button type="button" id="agencyInfoBtn" class="info-button" onclick="showAgencyInfo()" disabled>i</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="deviceSerial">ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸:</label>
                        <input type="text" id="deviceSerial" class="form-control" placeholder="ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div class="form-group">
                        <label for="simSerial">ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸:</label>
                        <input type="text" id="simSerial" class="form-control" placeholder="ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="inputText">ì›ë³¸ í…ìŠ¤íŠ¸:</label>
                    <textarea id="inputText" class="input-textarea" placeholder="ì—¬ê¸°ì— ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                
                <div class="button-group">
                    <button id="convertBtn" onclick="convertFormat()">ë³€í™˜í•˜ê¸°</button>
                    <button id="historyBtn" onclick="openHistoryPopup()">ë³€í™˜ë‚´ì—­ì¡°íšŒ</button>
                    <button id="clearBtn" onclick="clearAll()">ëª¨ë‘ ì§€ìš°ê¸°</button>
                </div>
            </div>
            
            <!-- ì¶œë ¥ ì»¨í…Œì´ë„ˆ (ì˜¤ë¥¸ìª½ ì˜ì—­) -->
            <div class="output-column">
                <div id="outputContainer" style="display: block;">
                    <!-- ëŸ­ìŠ¤ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ ) -->
                    <div id="luxExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="luxRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxMemoText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxStockText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë“œë¸”ë™ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ) -->
                    <div id="dblackExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="dblackRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    <style>
                        #luxRequestText {
                            height: 130px !important;
                            min-height: 130px;
                            resize: vertical;
                        }
                        #luxStockText {
                            height: 220px !important;
                            min-height: 220px;
                            resize: vertical;
                        }
                        #luxMemoText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        /* ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ textarea ìŠ¤íƒ€ì¼ */
                        #dblackRequestText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #outputText1 {
                            height: 170px !important;
                            min-height: 170px;
                        }
                        
                        /* íœ´ë„· textarea ìŠ¤íƒ€ì¼ */
                        #hunetConfirmText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #hunetDeliveryText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #hunetOpenText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        
                        /* ë°€ë¦¬ì–¸ textarea ìŠ¤íƒ€ì¼ */
                        #millionRequestText {
                            height: 100px !important;
                            min-height: 100px;
                            resize: vertical;
                        }
                        
                        /* ë°€ë¦¬ì–¸ ë°°ì •ìš”ì²­ textarea ìŠ¤íƒ€ì¼ (ì ˆë°˜ í¬ê¸°) */
                        #millionStockText {
                            height: 100px !important;
                            min-height: 100px;
                            resize: vertical;
                        }
                    </style>
                    <div id="singleOutputContainer">
                        <div class="form-group">
                            <label id="outputTextLabel" for="outputText">ë³€í™˜ëœ í…ìŠ¤íŠ¸:</label>
                            <textarea id="outputText" class="output-textarea"></textarea>
                        </div>
                    </div>
                    
                    <div id="splitOutputContainer" style="display: none;">
                    </div>
                    
                    <!-- ACT(íƒë°°) ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸/ê°œí†µìš”ì²­) -->
                    <div id="actExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="actStockText">ACT(íƒë°°) ì ‘ìˆ˜í™•ì¸ì–‘ì‹:</label>
                            <textarea id="actStockText" class="output-textarea compact-textarea act-stock-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="actOpenText">ACT(íƒë°°) ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="actOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë¹„ì•¤ì»´ ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸&ì‹ ì¡°ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="bncomExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="bncomStockText">ë¹„ì•¤ì»´ ì ‘ìˆ˜í™•ì¸&ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="bncomStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="bncomOpenText">ë¹„ì•¤ì»´ ê°œí†µìš”ì²­:</label>
                            <textarea id="bncomOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- íœ´ë„· ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸/ë°°ì†¡ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="hunetExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="hunetConfirmText">íœ´ë„· ì ‘ìˆ˜í™•ì¸ì–‘ì‹:</label>
                            <textarea id="hunetConfirmText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hunetDeliveryText">íœ´ë„· ë°°ì†¡ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hunetDeliveryText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hunetOpenText">íœ´ë„· ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hunetOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë°€ë¦¬ì–¸ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°ìš”ì²­/ë°°ì •ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="millionExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="millionRequestText">ë°€ë¦¬ì–¸ ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="millionRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="millionStockText">ë°€ë¦¬ì–¸ ë°°ì •ìš”ì²­:</label>
                            <textarea id="millionStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="millionMemoText">ë°€ë¦¬ì–¸ ê°œí†µìš”ì²­:</label>
                            <textarea id="millionMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ì˜¤ì•¤í‹° ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°ìš”ì²­/ë°°ì •ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="ontExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="ontRequestText">ì˜¤ì•¤í‹° ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="ontRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="ontStockText">ì˜¤ì•¤í‹° ë°°ì •ìš”ì²­:</label>
                            <textarea id="ontStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="ontMemoText">ì˜¤ì•¤í‹° ê°œí†µìš”ì²­:</label>
                            <textarea id="ontMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ì¥ì²œ ì „ìš© ì¶”ê°€ textarea (ë°°ì†¡ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="jangcheonExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="jangcheonDeliveryText">ì¥ì²œ ë°°ì†¡ìš”ì²­:</label>
                            <textarea id="jangcheonDeliveryText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="jangcheonOpenText">ì¥ì²œ ê°œí†µìš”ì²­:</label>
                            <textarea id="jangcheonOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <div id="keyValueTableContainer" style="display: none;">
                        <div class="copy-notice">ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.</div>
                        <table class="key-value-table" id="keyValueTable">
                            <tbody>
                                <!-- í‚¤-ê°’ í–‰ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- ì–‘ì‹ì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš°ë¥¼ ìœ„í•œ í…œí”Œë¦¿ -->
                <div id="splitOutputTemplate" style="display: none;">
                    <div class="output-section">
                        <h3>ì¬ê³ ìš”ì²­:</h3>
                        <textarea id="outputText1" class="output-textarea"></textarea>
                    </div>
                    <div class="output-section">
                        <h3>ê°œí†µìš”ì²­:</h3>
                        <textarea id="outputText2" class="output-textarea"></textarea>
                    </div>
                </div>
                
                <!-- í‚¤-ê°’ í…Œì´ë¸” í…œí”Œë¦¿ -->
                <div id="keyValueTableTemplate" style="display: none;">
                    <div class="copy-notice">ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.</div>
                    <table class="key-value-table" id="keyValueTable">
                        <tbody>
                            <!-- í‚¤-ê°’ í–‰ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast">í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
    
    <!-- ë³€í™˜ ì´ë ¥ íŒì—… -->
    <div id="historyPopup" class="popup-overlay">
        <div class="popup-content" style="max-width: 800px;">
            <span class="popup-close" onclick="closeHistoryPopup()">&times;</span>
            <h3 class="popup-title">ë³€í™˜ ì´ë ¥</h3>
            <div id="historyList" class="history-list">
                <!-- ì´ë ¥ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            <div class="history-actions">
                <button onclick="clearHistory()" class="btn-clear-history">ì „ì²´ ì‚­ì œ</button>
            </div>
        </div>
    </div>
    
    <!-- ëŒ€ë¦¬ì  ë©”ëª¨ íŒì—… -->
    <div id="memoPopup" class="popup-overlay">
        <div class="popup-content">
            <span class="popup-close" onclick="closeAgencyInfo()">&times;</span>
            <h3 class="popup-title" id="popupTitle">ëŒ€ë¦¬ì  ì—…ë¬´ ë©”ëª¨</h3>
            <div class="memo-content" id="memoContent"></div>
        </div>
    </div>
    
    <script>
        // í†µì‹ ì‚¬ë³„ ëŒ€ë¦¬ì  ëª©ë¡
        const agencies = {
            'SK': ['íë¸Œ', 'ëŸ­ìŠ¤', 'ë‚˜í…”', 'ë°€ë¦¬ì–¸', 'ë“œë¸”ë™', 'ì¹´íŒŒ', 'ì‚¼ë³´(ì˜¨ë¼ì¸)', 'ì¥ì²œ', 'ì‚¼ë³´/ì— ë””ë„ë§¤', 'ì½”ì›¨ì–´', 'ACT(íƒë°°)', 'ë¹„ì•¤ì»´', 'ì´ì•¤í‹°'],
            'KT': ['ì˜¤ì•¤í‹°', 'ì¬í¬', 'ì•ˆì‚°/ì´ìŠ¤í„´','ì‹ ì²­ì„œì—°ì¥ì–‘ì‹'],
            'LG': ['ì†Œë¦¬', 'ì œì´/íœ´ë„·','ì‹ ì²­ì„œì—°ì¥ì–‘ì‹']
        };
        
        // ëŒ€ë¦¬ì ë³„ ì—…ë¬´ ë©”ëª¨
        const agencyMemos = {
            'SK': {
                'íë¸Œ': `[íë¸Œ ì—…ë¬´ ë©”ëª¨]
ì–´ë“œë¯¼ëŒ€ë¦¬ì ì„¤ì • : SKíë¸Œ
â–  SK3ë²ˆ ì¶”ì²œì¸ì½”ë“œ				
- 100201 ì…ë ¥ í•„ìˆ˜				
ì‹ ì¡° ë° ê°œí†µ ìš”ì²­ ì´ì „ì— ì¶”ì²œì¸ì½”ë“œ í•„ìˆ˜ ì…ë ¥ !!!!!

â–  ì—…ë¬´ íë¦„ â–     
ì ‘ìˆ˜í™•ì¸->ì‹ ì¡°->ë°°ì •ìš”ì²­					
ê°œí†µìš”ì²­ì‹œ ê°œí†µ ë©”ëª¨ ì‹ ì²­ë‚´ì—­ì— ì¼ë ¨+ìœ ì‹¬ ê¸°ì¬í›„					
ìŠ¤ìœ™ì „ì†¡

â–  í‹°ê²Œì´íŠ¸ ì‹ ì¡° ìš”ì²­ì‹œ â– 

ì§€ì _ì ‘ìˆ˜ì™„ë£Œ -íƒ­ ë³€ê²½				
ì‹ ìš© ì´ìƒ ì—†ì„ì‹œ - ì ‘ìˆ˜ì™„ë£Œ				
ì‹ ìš© ì´ìƒ ìˆì„ì‹œ - ë°°ì†¡ë³´ë¥˜				
**ê°„í˜¹ ì ‘ìˆ˜ì™„ë£Œì—¬ë„ ì‹ ì¡°ì •ìƒì´ ì•„ë‹Œê²½ìš°ê°€ ìˆìŒ				

â–  íë¸Œ ì£¼ì†Œ â– 
ê²½ê¸°ë„ ê³ ì–‘ì‹œ ì¼ì‚°ë™êµ¬ ì¤‘ì•™ë¡œ1261ë²ˆê¸¸ 77 í•œì‹ ë©”íŠ¸ë¡œí´ë¦¬ìŠ¤ 702í˜¸	/ 010-7591-0800			`,

                'ëŸ­ìŠ¤': `[ëŸ­ìŠ¤ ì—…ë¬´ ë©”ëª¨]
1. ì¬ê³ í‘œëŠ” ëŸ­ìŠ¤ ì—…ë¬´ ì¹´ì¹´ì˜¤í†¡ë°©ì—ì„œ í™•ì¸ ê°€ëŠ¥
2. ì–´ë“œë¯¼ëŒ€ë¦¬ì ì„¤ì • : ìœ ìŠ¤í€˜ì–´(íœíƒ€ê³¤)
3. í‹°ê²Œì´íŠ¸ ID/PW

ëŸ­ìŠ¤(JNJ) - ì¸ì¦ì”¨íˆ¬ë¹„		
ì•„ì´ë”” :ctr077		
ë¹„ë²ˆ : qwerqwer!!`,

                'ë‚˜í…”': `[ë‚˜í…” ì—…ë¬´ ë©”ëª¨]
1. í‹°ê²Œì´íŠ¸ ì•„ì´ë”” ë¹„ë²ˆ
    ì•„ì´ë”” : NATEL12345		
    ë¹„ë°€ë²ˆí˜¸ aa2580@@		
    ì¸ì¦ë²ˆí˜¸ í™•ì¸:ë¼ì˜¨ì•„ì´ í†µí•´ì„œ í™•ì¸
2. â˜…íƒë°° 4ì‹œ ë§ˆê° / CJ íƒë°°
3. â˜…ê°œí†µìš”ì²­ì€ 5ì‹œ 30ë¶„ê¹Œì§€
4. ë‚˜í…”ì£¼ì†Œ:ì„œìš¸ ê°•ë‚¨êµ¬ ì²­ë‹´ë™ 55-10 ë‹¨ë… / 1670-6993
5. â˜…ì„ ì•½ 24ê°œì›”ë§Œ ê°œí†µê°€ëŠ¥(12ê°œì›”ë¶ˆê°€)
6. â˜…ì•ˆë“œë¡œë©”ë‹¤ëŠ” ì „ëª¨ë¸ ë‚˜í…”ë¡œ ì ‘ìˆ˜ ë¶ˆê°€
7. ì–´ë“œë¯¼ ëŒ€ë¦¬ì  ì§€ì • : SKë‚˜í…”`,

                'ë°€ë¦¬ì–¸': `[ë°€ë¦¬ì–¸ ì—…ë¬´ ë©”ëª¨]
1. ì‚¬ì´íŠ¸ ID/PW
    ID:raon010
    PW:1124
    2ì°¨ PW:2023
2. â˜…ìš°ì²´êµ­íƒë°° / íƒë°°ë§ˆê° 4ì‹œ							
    â˜…ì¡°íšŒë° ê°œí†µ ìš”ì²­ ê°€ëŠ¥ì‹œê°„ : 5ì‹œ 30ë¶„ê¹Œì§€			
    *ë°€ë¦¬ì–¸ì£¼ì†Œ:ì†¡íŒŒêµ¬ ë°±ì œê³ ë¶„ë¡œ 19ê¸¸ 3, HCë¹Œë”© 2ì¸µ ë°€ë ˆë‹ˆì—„í†µì‹ / 070-7455-6672
3. íŠ¹ë³„ í• ì¸: ì„ íƒì•½ì • 25% + ì¶”ê°€ 5% (ì¡°ê±´ë¶€)
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-345-6789 (ë‹´ë‹¹ì: ì´ë°€ë¦¬ì–¸)
5. íŠ¹ì´ì‚¬í•­: í”„ë¦¬ë¯¸ì—„ ìš”ê¸ˆì œ ê°€ì… ì‹œ ì¶”ê°€ í˜œíƒ ì œê³µ`,

                'ë“œë¸”ë™': `[ë“œë¸”ë™ ì—…ë¬´ ë©”ëª¨]
â˜…MNO ê°œí†µì§€ì—°ìˆìŒâ˜…					
â˜…ê°œí†µí›„ ìš°ì£¼íŒ¨ìŠ¤ ë³„ë„ ìš”ì²­â˜…					
â˜†ê·¸ì™¸ í•„ìš” ë©”ëª¨ëŠ” ì¹´í†¡ë°© í†¡ê²Œì‹œíŒì— ë“±ë¡ ë˜ìˆìŒ					
					
**ë“œë¸”ë™ ì£¼ì†Œ :ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ì‹ ì‚¬ë™ 590-9 ì‚¼ë¥­ë¹Œë”© 5ì¸µ					
ë°•ì§€ì„± / 010-6234-4450 / í•œìš°ì„ 010-3851-5874`,

                'ì¹´íŒŒ': `[ì¹´íŒŒ ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ì‹œê°„: í‰ì¼ 9:00 ~ 17:30
2. ë‹¨ë§ê¸° ë°°ì†¡: ìµì¼ ë°°ì†¡ (ì˜¤í›„ 3ì‹œ ì´ì „ ì£¼ë¬¸ ê±´)
3. í”„ë¡œëª¨ì…˜ ì½”ë“œ: SK-KAP-2025
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-567-8901 (ë‹´ë‹¹ì: ì •ì¹´íŒŒ)
5. íŠ¹ì´ì‚¬í•­: ë²•ì¸ ê³ ê° ì „ìš© í• ì¸ í”„ë¡œê·¸ë¨ ìš´ì˜ ì¤‘`,

                'ì‚¼ë³´(ì˜¨ë¼ì¸)': `[ì‚¼ë³´(ì˜¨ë¼ì¸) ì—…ë¬´ ë©”ëª¨]
1. í‹°ê²Œì´íŠ¸ ì•„ì´ë”” / ë¹„ë²ˆ
   D135420001
   dlwnsghks1!(ì´ì¤€í™˜1!)`,

                'ì¥ì²œ': `[ì¥ì²œ ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ë§ˆê°: í‰ì¼ 17:00
2. ë‹¨ë§ê¸° ì¬ê³  ë¬¸ì˜: ì¹´ì¹´ì˜¤í†¡ ì±„ë„ @ì¥ì²œëª¨ë°”ì¼
3. í”„ë¡œëª¨ì…˜ ì½”ë“œ: SK-JC-2025
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-678-9012 (ë‹´ë‹¹ì: í•œì¥ì²œ)
5. íŠ¹ì´ì‚¬í•­: ì§€ë°© ë°°ì†¡ ì‹œ ì¶”ê°€ 1ì¼ ì†Œìš”`,

                'ì‚¼ë³´/ì— ë””ë„ë§¤': `[ì‚¼ë³´/ì— ë””ë„ë§¤ ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ì‹œê°„: í‰ì¼ 9:00 ~ 18:00
2. ëŒ€ëŸ‰ ì£¼ë¬¸(10ëŒ€ ì´ìƒ) ì‹œ ì‚¬ì „ ì—°ë½ í•„ìˆ˜
3. í”„ë¡œëª¨ì…˜ ì½”ë“œ: SK-SMD-2025
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-789-0123 (ë‹´ë‹¹ì: ê°•ì‚¼ë³´)
5. íŠ¹ì´ì‚¬í•­: B2B ì „ìš© í• ì¸ í”„ë¡œê·¸ë¨ ìš´ì˜ ì¤‘`,
                
                'ì½”ì›¨ì–´': `[ì½”ì›¨ì–´ ì—…ë¬´ ë©”ëª¨]
ì–´ë“œë¯¼ ëŒ€ë¦¬ì  ì„¤ì • : SK ì½”ì›¨ì–´(ì¥ìš©ë²”ì‚¬ì¥)

í‹°ê²Œì´íŠ¸ ì•„ì´ë””ë¹„ë²ˆ		
ES0029		
dodam8989!

**í‹°ê²Œì´íŠ¸ ê°œí†µë©”ëª¨ ë„£ê³  ìŠ¤ìœ™ì „ì†¡ í•´ì•¼í•¨ **

â˜…ê°œí†µê¸°ì¤€ì •ì±… â˜…

í‹°ê²Œì´íŠ¸ ì ‘ìˆ˜ê±´ì€ ê°œí†µì²˜ì—ì„œ ì‹ ì¡° í•´ì¤Œ // í‹°ê²Œì´íŠ¸ ë©”ëª¨ ë³´ë©´ ì•Œìˆ˜ ìˆìŒ

ìš°ì£¼íŒ¨ìŠ¤ë§í¬				
https://tworldfriends.co.kr/D009890000/sktuniverse/NM00000179`,
                'ACT(íƒë°°)': `[ACT(íƒë°°) ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ì‹œê°„: í‰ì¼ 9:00 ~ 18:00
2. ë‹¨ë§ê¸° ë°°ì†¡: ì „êµ­ ìµì¼ ë°°ì†¡
3. ë¬¸ì˜ ì—°ë½ì²˜: 02-123-4567 (ë‹´ë‹¹ì: íƒë°°íŒ€)
4. íŠ¹ì´ì‚¬í•­: íƒë°° ë°°ì†¡ ì‹œ ì£¼ì†Œ ì •í™•íˆ ê¸°ì¬`,

                'ë¹„ì•¤ì»´': `[ë¹„ì•¤ì»´ ì—…ë¬´ ë©”ëª¨]
1. ì£¼ì†Œ :ì„œìš¸ ì„±ë™êµ¬ ì•„ì°¨ì‚°ë¡œ7ë‚˜ê¸¸18, 706í˜¸  / 1522-0689
2. ë¯¸ì„±ë…„ìëŠ” ê°€ì¡±ê´€ê³„ì¦ëª…ì„œê°€ í•„ìš” / ë§Œ 65ì„¸ì´ìƒ ê³ ì—°ë ¹ ì§„í–‰ë¶ˆê°€/íƒë°°ë§Œ ê°€ëŠ¥(ìš°ì²´êµ­) / ì™¸êµ­ì¸ / ë²•ì¸ ê°œí†µ ë¶ˆê°€
3. í‹°ê²Œì´íŠ¸ ê³µì‹ì‹ ì²­ì„œ ì ‘ìˆ˜ í™•ì¸O/ì¹´í†¡O (ì‹ ì¡°ëŠ” ì¹´í†¡ìœ¼ë¡œ/ì¹´í†¡ìœ¼ë¡œ ì ‘ìˆ˜í™•ì¸/ì‹ ì¡° ë‘˜ë‹¤ ê°€ëŠ¥)`,

                'ì´ì•¤í‹°': `[ì´ì•¤í‹° ì—…ë¬´]
1. í‹°ê²Œì´íŠ¸ í™•ì¸ë¶ˆê°€ / í‹°ê²Œì´íŠ¸ ì¡°íšŒë¡œ ì ‘ìˆ˜ í™•ì¸ or ê°œí†µì²˜ í†µí•´ ì ‘ìˆ˜ í™•ì¸ ê°€ëŠ¥
2. ***ì˜¨ë¼ì¸ê±´ì€ ë‹¹ì¼ ì ‘ìˆ˜ ë‹¹ì¼ ê°œí†µ*** (ì¼ìš”ì¼ ì œì™¸)`
            },
            'KT': {
                'ì˜¤ì•¤í‹°': `[ì˜¤ì•¤í‹° ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ë§ˆê°: í‰ì¼ 17:30
2. ë‹¨ë§ê¸° ë°°ì†¡: ë‹¹ì¼ ë°°ì†¡ (ì •ì˜¤ ì´ì „ ì£¼ë¬¸ ê±´)
3. í”„ë¡œëª¨ì…˜ ì½”ë“œ: KT-ONT-2025
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-890-1234 (ë‹´ë‹¹ì: ì˜¤ì•¤í‹°)
5. íŠ¹ì´ì‚¬í•­: KT í”„ë¦¬ë¯¸ì—„ ìš”ê¸ˆì œ ê°€ì… ì‹œ ì¶”ê°€ í• ì¸`,

                'ì¬í¬': `[ì¬í¬ ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ì‹œê°„: í‰ì¼ 9:00 ~ 18:30
2. ë‹¨ë§ê¸° ì¬ê³  í™•ì¸: í™ˆí˜ì´ì§€ì—ì„œ ì‹¤ì‹œê°„ í™•ì¸ ê°€ëŠ¥
3. í”„ë¡œëª¨ì…˜ ì½”ë“œ: KT-JH-2025
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-901-2345 (ë‹´ë‹¹ì: ê¹€ì¬í¬)
5. íŠ¹ì´ì‚¬í•­: 5ì›” í”„ë¡œëª¨ì…˜ - ì•„ì´í° ì‹œë¦¬ì¦ˆ íŠ¹ë³„ í• ì¸`,

                'ì•ˆì‚°/ì´ìŠ¤í„´': `[ì•ˆì‚°/ì´ìŠ¤í„´ ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ë§ˆê°: í‰ì¼ 17:00
2. ë‹¨ë§ê¸° ë°°ì†¡: ìˆ˜ë„ê¶Œ ì§€ì—­ ë‹¹ì¼ ë°°ì†¡ ê°€ëŠ¥
3. í”„ë¡œëª¨ì…˜ ì½”ë“œ: KT-AS-2025
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-012-3456 (ë‹´ë‹¹ì: ì´ì•ˆì‚°)
5. íŠ¹ì´ì‚¬í•­: ê¸°ì—… ê³ ê° ì „ìš© ìƒë‹´ ì±„ë„ ìš´ì˜ ì¤‘`,

                'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹': {
                    name: 'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹',
                    type: 'normal',
                    outputType: 'single',
                    memo: '',
                    template: (info) => `${info.ê³ ê°ëª… || ''} / ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''} / ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}`
                }
            },
            'LG': {
                'ì†Œë¦¬': `[ì†Œë¦¬ ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ì‹œê°„: í‰ì¼ 9:00 ~ 19:00
2. ë‹¨ë§ê¸° ë°°ì†¡: ì „êµ­ ìµì¼ ë°°ì†¡
3. í”„ë¡œëª¨ì…˜ ì½”ë“œ: LG-SR-2025
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-123-4567 (ë‹´ë‹¹ì: ë°•ì†Œë¦¬)
5. íŠ¹ì´ì‚¬í•­: LG ì „ìš© ìš”ê¸ˆì œ ê°€ì… ì‹œ ì¶”ê°€ í˜œíƒ`,

                'ì œì´/íœ´ë„·': `[ì œì´/íœ´ë„· ì—…ë¬´ ë©”ëª¨]
1. ê°œí†µ ìš”ì²­ ë§ˆê°: í‰ì¼ 18:00
2. ë‹¨ë§ê¸° ì¬ê³  í™•ì¸: ì˜¤ì „ 9ì‹œ, ì˜¤í›„ 2ì‹œ ì—…ë°ì´íŠ¸
3. í”„ë¡œëª¨ì…˜ ì½”ë“œ: LG-JH-2025
4. ë¬¸ì˜ ì—°ë½ì²˜: 02-234-5678 (ë‹´ë‹¹ì: ìµœì œì´)
5. íŠ¹ì´ì‚¬í•­: ì„ íƒì•½ì • 25% ê°€ì… ì‹œ ì¶”ê°€ ì‚¬ì€í’ˆ ì œê³µ`,

                'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹': {
                    name: 'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹',
                    type: 'normal',
                    outputType: 'single',
                    memo: '',
                    template: (info) => `${info.ê³ ê°ëª… || ''} / ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''} / ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}`
                }
            }
        };

        // ëŒ€ë¦¬ì ë³„ ì–‘ì‹ í…œí”Œë¦¿ (ë ˆê±°ì‹œ - ì‚¬ìš© ì•ˆí•¨)
        const templates = {
            'SK': {
                'íë¸Œ': (info) => {
                    // ì´ë¦„ ì²˜ë¦¬
                    const name = info['ê°€ì…ìëª…'] || info['ê³ ê°ëª…'] || '';
                    // ì—°ë½ì²˜ ì²˜ë¦¬
                    const contact = info['ê°œí†µë²ˆí˜¸'] || info['ì „í™”ë²ˆí˜¸'] || '';
                    // ì£¼ì†Œ ì²˜ë¦¬
                    const address = info['íƒë°°ì£¼ì†Œ'] || info['ë°°ì†¡ì£¼ì†Œì§€'] || '';
                    // í†µì‹ ì‚¬/ì¸ì¦ ì²˜ë¦¬
                    const telecom = info['í˜„ì¬í†µì‹ ì‚¬'] || '';
                    // í• ë¶€ì›ê¸ˆ ì²˜ë¦¬
                    let paymentInfo = '';
                    if (info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í˜„ê¸ˆ') {
                        paymentInfo = 'â˜…í˜„ê¸ˆì™„ë‚©';
                    } else {
                        paymentInfo = info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] + ' ' + info['ìµœì¢…êµ¬ë§¤ê°€'] + 'ì›';
                    }
                    
                    // ì¬ê³ ìš”ì²­ ì–‘ì‹
                    const stockRequest = `â˜…ì¬ê³ ìš”ì²­(SK3)
íƒë°°orí€µ :	
ì´ë¦„: ${name}
ì—°ë½ì²˜ : ${contact}
ì£¼ì†Œ : ${address}
ìœ ì‹¬ : ${info['ìœ ì‹¬'] || ''}
ëª¨ë¸ëª… : ${info['ëª¨ë¸ëª…'] || ''}
ìƒ‰ìƒ : ${info['ìƒ‰ìƒ'] || ''}`;
                    
                    // ê°œí†µìš”ì²­ ì–‘ì‹
                    const openRequest = `â– SK3 ê°œí†µìš”ì²­		
â— ê³ ê°ëª… / ë²ˆí˜¸ : ${name} / ${contact}	
â— ì£¼ë¯¼ë²ˆí˜¸ : ${info['ì£¼ë¯¼ë²ˆí˜¸'] || info['ìƒë…„ì›”ì¼'] || ''}	
â— í†µì‹ ì‚¬/ì¸ì¦ : ${telecom}	
â— ëª¨ë¸/ìƒ‰ìƒ : ${info['ëª¨ë¸ëª…'] || ''} / ${info['ìƒ‰ìƒ'] || ''}	
â— ì¼ë ¨ë²ˆí˜¸ : ${info['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || ''}	
â— ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ : ${info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || ''}	
â— ìœ ì‹¬ë¹„ìš©:	${info['ìœ ì‹¬'] || ''}	
â— ìš”ê¸ˆì œ / í˜œíƒ : ${info['ìš”ê¸ˆì œ'] || ''}	
â— ê³µì‹œì§€ì›ê¸ˆ : ${info['ê³µì‹œ'] || '0'}	
â— ì¶”ì§€(15%) : ${info['ì¶”ì§€'] || '0'}	${info['ì „í™˜ì§€ì›ê¸ˆ'] && info['ì „í™˜ì§€ì›ê¸ˆ'] !== '0' ? `
â— ì „í™˜ì§€ì›ê¸ˆ : ${info['ì „í™˜ì§€ì›ê¸ˆ']}	` : ''}
â— ê³ ê°ì„ ë‚© : ${info['í”„ë¦¬í• ë¶€'] || '0'}	
â— í• ë¶€ì›ê¸ˆ : ${paymentInfo}		
â— ì•½ì •ìœ í˜• : ${info['ê³µì‹œì„ ì•½ì—¬ë¶€'] || ''} ${info['ì•½ì •ê°œì›”ìˆ˜'] || ''}	
â— ë¶€ê°€ì„œë¹„ìŠ¤ : ${info['ë¶€ê°€ì„œë¹„ìŠ¤'] || ''}`;
                    
                    return { stockRequest, openRequest };
                },
                'ëŸ­ìŠ¤': (info) => {
                    // ê¸°ë³¸ ì •ë³´ ì²˜ë¦¬
                    const name = info['ê°€ì…ìëª…'] || info['ê³ ê°ëª…'] || '';
                    const contact = info['ê°œí†µë²ˆí˜¸'] || info['ì „í™”ë²ˆí˜¸'] || '';
                    const modelColor = `${info['ëª¨ë¸ëª…'] || ''} / ${info['ìƒ‰ìƒ'] || ''} / ${info['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || ''}`;
                    const plan = info['ìš”ê¸ˆì œ'] || '';
                    const subscriptionType = info['ê°€ì…ìœ í˜•'] || '';
                    
                    // ê°€ì…ìœ í˜•ì— ë”°ë¥¸ ì ‘ë‘ì‚¬ ê²°ì •
                    let prefix = '';
                    if (['ê¸°ê¸°ë³€ê²½', 'ë³´ìƒê¸°ë³€', 'ê¸°ë³€'].includes(subscriptionType)) {
                        prefix = 'ê¸°ë³€';
                    } else if (['ë²ˆí˜¸ì´ë™', 'ë²ˆì´'].includes(subscriptionType)) {
                        prefix = 'ë²ˆì´';
                    } else if (['ì‹ ê·œê°€ì…', 'ì‹ ê·œ'].includes(subscriptionType)) {
                        prefix = 'ì‹ ê·œ';
                    }
                    
                    // ì£¼ë¯¼ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ (ë²ˆí˜¸ì´ë™ ë˜ëŠ” ì‹ ê·œê°€ì…ì¸ ê²½ìš°ì—ë§Œ)
                    const jumin = info['ì£¼ë¯¼ë²ˆí˜¸'] || info['ìƒë…„ì›”ì¼'] || '';
                    let juminError = '';
                    if (['ë²ˆí˜¸ì´ë™', 'ë²ˆì´', 'ì‹ ê·œê°€ì…', 'ì‹ ê·œ'].includes(subscriptionType)) {
                        const juminRegex = /^\d{6}-?\d{7}$/;
                        if (!juminRegex.test(jumin)) {
                            juminError = '\nâ€» ë²ˆí˜¸ì´ë™/ì‹ ê·œê°€ì…ì‹œ ì£¼ë¯¼ë²ˆí˜¸ ì „ì²´ê°€ í•„ìš”í•©ë‹ˆë‹¤.';
                        }
                    }
                    
                    // ì‹ ì¡°ìš”ì²­ì–‘ì‹
                    const request = `[${prefix} ì‹ ì¡°ìš”ì²­í›„ ìœ í‚¤ë°˜ë ¤]
ì—…ì²´ëª…: ì—ì´ì¹˜ì—˜
ê³ ê°ëª…: ${name}
ì „í™”ë²ˆí˜¸: ${contact}
ì£¼ë¯¼ë²ˆí˜¸: ${jumin}${juminError}`;
                    
                    // ì¬ê³ ìš”ì²­ ì–‘ì‹ (ê¸°ì¡´ í…œí”Œë¦¿ ìœ ì§€)
                    let stock = '';
                    if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ê³µì‹œì§€ì›' && info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í˜„ê¸ˆ') {
                        stock = `íŒë§¤ì ëª… :	 ì—ì´ì¹˜ì—˜
ê³ ê°ëª… :	${name}	
ê°œí†µë²ˆí˜¸ :	${contact}	
ëª¨ë¸ëª… / ìƒ‰ìƒ / ì¼ë ¨ë²ˆí˜¸ :	${modelColor}	
ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ :	${info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || ''}	
ìš”ê¸ˆì œëª…(í˜œíƒ) :	${plan}	
ê°œí†µìœ í˜• :	${subscriptionType}	
ê³µì‹œ ${info['ì•½ì •ê°œì›”ìˆ˜'] || '24ê°œì›”'}		
í˜„ê¸ˆì™„ë‚©		
		
ì¶œê³ ê°€ ${info['ì¶œê³ ê°€'] || ''}
ê³µì‹œì§€ì› ${info['ê³µì‹œ'] || ''}
ì¶”ê°€ì§€ì› ${info['ì¶”ì§€'] || ''}${info['ì „í™˜ì§€ì›ê¸ˆ'] && info['ì „í™˜ì§€ì›ê¸ˆ'] !== '0' ? `
ì „í™˜ì§€ì›ê¸ˆ ${info['ì „í™˜ì§€ì›ê¸ˆ']}` : ''}
ìµœì¢…êµ¬ë§¤ê°€ ${info['ìµœì¢…êµ¬ë§¤ê°€'] || ''}
		
ë³´í—˜ / ë¶€ê°€ì„œë¹„ìŠ¤ : ${info['ë¶€ê°€ì„œë¹„ìŠ¤'] || ''}`;
                    } else if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ê³µì‹œì§€ì›' && info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í• ë¶€') {
                        stock = `íŒë§¤ì ëª… :	 ì—ì´ì¹˜ì—˜
ê³ ê°ëª… :	${name}	
ê°œí†µë²ˆí˜¸ :	${contact}	
ëª¨ë¸ëª… / ìƒ‰ìƒ / ì¼ë ¨ë²ˆí˜¸ :	${modelColor}	
ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ :	${info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || ''}	
ìš”ê¸ˆì œëª…(í˜œíƒ) :	${plan}	
ê°œí†µìœ í˜• :	${subscriptionType}	
ê³µì‹œ ${info['ì•½ì •ê°œì›”ìˆ˜'] || '24ê°œì›”'}		
í• ë¶€ ${info['í• ë¶€ê°œì›”ìˆ˜'] || '24ê°œì›”'}		
		
ì¶œê³ ê°€ ${info['ì¶œê³ ê°€'] || ''}
ê³µì‹œì§€ì› ${info['ê³µì‹œ'] || ''}
ì¶”ê°€ì§€ì› ${info['ì¶”ì§€'] || ''}${info['ì „í™˜ì§€ì›ê¸ˆ'] && info['ì „í™˜ì§€ì›ê¸ˆ'] !== '0' ? `
ì „í™˜ì§€ì›ê¸ˆ ${info['ì „í™˜ì§€ì›ê¸ˆ']}` : ''}
í”„ë¦¬í• ë¶€ ${info['í”„ë¦¬í• ë¶€'] || ''}
ìµœì¢…êµ¬ë§¤ê°€ ${info['ìµœì¢…êµ¬ë§¤ê°€'] || ''}
		
ë³´í—˜ / ë¶€ê°€ì„œë¹„ìŠ¤ : ${info['ë¶€ê°€ì„œë¹„ìŠ¤'] || ''}`;
                    } else if ((info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ íƒì•½ì •' || info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ ì•½') && info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í˜„ê¸ˆ') {
                        stock = `íŒë§¤ì ëª… :	 ì—ì´ì¹˜ì—˜
ê³ ê°ëª… :	${name}	
ê°œí†µë²ˆí˜¸ :	${contact}	
ëª¨ë¸ëª… / ìƒ‰ìƒ / ì¼ë ¨ë²ˆí˜¸ :	${modelColor}	
ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ :	${info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || ''}	
ìš”ê¸ˆì œëª…(í˜œíƒ) :	${plan}	
ê°œí†µìœ í˜• :	${subscriptionType}	
ì„ ì•½ ${info['ì•½ì •ê°œì›”ìˆ˜'] || '24ê°œì›”'}		
í˜„ê¸ˆì™„ë‚©		
		
ì¶œê³ ê°€ ${info['ì¶œê³ ê°€'] || ''}${info['ì „í™˜ì§€ì›ê¸ˆ'] && info['ì „í™˜ì§€ì›ê¸ˆ'] !== '0' ? `
ì „í™˜ì§€ì›ê¸ˆ ${info['ì „í™˜ì§€ì›ê¸ˆ']}` : ''}
ìµœì¢…êµ¬ë§¤ê°€ ${info['ìµœì¢…êµ¬ë§¤ê°€'] || ''}
		
ë³´í—˜ / ë¶€ê°€ì„œë¹„ìŠ¤ : ${info['ë¶€ê°€ì„œë¹„ìŠ¤'] || ''}`;
                    } else if ((info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ íƒì•½ì •' || info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ ì•½') && info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í• ë¶€') {
                        stock = `íŒë§¤ì ëª… :	 ì—ì´ì¹˜ì—˜
ê³ ê°ëª… :	${name}	
ê°œí†µë²ˆí˜¸ :	${contact}	
ëª¨ë¸ëª… / ìƒ‰ìƒ / ì¼ë ¨ë²ˆí˜¸ :	${modelColor}	
ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ :	${info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || ''}	
ìš”ê¸ˆì œëª…(í˜œíƒ) :	${plan}	
ê°œí†µìœ í˜• :	${subscriptionType}	
ì„ ì•½ ${info['ì•½ì •ê°œì›”ìˆ˜'] || '24ê°œì›”'}		
í• ë¶€ ${info['í• ë¶€ê°œì›”ìˆ˜'] || '24ê°œì›”'}		
		
ì¶œê³ ê°€ ${info['ì¶œê³ ê°€'] || ''}${info['ì „í™˜ì§€ì›ê¸ˆ'] && info['ì „í™˜ì§€ì›ê¸ˆ'] !== '0' ? `
ì „í™˜ì§€ì›ê¸ˆ ${info['ì „í™˜ì§€ì›ê¸ˆ']}` : ''}
í”„ë¦¬í• ë¶€ ${info['í”„ë¦¬í• ë¶€'] || ''}
ìµœì¢…êµ¬ë§¤ê°€ ${info['ìµœì¢…êµ¬ë§¤ê°€'] || ''}
		
ë³´í—˜ / ë¶€ê°€ì„œë¹„ìŠ¤ : ${info['ë¶€ê°€ì„œë¹„ìŠ¤'] || ''}`;
                    } else {
                        stock = `[ëŸ­ìŠ¤] ${name}ë‹˜ / ${info['ëª¨ë¸ëª…'] || ''} / ${info['ìƒ‰ìƒ'] || ''} / ${plan} / ${subscriptionType} / ${info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] || ''} ${info['ìµœì¢…êµ¬ë§¤ê°€'] || ''}`;
                    }
                    
                    // ì¬ê³ ìš”ì²­ì–‘ì‹ (ë©”ëª¨ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ì— í‘œì‹œë¨)
                    const simIncluded = ['ë²ˆí˜¸ì´ë™', 'ë²ˆì´', 'ì‹ ê·œê°€ì…', 'ì‹ ê·œ'].includes(subscriptionType) ? 'Y' : 'N';
                    const memo = `â–¡ì¬ê³  ìš”ì²­ì„œâ–¡
ë§¤ì¥ìƒí˜¸ : ì—ì´ì¹˜ì—˜
ê³ ê°ëª…: ${name}
ì—°ë½ì²˜: ${contact}
ë°›ì„ ì£¼ì†Œ: ${info['íƒë°°ì£¼ì†Œ'] || info['ë°°ì†¡ì£¼ì†Œì§€'] || ''}
í€µ/íƒë°°: íƒë°°
ê¸°ì¢…/ìƒ‰ìƒ: ${info['ëª¨ë¸ëª…'] || ''} / ${info['ìƒ‰ìƒ'] || ''}
ìœ ì‹¬ë™ë´‰ì—¬ë¶€: ${simIncluded}`;
                    
                    // ë³€í™˜ ì´ë ¥ ì €ì¥ì„ ìœ„í•´ ê³ ê° ì •ë³´ ì €ì¥
                    const customerInfo = {
                        ...info,
                        ì›ë³¸í…ìŠ¤íŠ¸: document.getElementById('inputText').value,
                        ê°€ì…ìëª…: name,
                        ì „í™”ë²ˆí˜¸: contact,
                        ëª¨ë¸ëª…: info['ëª¨ë¸ëª…'] || '',
                        ìƒ‰ìƒ: info['ìƒ‰ìƒ'] || '',
                        ìš”ê¸ˆì œ: plan,
                        ê°€ì…ìœ í˜•: subscriptionType,
                        ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸: info['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || '',
                        ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸: info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || ''
                    };
                    
                    // ë³€í™˜ ì´ë ¥ ì €ì¥
                    saveToHistory(customerInfo, 'SK', 'ëŸ­ìŠ¤');
                    
                    // 3ê°œì˜ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ì— ë“¤ì–´ê°ˆ ë‚´ìš© ë°˜í™˜
                    return {
                        request: request,
                        stock: stock,
                        memo: memo
                    };
                },
                'ë°€ë¦¬ì–¸': (info) => `[ë°€ë¦¬ì–¸]\nê³ ê°ëª…: ${info.ê³ ê°ëª…}\nëª¨ë¸: ${info.ëª¨ë¸ëª…}\nìƒ‰ìƒ: ${info.ìƒ‰ìƒ}\nìš”ê¸ˆì œ: ${info.ìš”ê¸ˆì œ}\nê°€ì…ìœ í˜•: ${info.ê°€ì…ìœ í˜•}\n${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€}: ${info.ìµœì¢…êµ¬ë§¤ê°€}ì›`,

                'ì‚¼ë³´/ì— ë””ë„ë§¤': (info) => `[ì‚¼ë³´/ì— ë””ë„ë§¤]\n${info.ê³ ê°ëª…}\n${info.ëª¨ë¸ëª…}\n${info.ìƒ‰ìƒ}\n${info.ìš”ê¸ˆì œ}\n${info.ê°€ì…ìœ í˜•}\n${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€} ${info.ìµœì¢…êµ¬ë§¤ê°€}ì›`,
                'ì½”ì›¨ì–´': (info) => {
                    // ê¸°ë³¸ ì •ë³´ ì²˜ë¦¬
                    const name = info['ê³ ê°ëª…'] || '';
                    const regNum = info['ì£¼ë¯¼ë²ˆí˜¸'] || info['ìƒë…„ì›”ì¼'] || '';
                    const contact = info['ì „í™”ë²ˆí˜¸'] || info['ê°œí†µë²ˆí˜¸'] || info['ì—°ë½ì²˜'] || ''; // ì „í™”ë²ˆí˜¸ë‚˜ ê°œí†µë²ˆí˜¸ ìš°ì„  ì‚¬ìš©
                    const modelInfo = `${info['ëª¨ë¸ëª…'] || ''} ${info['ìƒ‰ìƒ'] || ''}`;
                    const serialNum = info['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || '';
                    const plan = info['ìš”ê¸ˆì œ'] || '';
                    
                    // í• ë¶€ ì •ë³´ ì²˜ë¦¬
                    let installment = '';
                    if (info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í• ë¶€') {
                        installment = `${info['í• ë¶€ê°œì›”ìˆ˜'] || '24ê°œì›”'}`;
                    } else if (info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í˜„ê¸ˆ') {
                        installment = '0'; // í˜„ê¸ˆì¸ ê²½ìš° 0ìœ¼ë¡œ í‘œì‹œ
                    }
                    
                    // í”„ë¦¬í• ë¶€ ì •ë³´
                    const prepay = info['í”„ë¦¬í• ë¶€'] || '0';
                    
                    // í• ë¶€ì›ê¸ˆ ì •ë³´
                    let principal = '0';
                    if (info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í• ë¶€') {
                        principal = info['ìµœì¢…êµ¬ë§¤ê°€'] || '0'; // í• ë¶€ì¸ ê²½ìš°ì—ë§Œ ìµœì¢…êµ¬ë§¤ê°€ í‘œì‹œ
                    }
                    
                    // í˜„ê¸ˆì™„ë‚© ì •ë³´
                    const cashPayment = info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í˜„ê¸ˆ' ? 'O' : '';
                    
                    // ì„ ì•½ & ê³µì‹œ ì •ë³´
                    let contractType = '';
                    if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ê³µì‹œì§€ì›') {
                        contractType = `ê³µì‹œ ${info['ì•½ì •ê°œì›”ìˆ˜'] || '24ê°œì›”'}`;
                    } else if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ íƒì•½ì •' || info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ ì•½') {
                        contractType = `ì„ ì•½ ${info['ì•½ì •ê°œì›”ìˆ˜'] || '24ê°œì›”'}`;
                    }
                    
                    // ìœ ì‹¬ ì •ë³´
                    const usim = info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || info['ìœ ì‹¬'] || '';
                    
                    // ë¶€ê°€ì„œë¹„ìŠ¤ ì •ë³´
                    const addon = info['ë¶€ê°€ì„œë¹„ìŠ¤'] || '';
                    
                    // ë³´í—˜ê°€ì…ì—¬ë¶€ ì •ë³´
                    const insurance = info['ë³´í—˜'] || '';
                    
                    // ì½”ì›¨ì–´ ì–‘ì‹
                    return `* ê°œí†µìš”ì²­	
ê³ ê°ëª… - ${name}	
ì£¼ë¯¼ë²ˆí˜¸ - ${regNum}	
ê°œí†µë²ˆí˜¸ - ${contact}	
ë‹¨ë§ì •ë³´ - ${modelInfo}	
ì¼ë ¨ë²ˆí˜¸ - ${serialNum}	
ìš”ê¸ˆì œ - ${plan}	
í• ë¶€ - ${installment}	
í”„ë¦¬ - ${prepay}	
í• ë¶€ì›ê¸ˆ - ${principal}	
í˜„ê¸ˆì™„ë‚© - ${cashPayment}	
ì„ ì•½&ê³µì‹œ - ${contractType}	
ìœ ì‹¬ - ${usim}	
ë¶€ê°€ - ${addon}	
ë³´í—˜ê°€ì…ì—¬ë¶€ - ${insurance}`;
                },
                'ë¹„ì•¤ì»´': (info) => {
                    // ë¹„ì•¤ì»´ í…œí”Œë¦¿
                    const name = info['ê°€ì…ìëª…'] || info['ê³ ê°ëª…'] || '';
                    const jumin = info['ì£¼ë¯¼ë²ˆí˜¸'] || info['ìƒë…„ì›”ì¼'] || '';
                    const phone = info['ì „í™”ë²ˆí˜¸'] || info['ê°œí†µë²ˆí˜¸'] || '';
                    const subscriptionType = info['ê°€ì…ìœ í˜•'] || '';
                    
                    // ì ‘ìˆ˜í™•ì¸&ì‹ ì¡°ìš”ì²­ ì–‘ì‹
                    const stockRequest = `- ${subscriptionType}
ã…SKì¡°íšŒì–‘ì‹
ê³ ê°ëª… : ${name}
ì£¼ë¯¼ë²ˆí˜¸ : ${jumin}
ì „í™”ë²ˆí˜¸ : ${phone}
${subscriptionType} ì ‘ìˆ˜ í™•ì¸ ë° ì‹ ì¡° ë¶€íƒë“œë¦½ë‹ˆë‹¤.`;
                    
                    // ê°œí†µìš”ì²­ ì–‘ì‹ì„ ìœ„í•œ ë°ì´í„° ì²˜ë¦¬
                    const openName = info['ê³ ê°ëª…'] || info['ê°€ì…ìëª…'] || '';
                    const openJumin = info['ì£¼ë¯¼ë²ˆí˜¸'] || info['ìƒë…„ì›”ì¼'] || '';
                    const openPhone = info['ê°œí†µë²ˆí˜¸'] || info['ì „í™”ë²ˆí˜¸'] || '';
                    const openSubscriptionType = info['ê°€ì…ìœ í˜•'] || '';
                    const model = info['ëª¨ë¸ëª…'] || '';
                    const color = info['ìƒ‰ìƒ'] || '';
                    const serialNumber = info['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || '';
                    const usimNumber = info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || info['ìœ ì‹¬'] || '';
                    const plan = info['ìš”ê¸ˆì œ'] || '';
                    const discountType = info['í• ì¸ìœ í˜•'] || '';
                    const contractMonths = info['ì•½ì •ê°œì›”ìˆ˜'] || '';
                    // ë¶€ê°€ì„œë¹„ìŠ¤/ë³´í—˜ ì¡°í•© (ë³´í—˜ì´ ì—†ìœ¼ë©´ / ì œê±°)
                    const addonService = info['ë¶€ê°€ì„œë¹„ìŠ¤'] || '';
                    const insurance = info['ë³´í—˜'] || '';
                    let addon = '';
                    if (addonService && insurance) {
                        addon = `${addonService} / ${insurance}`;
                    } else if (addonService) {
                        addon = addonService;
                    } else if (insurance) {
                        addon = insurance;
                    }
                    
                    // í• ë¶€ì›ê¸ˆ/ê°œì›”ìˆ˜ ì²˜ë¦¬
                    let installmentInfo = '';
                    if (info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í˜„ê¸ˆ') {
                        installmentInfo = `â˜…í˜„ê¸ˆì™„ë‚© / ${info['ìµœì¢…êµ¬ë§¤ê°€'] || ''}`;
                    } else if (info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í• ë¶€') {
                        installmentInfo = `${info['ìµœì¢…êµ¬ë§¤ê°€'] || ''} / ${info['í• ë¶€ê°œì›”ìˆ˜'] || ''}`;
                    } else {
                        installmentInfo = `${info['ìµœì¢…êµ¬ë§¤ê°€'] || ''}`;
                    }
                    
                    // ì„ ë‚©ê¸ˆ ê³„ì‚° (ìˆ«ì í˜•íƒœë¡œ ì²˜ë¦¬ í›„ ì½¤ë§ˆ í¬ë§·)
                    let prepayment = '0';
                    if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ê³µì‹œì§€ì›') {
                        // ì½¤ë§ˆ ì œê±° í›„ ìˆ«ìë¡œ ë³€í™˜
                        const gongsi = parseInt((info['ê³µì‹œ'] || '0').replace(/,/g, '')) || 0;
                        const chuji = parseInt((info['ì¶”ì§€'] || '0').replace(/,/g, '')) || 0;
                        const jeonhwan = parseInt((info['ì „í™˜ì§€ì›ê¸ˆ'] || '0').replace(/,/g, '')) || 0;
                        const preFree = parseInt((info['í”„ë¦¬í• ë¶€'] || '0').replace(/,/g, '')) || 0;
                        
                        const total = gongsi + chuji + jeonhwan + preFree;
                        // ìˆ«ìë¥¼ ì½¤ë§ˆ í˜•íƒœë¡œ í¬ë§·
                        prepayment = total.toLocaleString();
                    } else if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ íƒì•½ì •') {
                        prepayment = '0';
                    }
                    
                    // ê°œí†µìš”ì²­ ì–‘ì‹
                    const openRequest = `ã…‡ ê°œí†µìš”ì²­ (ì œíœ´)/ì¼€ì´ë±…í¬
ê³ ê°ëª… : ${openName}
ìƒë…„ì›”ì¼ : ${openJumin}
ê°œí†µë²ˆí˜¸ : ${openPhone}
ê°€ì…ìœ í˜• : ${openSubscriptionType}
ëª¨ë¸ëª… : ${model} / ${color}
ì¼ë ¨ë²ˆí˜¸ : ${serialNumber}
ìœ ì‹¬ë²ˆí˜¸ : ${usimNumber}
ìš”ê¸ˆì œ : ${plan}
ì•½ì •ìœ í˜•(ê³µì‹œ/ì„ ì•½)/ê°œì›”ìˆ˜ : ${discountType} / ${contractMonths}
í• ë¶€ì›ê¸ˆ/ê°œì›”ìˆ˜ : ${installmentInfo}
ì„ ë‚©ê¸ˆ : ${prepayment}
ë¶€ê°€ì„œë¹„ìŠ¤/ë³´í—˜ : ${addon}`;
                    
                    return {
                        stockRequest: stockRequest, // ì ‘ìˆ˜í™•ì¸&ì‹ ì¡°ìš”ì²­
                        openRequest: openRequest    // ê°œí†µìš”ì²­
                    };
                }
            },
            'LG': {
                name: 'LG',
                agencies: {
                    'ì†Œë¦¬': {
                        name: 'ì†Œë¦¬',
                        type: 'special',
                        outputType: 'table',
                        memo: agencyMemos['LG']['ì†Œë¦¬'],
                        template: (info) => {
                            const additionalOutput = `${info.ëª¨ë¸ëª… || ''} / ${info.ê°€ì…ìœ í˜• || ''}\n` +
                                `${info.ê³ ê°ëª… || ''} / ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''} / ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || info.ì—°ë½ì²˜ || ''}\n` +
                                `ì ‘ìˆ˜ í™•ì¸ ë° ì‹ ì¡° ë¶€íƒë“œë¦½ë‹ˆë‹¤.`;
                            return {
                                tableData: info,
                                additionalText: additionalOutput
                            };
                        }
                    },
                    'ì œì´/íœ´ë„·': {
                        name: 'ì œì´/íœ´ë„·',
                        type: 'special',
                        outputType: 'multi',
                        memo: agencyMemos['LG']['ì œì´/íœ´ë„·'],
                        templates: {
                            confirm: (info) => `[íœ´ë„· ì ‘ìˆ˜í™•ì¸]\nê³ ê°: ${info.ê³ ê°ëª… || ''}\nëª¨ë¸: ${info.ëª¨ë¸ëª… || ''}\nìƒ‰ìƒ: ${info.ìƒ‰ìƒ || ''}\nìš”ê¸ˆì œ: ${info.ìš”ê¸ˆì œ || ''}\nê°€ì…ìœ í˜•: ${info.ê°€ì…ìœ í˜• || ''}`,
                            delivery: (info) => `[íœ´ë„· ë°°ì†¡ìš”ì²­]\nê³ ê°: ${info.ê³ ê°ëª… || ''}\nëª¨ë¸: ${info.ëª¨ë¸ëª… || ''}\nìƒ‰ìƒ: ${info.ìƒ‰ìƒ || ''}\nì£¼ì†Œ: ${info.íƒë°°ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || ''}`,
                            open: (info) => `[íœ´ë„· ê°œí†µìš”ì²­]\nê³ ê°: ${info.ê³ ê°ëª… || ''}\nê°œí†µë²ˆí˜¸: ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}\nëª¨ë¸: ${info.ëª¨ë¸ëª… || ''}\nê°€ì…ìœ í˜•: ${info.ê°€ì…ìœ í˜• || ''}`
                        }
                    },
                    'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹': {
                        name: 'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹',
                        type: 'normal',
                        outputType: 'single',
                        memo: '',
                        template: (info) => `${info.ê³ ê°ëª… || ''} / ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''} / ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}`
                    }
                }
            }
        };

        // í…œí”Œë¦¿ ê´€ë¦¬ í´ë˜ìŠ¤
        class TemplateManager {
            static getTemplate(telecom, agency) {
                const agencyConfig = TELECOM_CONFIG[telecom]?.agencies[agency];
                if (!agencyConfig) return null;
                
                return agencyConfig.templates || agencyConfig.template;
            }

            static applyTemplate(telecom, agency, customerInfo) {
                const template = this.getTemplate(telecom, agency);
                if (!template) throw new Error('í…œí”Œë¦¿ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');

                const agencyConfig = TELECOM_CONFIG[telecom].agencies[agency];
                
                switch(agencyConfig.outputType) {
                    case 'split':
                        return {
                            stockRequest: template.stockRequest(customerInfo),
                            openRequest: template.openRequest(customerInfo)
                        };
                    case 'multi':
                        // íœ´ë„·ê³¼ ì˜¤ì•¤í‹°ì˜ ê²½ìš° íŠ¹ë³„í•œ ì²˜ë¦¬
                        if (agency === 'ì œì´/íœ´ë„·') {
                            return {
                                confirm: template.confirm(customerInfo),
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else if (agency === 'ì˜¤ì•¤í‹°') {
                            return {
                                request: template.request(customerInfo),
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else if (agency === 'ì¥ì²œ') {
                            return {
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else {
                            return {
                                request: template.request(customerInfo),
                                stock: template.stock(customerInfo),
                                memo: template.memo(customerInfo)
                            };
                        }
                    case 'table':
                        return template(customerInfo);
                    default:
                        return template(customerInfo);
                }
            }
        }

        // ì¶œë ¥ ê´€ë¦¬ í´ë˜ìŠ¤
        class OutputManager {
            static showOutput(result, outputType, telecom, agency) {
                // ëª¨ë“  ì¶œë ¥ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
                this.hideAllContainers();
                
                switch(outputType) {
                    case 'split':
                        this.showSplitOutput(result);
                        break;
                    case 'multi':
                        this.showMultiOutput(result, agency);
                        break;
                    case 'table':
                        this.showTableOutput(result);
                        break;
                    default:
                        this.showSingleOutput(result);
                }
            }

            static hideAllContainers() {
                const containers = [
                    'luxExtraOutputs',
                    'dblackExtraOutputs',
                    'singleOutputContainer',
                    'splitOutputContainer',
                    'keyValueTableContainer',
                    'actExtraOutputs',
                    'bncomExtraOutputs',
                    'hunetExtraOutputs',
                    'millionExtraOutputs',
                    'ontExtraOutputs',
                    'jangcheonExtraOutputs'
                ];
                
                containers.forEach(id => {
                    const container = document.getElementById(id);
                    if (container) container.style.display = 'none';
                });
                
                // ì¶”ê°€ í…ìŠ¤íŠ¸ div ì œê±°
                const additionalTextDiv = document.getElementById('additionalTextDiv');
                if (additionalTextDiv) {
                    additionalTextDiv.remove();
                }
            }

            static showSplitOutput(result) {
                const container = document.getElementById('splitOutputContainer');
                if (!container) return;

                // í˜„ì¬ ì„ íƒëœ ëŒ€ë¦¬ì  ê°€ì ¸ì˜¤ê¸°
                const agencySelect = document.getElementById('agency');
                const selectedAgency = agencySelect ? agencySelect.value : '';

                // ì¹´íŒŒ, ì‚¼ë³´(ì˜¨ë¼ì¸), ì´ì•¤í‹°ì¼ ë•Œ íŠ¹ë³„ ë¼ë²¨ ì‚¬ìš©
                let firstLabel = 'ì ‘ìˆ˜í™•ì¸';
                if (selectedAgency === 'ì¹´íŒŒ') {
                    firstLabel = 'ë°°ì†¡ìš”ì²­';
                } else if (selectedAgency === 'ì‚¼ë³´(ì˜¨ë¼ì¸)') {
                    firstLabel = 'ì¬ê³ ìš”ì²­';
                } else if (selectedAgency === 'ì´ì•¤í‹°') {
                    firstLabel = 'ë°°ì†¡ìš”ì²­';
                }

                container.style.display = 'block';
                container.innerHTML = `
                    <div class="form-group">
                        <label for="outputText1">${selectedAgency} ${firstLabel}:</label>
                        <textarea id="outputText1" class="output-textarea">${result.stockRequest || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="outputText2">${selectedAgency} ê°œí†µìš”ì²­:</label>
                        <textarea id="outputText2" class="output-textarea">${result.openRequest || ''}</textarea>
                    </div>
                `;
            }

            static showMultiOutput(result, agency) {
                let container;
                
                // ëŒ€ë¦¬ì ì— ë”°ë¥¸ ì»¨í…Œì´ë„ˆ ì„ íƒ
                if (agency === 'ë“œë¸”ë™') {
                    container = document.getElementById('dblackExtraOutputs');
                } else if (agency === 'ì œì´/íœ´ë„·') {
                    container = document.getElementById('hunetExtraOutputs');
                } else if (agency === 'ë°€ë¦¬ì–¸') {
                    container = document.getElementById('millionExtraOutputs');
                } else if (agency === 'ì˜¤ì•¤í‹°') {
                    container = document.getElementById('ontExtraOutputs');
                } else if (agency === 'ì¥ì²œ') {
                    container = document.getElementById('jangcheonExtraOutputs');
                } else {
                    container = document.getElementById('luxExtraOutputs');
                }
                
                if (!container) return;
                container.style.display = 'block';

                if (agency === 'ë“œë¸”ë™') {
                    // ë“œë¸”ë™ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    container.innerHTML = `
                        <div class="form-group">
                            <label for="dblackRequestText">ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackRequestText" class="output-textarea compact-textarea">${result.request || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackStockText">ë“œë¸”ë™ ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackStockText" class="output-textarea compact-textarea">${result.stock || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackMemoText">ë“œë¸”ë™ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackMemoText" class="output-textarea compact-textarea">${result.memo || ''}</textarea>
                        </div>
                    `;
                } else if (agency === 'ì œì´/íœ´ë„·') {
                    // íœ´ë„· ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (3ê°œ textarea)
                    const confirmText = document.getElementById('hunetConfirmText');
                    const deliveryText = document.getElementById('hunetDeliveryText');
                    const openText = document.getElementById('hunetOpenText');
                    
                    if (confirmText) confirmText.value = result.confirm || '';
                    if (deliveryText) deliveryText.value = result.delivery || '';
                    if (openText) openText.value = result.open || '';
                } else if (agency === 'ë°€ë¦¬ì–¸') {
                    // ë°€ë¦¬ì–¸ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const requestText = document.getElementById('millionRequestText');
                    const stockText = document.getElementById('millionStockText');
                    const memoText = document.getElementById('millionMemoText');
                    
                    if (requestText) requestText.value = result.request || '';
                    if (stockText) stockText.value = result.stock || '';
                    if (memoText) memoText.value = result.memo || '';
                } else if (agency === 'ì˜¤ì•¤í‹°') {
                    // ì˜¤ì•¤í‹° ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const requestText = document.getElementById('ontRequestText');
                    const stockText = document.getElementById('ontStockText');
                    const memoText = document.getElementById('ontMemoText');
                    
                    if (requestText) requestText.value = result.request || '';
                    if (stockText) stockText.value = result.delivery || '';
                    if (memoText) memoText.value = result.open || '';
                } else if (agency === 'ì¥ì²œ') {
                    // ì¥ì²œ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const deliveryText = document.getElementById('jangcheonDeliveryText');
                    const openText = document.getElementById('jangcheonOpenText');
                    
                    if (deliveryText) deliveryText.value = result.delivery || '';
                    if (openText) openText.value = result.open || '';
                } else {
                    // ëŸ­ìŠ¤ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    container.innerHTML = `
                        <div class="form-group">
                            <label for="luxRequestText">ëŸ­ìŠ¤ ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxRequestText" class="output-textarea compact-textarea">${result.request || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxStockText">ëŸ­ìŠ¤ ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxStockText" class="output-textarea compact-textarea">${result.stock || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxMemoText">ëŸ­ìŠ¤ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxMemoText" class="output-textarea compact-textarea">${result.memo || ''}</textarea>
                        </div>
                    `;
                }
            }

            static showTableOutput(result) {
                const container = document.getElementById('keyValueTableContainer');
                if (!container) return;

                container.style.display = 'block';
                // í…Œì´ë¸” ì¶œë ¥ ë¡œì§ êµ¬í˜„ - result.tableDataë¥¼ ì „ë‹¬
                createKeyValueTable(result.tableData || result);
                
                // additionalTextê°€ ìˆìœ¼ë©´ í…Œì´ë¸” ì•„ë˜ì— í‘œì‹œ
                if (result.additionalText) {
                    let additionalTextDiv = document.getElementById('additionalTextDiv');
                    if (!additionalTextDiv) {
                        additionalTextDiv = document.createElement('div');
                        additionalTextDiv.id = 'additionalTextDiv';
                        additionalTextDiv.style.cssText = `
                            margin-top: 20px;
                            padding: 15px;
                            background-color: #f8f9fa;
                            border: 1px solid #e9ecef;
                            border-radius: 5px;
                            white-space: pre-line;
                            font-family: 'Nanum Gothic', sans-serif;
                            line-height: 1.5;
                        `;
                        container.appendChild(additionalTextDiv);
                    }
                    additionalTextDiv.textContent = result.additionalText;
                }
            }

            static showSingleOutput(result) {
                const container = document.getElementById('singleOutputContainer');
                if (!container) return;

                container.style.display = 'block';
                document.getElementById('outputText').value = result;
            }
        }

        // í†µì‹ ì‚¬ ì„ íƒì— ë”°ë¼ ëŒ€ë¦¬ì  ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateAgencies() {
            const telecomSelect = document.getElementById('telecom');
            const agencySelect = document.getElementById('agency');
            const agencyInfoBtn = document.getElementById('agencyInfoBtn');
            
            // ëŒ€ë¦¬ì  ì„ íƒ ì´ˆê¸°í™”
            agencySelect.innerHTML = '<option value="">ëŒ€ë¦¬ì ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            agencySelect.disabled = true;
            agencyInfoBtn.disabled = true;
            
            const selectedTelecom = telecomSelect.value;
            
            if (selectedTelecom) {
                // ì„ íƒëœ í†µì‹ ì‚¬ì— í•´ë‹¹í•˜ëŠ” ëŒ€ë¦¬ì  ëª©ë¡ ì¶”ê°€
                agencies[selectedTelecom].forEach(agency => {
                    const option = document.createElement('option');
                    option.value = agency;
                    option.textContent = agency;
                    agencySelect.appendChild(option);
                });
                
                // ëŒ€ë¦¬ì  ì„ íƒ í™œì„±í™”
                agencySelect.disabled = false;
                agencyInfoBtn.disabled = false;
            }
        }

        // í«ë„¤ì„ì„ ì‹¤ì œ ëª¨ë¸ëª…ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë§¤í•‘ í…Œì´ë¸”
        const MODEL_NAME_MAPPING = {
            // ê°¤ëŸ­ì‹œ S ì‹œë¦¬ì¦ˆ  
            'ê°¤ëŸ­ì‹œS25ìš¸íŠ¸ë¼': 'S938',
            'ê°¤ëŸ­ì‹œS25+': 'S936',
            'ê°¤ëŸ­ì‹œS25í”ŒëŸ¬ìŠ¤': 'S936',
            'ê°¤ëŸ­ì‹œS25': 'S931',
            'ê°¤ëŸ­ì‹œS25ì—£ì§€' : 'S937',
            'S25ìš¸íŠ¸ë¼': 'S938',
            'S25+': 'S936',
            'S25': 'S931',
            'ê°¤ëŸ­ì‹œS24ìš¸íŠ¸ë¼': 'S928',
            'ê°¤ëŸ­ì‹œS24+': 'S926', 
            'ê°¤ëŸ­ì‹œS24': 'S921',
            'S24ìš¸íŠ¸ë¼': 'S928',
            'S24+': 'S926',
            'S24': 'S921',
            'ê°¤ëŸ­ì‹œS23': 'S911',
            'ê°¤ëŸ­ì‹œS23+': 'S916',
            'ê°¤ëŸ­ì‹œS23ìš¸íŠ¸ë¼': 'S918',
            'ê°¤ëŸ­ì‹œS22': 'S901',
            'ê°¤ëŸ­ì‹œS22+': 'S906',
            'ê°¤ëŸ­ì‹œS22ìš¸íŠ¸ë¼': 'S908',
            
            // ê°¤ëŸ­ì‹œ A ì‹œë¦¬ì¦ˆ
            'ê°¤ëŸ­ì‹œí€€í…€5': 'A556',
            'ê°¤ëŸ­ì‹œì™€ì´ë“œ8': 'M166',
            'ê°¤ëŸ­ì‹œì™€ì´ë“œ8 (M166)': 'M166',
            'ê°¤ëŸ­ì‹œA16' : 'A165',
            
            // ê°¤ëŸ­ì‹œ Z ì‹œë¦¬ì¦ˆ (í´ë“œ)
            'ê°¤ëŸ­ì‹œZí´ë“œ6': 'F956',
            'ê°¤ëŸ­ì‹œZí´ë“œ5': 'F946',
            'ê°¤ëŸ­ì‹œZí´ë“œ4': 'F936',
            'ê°¤ëŸ­ì‹œZí”Œë¦½6': 'F741',
            'ê°¤ëŸ­ì‹œZí”Œë¦½5': 'F731',
            'ê°¤ëŸ­ì‹œZí”Œë¦½4': 'F721',
            // ì¶”ê°€ì ì¸ ë§¤í•‘ì€ ì—¬ê¸°ì— ê³„ì† ì¶”ê°€ ê°€ëŠ¥
        };

        // ëª¨ë¸ëª… ë³€í™˜ í•¨ìˆ˜
        function convertModelName(modelName) {
            if (!modelName) return modelName;
            
            // ì…ë ¥ëœ ëª¨ë¸ëª…ì—ì„œ ê³µë°±ê³¼ íŠ¹ìˆ˜ë¬¸ì ì œê±°í•˜ì—¬ ì •ê·œí™”
            const normalizedInput = modelName.replace(/[\s\-_]/g, '').toLowerCase();
            
            // ìš©ëŸ‰ ì •ë³´ ë¯¸ë¦¬ ì¶”ì¶œ (ì˜ˆ: 256G, 512GB, 1TB ë“±)
            const capacityMatch = modelName.match(/(\d+(?:GB?|TB?))/i);
            const capacity = capacityMatch ? ' ' + capacityMatch[1] : '';
            
            // ë§¤í•‘ í…Œì´ë¸”ì˜ í‚¤ë“¤ì„ ê¸¸ì´ìˆœìœ¼ë¡œ ì •ë ¬ (ê¸´ ê²ƒë¶€í„° ë§¤ì¹­í•˜ì—¬ ì •í™•ë„ í–¥ìƒ)
            const sortedMappings = Object.entries(MODEL_NAME_MAPPING)
                .sort(([a], [b]) => b.length - a.length);
            
            // ë§¤í•‘ í…Œì´ë¸”ì—ì„œ ì¼ì¹˜í•˜ëŠ” í«ë„¤ì„ ì°¾ê¸°
            for (const [petName, realModelName] of sortedMappings) {
                const normalizedPetName = petName.replace(/[\s\-_]/g, '').toLowerCase();
                
                // ì •í™•í•œ ë§¤ì¹­ì„ ìœ„í•´ ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ í™•ì¸
                // 1. ì™„ì „ ì¼ì¹˜
                if (normalizedInput === normalizedPetName) {
                    console.log(`ëª¨ë¸ëª… ë³€í™˜ (ì™„ì „ì¼ì¹˜): ${modelName} â†’ ${realModelName}${capacity}`);
                    return realModelName + capacity;
                }
                
                // 2. ìš©ëŸ‰ ì œê±° í›„ ì™„ì „ ì¼ì¹˜
                const inputWithoutCapacity = normalizedInput.replace(/\d+(?:gb?|tb?)/i, '');
                if (inputWithoutCapacity === normalizedPetName) {
                    console.log(`ëª¨ë¸ëª… ë³€í™˜ (ìš©ëŸ‰ì œì™¸ì¼ì¹˜): ${modelName} â†’ ${realModelName}${capacity}`);
                    return realModelName + capacity;
                }
                
                // 3. ì‹œì‘ ë¶€ë¶„ ë§¤ì¹­ (ë” ì •í™•í•œ ë§¤ì¹­ì„ ìœ„í•´)
                if (normalizedInput.startsWith(normalizedPetName)) {
                    // ì‹œì‘ ë§¤ì¹­ í›„ ë‚¨ì€ ë¶€ë¶„ì´ ìš©ëŸ‰ ì •ë³´ì¸ì§€ í™•ì¸
                    const remaining = normalizedInput.slice(normalizedPetName.length);
                    if (!remaining || /^\d+(?:gb?|tb?)?$/i.test(remaining)) {
                        console.log(`ëª¨ë¸ëª… ë³€í™˜ (ì‹œì‘ë§¤ì¹­): ${modelName} â†’ ${realModelName}${capacity}`);
                        return realModelName + capacity;
                    }
                }
            }
            
            console.log(`ëª¨ë¸ëª… ë³€í™˜ ì‹¤íŒ¨: ${modelName} (ë§¤í•‘ë˜ì§€ ì•ŠìŒ)`);
            return modelName; // ë§¤í•‘ë˜ì§€ ì•Šì€ ê²½ìš° ì›ë³¸ ë°˜í™˜
        }

        // ë¶€ê°€ì„œë¹„ìŠ¤ì™€ ë³´í—˜ ë¶„ë¦¬ í•¨ìˆ˜
        function parseAddonAndInsurance(addonText) {
            if (!addonText) {
                return { ë³´í—˜: '', ë¶€ê°€ì„œë¹„ìŠ¤: '' };
            }
            
            // ë³´í—˜ ê´€ë ¨ í‚¤ì›Œë“œ ì •ì˜
            const insuranceKeywords = [
                'T Allì¼€ì–´í”ŒëŸ¬ìŠ¤',
                'T Allì¼€ì–´',
                'ì¼€ì–´í”ŒëŸ¬ìŠ¤',
                'ë‹¨ë§ë³´í—˜',
                'ë³´í—˜',
                'ìŠ¤ë§ˆíŠ¸ì¼€ì–´',
                'ì•ˆì‹¬ì¼€ì–´',
                'ì¼€ì–´ì„œë¹„ìŠ¤',
                'ë³´ì¥ì„œë¹„ìŠ¤',
                'ë¶„ì‹¤ë³´í—˜',
                'íŒŒì†ë³´í—˜'
            ];
            
            // ë¶€ê°€ì„œë¹„ìŠ¤ ê´€ë ¨ í‚¤ì›Œë“œ ì •ì˜  
            const addonKeywords = [
                'ë§ˆì´ìŠ¤ë§ˆíŠ¸ì½œ',
                'ìŠ¤ë§ˆíŠ¸ì½œ',
                'ë²¨ì†Œë¦¬',
                'ì»¬ëŸ¬ë§',
                'ë„¤ì´ë²„í”ŒëŸ¬ìŠ¤',
                'ë©œë¡ ',
                'ì§€ë‹ˆë®¤ì§',
                'í”Œë¡œ',
                'í‹°ë§µ',
                'ë„¤ë¹„ê²Œì´ì…˜',
                'í´ë¼ìš°ë“œ',
                'ë°±ì—…',
                'ë°”ì´ë¸Œ',
                'ì¹´ì¹´ì˜¤VIP',
                'ëª¨ë°”ì¼TV',
                'DMB',
                'ë°ì´í„°ì‰ì–´ë§',
                'íŒ¨ë°€ë¦¬í”ŒëŸ¬ìŠ¤',
                'ì•„ì´ë“¤ë‚˜ë¼',
                'í‚¤ì¦ˆëœë“œ'
            ];
            
            // ë¶ˆí•„ìš”í•œ ê¸°ê°„/íšŸìˆ˜ ì •ë³´ íŒ¨í„´ ì •ì˜
            const unwantedPatterns = [
                /M\+\d+(?:ê°œì›”)?/gi,           // M+1ê°œì›”, M+2 ë“±
                /\(ì´\s*\d+ê°œì›”\)/gi,          // (ì´ 2ê°œì›”) ë“±
                /\(ì´\s*\d+\)/gi,              // (ì´ 3) ë“±
                /\d+ê°œì›”/gi,                   // 1ê°œì›”, 2ê°œì›” ë“±
                /\d+íšŒ/gi,                     // 1íšŒ, 2íšŒ ë“±
                /\d+M/gi,                      // 1M, 2M ë“±
                /ë¬´ë£Œì²´í—˜/gi,                  // ë¬´ë£Œì²´í—˜
                /ì²´í—˜/gi                       // ì²´í—˜
            ];
            
            // í…ìŠ¤íŠ¸ë¥¼ "/" ë˜ëŠ” "," ë˜ëŠ” ";" ë˜ëŠ” ì¤„ë°”ê¿ˆìœ¼ë¡œ ë¶„í• 
            const items = addonText.split(/[\/,;\n]/).map(item => item.trim()).filter(item => item);
            
            const insuranceItems = [];
            const addonItems = [];
            
            for (let item of items) {
                // ë¶ˆí•„ìš”í•œ íŒ¨í„´ë“¤ì„ ì œê±°
                let cleanItem = item;
                for (const pattern of unwantedPatterns) {
                    cleanItem = cleanItem.replace(pattern, '').trim();
                }
                
                // ê´„í˜¸ ì•ˆì˜ ë‚´ìš© ì œê±° (ë‚¨ì€ ê²ƒë“¤)
                cleanItem = cleanItem.replace(/\([^)]*\)/g, '').trim();
                
                // ìˆ«ìì™€ ì ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë¶€ë¶„ ì œê±° (1., 2., 3. ë“±)
                cleanItem = cleanItem.replace(/^\d+\.\s*/, '').trim();
                
                // ì•ë’¤ ê³µë°± ë° íŠ¹ìˆ˜ë¬¸ì ì •ë¦¬
                cleanItem = cleanItem.replace(/^[-\s]+|[-\s]+$/g, '').trim();
                
                // ì •ë¦¬ í›„ ë¹ˆ ë¬¸ìì—´ì´ë©´ ìŠ¤í‚µ
                if (!cleanItem || cleanItem.length < 2) {
                    continue;
                }
                
                let isInsurance = false;
                let isAddon = false;
                
                // ë³´í—˜ í‚¤ì›Œë“œ í™•ì¸ (ì •ë¦¬ëœ í…ìŠ¤íŠ¸ë¡œ)
                for (const keyword of insuranceKeywords) {
                    if (cleanItem.toLowerCase().includes(keyword.toLowerCase())) {
                        // ì›ë³¸ ë³´í—˜ëª… ê·¸ëŒ€ë¡œ ì‚¬ìš© (T Allì¼€ì–´í”ŒëŸ¬ìŠ¤5 ë“± ìˆ«ìê°€ í¬í•¨ëœ ì •í™•í•œ ëª…ì¹­ ìœ ì§€)
                        insuranceItems.push(cleanItem);
                        isInsurance = true;
                        break;
                    }
                }
                
                // ë³´í—˜ì´ ì•„ë‹Œ ê²½ìš° ë¶€ê°€ì„œë¹„ìŠ¤ í‚¤ì›Œë“œ í™•ì¸
                if (!isInsurance) {
                    for (const keyword of addonKeywords) {
                        if (cleanItem.toLowerCase().includes(keyword.toLowerCase())) {
                            // íŠ¹ì • ë¶€ê°€ì„œë¹„ìŠ¤ì˜ ì •í™•í•œ ëª…ì¹­ìœ¼ë¡œ ìë™ ë³´ì •
                            let finalAddonItem = cleanItem;
                            if (keyword === 'ë§ˆì´ìŠ¤ë§ˆíŠ¸ì½œ' && cleanItem.toLowerCase() === 'ë§ˆì´ìŠ¤ë§ˆíŠ¸ì½œ') {
                                finalAddonItem = 'ë§ˆì´ìŠ¤ë§ˆíŠ¸ì½œ3';
                            }
                            
                            addonItems.push(finalAddonItem);
                            isAddon = true;
                            break;
                        }
                    }
                }
                
                // í‚¤ì›Œë“œì— ë§¤ì¹­ë˜ì§€ ì•Šì€ ê²½ìš° ê¸¸ì´ë¡œ íŒë‹¨
                if (!isInsurance && !isAddon && cleanItem.length >= 3) {
                    // ê¸´ í…ìŠ¤íŠ¸ëŠ” ë¶€ê°€ì„œë¹„ìŠ¤ë¡œ ë¶„ë¥˜
                    addonItems.push(cleanItem);
                }
            }
            
            return {
                ë³´í—˜: insuranceItems.join(' / '),
                ë¶€ê°€ì„œë¹„ìŠ¤: addonItems.join(' / ')
            };
        }

        // í…ìŠ¤íŠ¸ì—ì„œ ê³ ê° ì •ë³´ ì¶”ì¶œ
        function extractCustomerInfo(text) {
            const customerInfo = {};
            
            // ì •ê·œì‹ íŒ¨í„´ìœ¼ë¡œ ê° í•­ëª© ì¶”ì¶œ
            const patterns = {
                'ì „í™”ë²ˆí˜¸': /\*{1,2}(?:ì „\s*í™”\s*ë²ˆ\s*í˜¸|ê°œ\s*í†µ\s*ë²ˆ\s*í˜¸)\s*[-:ï¼š]\s*([^\n]+)/i,
                'ê°œí†µë²ˆí˜¸': /\*{1,2}(?:ì „\s*í™”\s*ë²ˆ\s*í˜¸|ê°œ\s*í†µ\s*ë²ˆ\s*í˜¸)\s*[-:ï¼š]\s*([^\n]+)/i,
                'ëª¨ë¸ëª…': /\*{1,2}ëª¨\s*ë¸\s*ëª…\s*[-:ï¼š]\s*([^\n]+)/i,
                'ìƒ‰ìƒ': /\*{1,2}ìƒ‰\s*ìƒ\s*[-:ï¼š]\s*([^\n]+)/i,
                'ê³ ê°ëª…': /\*{1,2}(?:ê³ \s*ê°\s*ëª…|ê°€\s*ì…\s*ì\s*ëª…)\s*[-:ï¼š]\s*([^\n]+)/i,
                'ê°€ì…ìëª…': /\*{1,2}(?:ê³ \s*ê°\s*ëª…|ê°€\s*ì…\s*ì\s*ëª…)\s*[-:ï¼š]\s*([^\n]+)/i,
                'ì£¼ë¯¼ë²ˆí˜¸': /\*{1,2}(?:ì£¼\s*ë¯¼\s*ë²ˆ\s*í˜¸|ìƒ\s*ë…„\s*ì›”\s*ì¼)\s*[-:ï¼š]\s*([^\n]+)/i,
                'ìƒë…„ì›”ì¼': /\*{1,2}(?:ì£¼\s*ë¯¼\s*ë²ˆ\s*í˜¸|ìƒ\s*ë…„\s*ì›”\s*ì¼)\s*[-:ï¼š]\s*([^\n]+)/i,
                'íƒë°°ì£¼ì†Œ': /\*{1,2}íƒ\s*ë°°\s*(?:ì£¼\s*ì†Œ|ì£¼\s*ì†Œ\s*ì§€)?\s*[-:ï¼š]\s*([^\n]+)/i,
                'ë°°ì†¡ì£¼ì†Œì§€': /\*{1,2}(?:íƒ\s*ë°°|ë°°\s*ì†¡)\s*(?:ì£¼\s*ì†Œ|ì£¼\s*ì†Œ\s*ì§€)?\s*[-:ï¼š]\s*([^\n]+)/i,
                'í˜„ì¬í†µì‹ ì‚¬': /\*{1,2}í˜„\s*ì¬\s*í†µ\s*ì‹ \s*ì‚¬\s*[-:ï¼š]\s*([^\n]+)/i,
                'ìš”ê¸ˆì œ': /\*{1,2}ìš”\s*ê¸ˆ\s*ì œ\s*[-:ï¼š]\s*([^\n]+)/i,
                'ê°€ì…ìœ í˜•': /\*{1,2}ê°€\s*ì…\s*ìœ \s*í˜•\s*[-:ï¼š]\s*([^\n]+)/i,
                'í• ì¸ìœ í˜•': /\*{1,2}í• \s*ì¸\s*(?:ìœ \s*í˜•|ë°©\s*ì‹)\s*[-:ï¼š]\s*([^\n]+)/i,
                'ìœ ì‹¬': /\*{1,2}ìœ \s*ì‹¬\s*(?:ë¹„\s*ìš©)?\s*[-:ï¼š]\s*([^\n]+)/i,
                'ë¶€ê°€ì„œë¹„ìŠ¤': /\*{1,2}ë¶€\s*ê°€\s*ì„œ\s*ë¹„\s*ìŠ¤\s*[-:ï¼š]\s*([^\n]+)/i,
                'ë³´í—˜': /\*{1,2}ë³´\s*í—˜\s*[-:ï¼š]\s*([^\n]+)/i,
                'ë²•ëŒ€ì •ë³´': /\*{1,2}ë²•\s*ëŒ€\s*ì •\s*ë³´\s*[-:ï¼š]\s*([^/]+)\s*\/\s*([\d-]+)\s*\/\s*([\d-]+)/i
            };
            
            // ê° íŒ¨í„´ì— ë§ê²Œ ì •ë³´ ì¶”ì¶œ
            for (const [key, pattern] of Object.entries(patterns)) {
                const match = text.match(pattern);
                if (match) {
                    if (key === 'ë²•ëŒ€ì •ë³´') {
                        // ë²•ëŒ€ì •ë³´ê°€ ìˆëŠ” ê²½ìš° (ë¯¸ì„±ë…„ì)
                        customerInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] = 'Y';
                        customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„'] = match[1].trim();
                        customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'] = match[2].trim().replace(/\s*-\s*/g, '-');
                        customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜'] = match[3].trim().replace(/[\s\-]/g, '').replace(/(\d{3})(\d{3,4})(\d{4})/, '$1-$2-$3');
                        continue;
                    }
                    
                    // ì¼ë°˜ í•„ë“œ ì²˜ë¦¬
                    if (match[1]) {
                        let value = match[1].trim();
                        
                        // ì „í™”ë²ˆí˜¸/ê°œí†µë²ˆí˜¸ í¬ë§· ì •ê·œí™” (01012345678 -> 010-1234-5678)
                        if ((key === 'ì „í™”ë²ˆí˜¸' || key === 'ê°œí†µë²ˆí˜¸') && value) {
                            // ê´„í˜¸ ì•ˆì˜ ë‚´ìš© ì œê±° (ì˜ˆ: (íœ´ëŒ€ì „í™”) ì œê±°)
                            value = value.replace(/\([^)]*\)/g, '').trim();
                            // ëª¨ë“  ê³µë°±ê³¼ í•˜ì´í”ˆ ì œê±°
                            const numbers = value.replace(/[^\d]/g, '');
                            // 01012345678 -> 010-1234-5678 í˜•ì‹ìœ¼ë¡œ ë³€í™˜
                            if (numbers.length >= 10) {
                                value = numbers.replace(/(\d{3})(\d{3,4})(\d{4})/, '$1-$2-$3');
                                customerInfo[key] = value;  // ë³€í™˜ëœ ê°’ ì €ì¥
                                
                                // ì „í™”ë²ˆí˜¸ì—ì„œ ê°œí†µë²ˆí˜¸ ì¶”ì¶œ (ê°œí†µë²ˆí˜¸ê°€ ì—†ì„ ê²½ìš°ì—ë§Œ)
                                if (key === 'ì „í™”ë²ˆí˜¸' && !customerInfo['ê°œí†µë²ˆí˜¸']) {
                                    customerInfo['ê°œí†µë²ˆí˜¸'] = value;  // ì „í™”ë²ˆí˜¸ë¥¼ ê°œí†µë²ˆí˜¸ë¡œë„ ì €ì¥
                                }
                            }
                        }
                        
                        // ìƒë…„ì›”ì¼/ì£¼ë¯¼ë²ˆí˜¸ í¬ë§· ì •ê·œí™” (000718 - 3251915 -> 000718-3251915)
                        if ((key === 'ìƒë…„ì›”ì¼' || key === 'ì£¼ë¯¼ë²ˆí˜¸') && value) {
                            // í•˜ì´í”ˆ ì£¼ë³€ì˜ ê³µë°± ì œê±°
                            value = value.replace(/\s*-\s*/g, '-');
                        }
                        
                        // ë°°ì†¡ì£¼ì†Œ/íƒë°°ì£¼ì†Œì—ì„œ "/" ì´í›„ì˜ ì „í™”ë²ˆí˜¸ ë¶€ë¶„ ì œê±°
                        if ((key === 'íƒë°°ì£¼ì†Œ' || key === 'ë°°ì†¡ì£¼ì†Œì§€') && value) {
                            // "/" ì´í›„ì˜ ì „í™”ë²ˆí˜¸ íŒ¨í„´ ì œê±° (ì˜ˆ: / 010-8316-1294)
                            value = value.replace(/\s*\/\s*010-\d{3,4}-\d{4}.*$/, '').trim();
                        }
                        
                        customerInfo[key] = value;
                    } else {
                        customerInfo[key] = '';
                    }
                } else {
                    customerInfo[key] = '';
                }
            }
            
            // ë¯¸ì„±ë…„ì ì—¬ë¶€ ê¸°ë³¸ê°’ ì„¤ì • (ë²•ëŒ€ì •ë³´ê°€ ì—†ìœ¼ë©´ 'N')
            if (!customerInfo.hasOwnProperty('ë¯¸ì„±ë…„ìì—¬ë¶€')) {
                customerInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] = 'N';
                customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„'] = '';
                customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'] = '';
                customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜'] = '';
            }
            
            // ê°œí†µë²ˆí˜¸ì™€ ì „í™”ë²ˆí˜¸ í†µí•© ì²˜ë¦¬ (ì „í™”ë²ˆí˜¸ê°€ ì—†ì„ ê²½ìš° ê°œí†µë²ˆí˜¸ ì‚¬ìš©)
            if (!customerInfo['ì „í™”ë²ˆí˜¸'] && customerInfo['ê°œí†µë²ˆí˜¸']) {
                customerInfo['ì „í™”ë²ˆí˜¸'] = customerInfo['ê°œí†µë²ˆí˜¸'];
            }
            
            // ê³ ê°ëª…ê³¼ ê°€ì…ìëª… í†µí•© ì²˜ë¦¬ (ê³ ê°ëª…ì´ ì—†ì„ ê²½ìš° ê°€ì…ìëª… ì‚¬ìš©)
            if (!customerInfo['ê³ ê°ëª…'] && customerInfo['ê°€ì…ìëª…']) {
                customerInfo['ê³ ê°ëª…'] = customerInfo['ê°€ì…ìëª…'];
            }
            
            // ì£¼ë¯¼ë²ˆí˜¸ì™€ ìƒë…„ì›”ì¼ í†µí•© ì²˜ë¦¬ (ì£¼ë¯¼ë²ˆí˜¸ê°€ ì—†ì„ ê²½ìš° ìƒë…„ì›”ì¼ ì‚¬ìš©)
            if (!customerInfo['ì£¼ë¯¼ë²ˆí˜¸'] && customerInfo['ìƒë…„ì›”ì¼']) {
                customerInfo['ì£¼ë¯¼ë²ˆí˜¸'] = customerInfo['ìƒë…„ì›”ì¼'];
            }
            
            // íƒë°°ì£¼ì†Œì™€ ë°°ì†¡ì£¼ì†Œì§€ í†µí•© ì²˜ë¦¬ (íƒë°°ì£¼ì†Œê°€ ì—†ì„ ê²½ìš° ë°°ì†¡ì£¼ì†Œì§€ ì‚¬ìš©)
            if (!customerInfo['íƒë°°ì£¼ì†Œ'] && customerInfo['ë°°ì†¡ì£¼ì†Œì§€']) {
                customerInfo['íƒë°°ì£¼ì†Œ'] = customerInfo['ë°°ì†¡ì£¼ì†Œì§€'];
            }
            
            // 1. Parse subscription, discount, and telecom info using the new function
            const subInfo = parseSubscriptionAndDiscountInfo({
                'ê°€ì…ìœ í˜•': customerInfo['ê°€ì…ìœ í˜•'] || '',
                'í• ì¸ìœ í˜•': customerInfo['í• ì¸ìœ í˜•'] || '',
                'í˜„ì¬í†µì‹ ì‚¬': customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || ''
            });

            // 2. Update customer info with parsed values
            customerInfo['ê°€ì…ìœ í˜•'] = subInfo.subscriptionType;
            customerInfo['í• ì¸ìœ í˜•'] = subInfo.discountType;
            customerInfo['í˜„ì¬í†µì‹ ì‚¬'] = subInfo.currentTelecom;

            // 3. Set ê³µì‹œì„ ì•½ì—¬ë¶€ and ì•½ì •ê°œì›”ìˆ˜ based on discount type
            if (subInfo.discountType === 'ê³µì‹œì§€ì›') {
                customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'] = 'ê³µì‹œì§€ì›';
                customerInfo['ì•½ì •ê°œì›”ìˆ˜'] = subInfo.discountMonths || '24ê°œì›”';
            } else if (subInfo.discountType === 'ì„ íƒì•½ì •' || subInfo.discountType === 'ì„ ì•½') {
                customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'] = subInfo.discountType;
                customerInfo['ì•½ì •ê°œì›”ìˆ˜'] = subInfo.discountMonths || '';
            } else {
                customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'] = '';
                customerInfo['ì•½ì •ê°œì›”ìˆ˜'] = '';
            }
            
            // ì¶œê³ ê°€, ê³µì‹œ, ì¶”ì§€, ì „í™˜ì§€ì›ê¸ˆ, í”„ë¦¬í• ë¶€, í• ë¶€/í˜„ê¸ˆ ì •ë³´ ì¶”ì¶œ
            // 1. ê¸°ë³¸ê°’ ì´ˆê¸°í™”
            customerInfo['ì¶”ì§€'] = '0';
            customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = '0';
            customerInfo['í”„ë¦¬í• ë¶€'] = '0';
            
            // 2. ê´„í˜¸ í¬í•¨ íŒ¨í„´ (ì˜ˆ: **ì¶œê³ ê°€ (1,540,000)- ê³µì‹œ(700,000)- ì „ì§€(100,000) = í˜„ê¸ˆ(740,000))
            const parenthesizedPattern = /\*\*\s*ì¶œê³ ê°€\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?\s*-\s*ê³µì‹œ\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?\s*(?:-\s*(?:ì¶”ì§€|ì¶”ê°€ì§€ì›)\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?)?\s*(?:-\s*(?:ì „ì§€|ì „í™˜ì§€ì›ê¸ˆ?|ì „í™˜)\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?)?\s*(?:-\s*í”„ë¦¬í• ë¶€\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?)?\s*=\s*(í• ë¶€\d*|\ud604\uae08)\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?/i;
            
            // 3. ì¼ë°˜ íŒ¨í„´ (ê´„í˜¸ ì—†ìŒ, ê¸°ì¡´ í˜•ì‹ ìœ ì§€)
            const normalPattern = /\*\*\s*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)\s*(?:-\s*(?:ì¶”ì§€|ì¶”ê°€ì§€ì›)\s+([\d,]+))?\s*(?:-\s*(?:ì „ì§€|ì „í™˜ì§€ì›ê¸ˆ?|ì „í™˜)\s+([\d,]+))?\s*(?:-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*(í• ë¶€\d*|\ud604\uae08)\s*([\d,]+)/i;
            
            // 4. íŒ¨í„´ ë§¤ì¹­ ì‹œë„ (ê´„í˜¸ í¬í•¨ íŒ¨í„´ ë¨¼ì € ì‹œë„)
            let match = text.match(parenthesizedPattern) || text.match(normalPattern);
            
            if (match) {
                // ë§¤ì¹­ëœ ê·¸ë£¹ ì¸ë±ìŠ¤ ì •ë¦¬
                const groups = {
                    ì¶œê³ ê°€: match[1] || '0',
                    ê³µì‹œ: match[2] || '0',
                    ì¶”ì§€: match[3] || '0',
                    ì „í™˜ì§€ì›ê¸ˆ: match[4] || '0',
                    í”„ë¦¬í• ë¶€: match[5] || '0',
                    í• ë¶€í˜„ê¸ˆ: match[6] || 'í˜„ê¸ˆ',
                    ìµœì¢…êµ¬ë§¤ê°€: match[7] || '0'
                };
                
                // ê³ ê° ì •ë³´ì— í• ë‹¹ (0ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ì—…ë°ì´íŠ¸)
                customerInfo['ì¶œê³ ê°€'] = groups.ì¶œê³ ê°€.trim();
                customerInfo['ê³µì‹œ'] = groups.ê³µì‹œ.trim();
                if (groups.ì¶”ì§€ !== '0') customerInfo['ì¶”ì§€'] = groups.ì¶”ì§€.trim();
                if (groups.ì „í™˜ì§€ì›ê¸ˆ !== '0') customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = groups.ì „í™˜ì§€ì›ê¸ˆ.trim();
                if (groups.í”„ë¦¬í• ë¶€ !== '0') customerInfo['í”„ë¦¬í• ë¶€'] = groups.í”„ë¦¬í• ë¶€.trim();
                
                console.log('ë§¤ì¹­ëœ ì •ë³´:', groups); // ë””ë²„ê¹…ìš©
                
                // í• ë¶€/í˜„ê¸ˆ ì—¬ë¶€ í™•ì¸
                if (groups.í• ë¶€í˜„ê¸ˆ.includes('í• ë¶€')) {
                    customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í• ë¶€';
                    
                    // í• ë¶€ê°œì›”ìˆ˜ ì¶”ì¶œ
                    const installmentMatch = groups.í• ë¶€í˜„ê¸ˆ.match(/(\d+)/);
                    if (installmentMatch && installmentMatch[1]) {
                        customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = installmentMatch[1] + 'ê°œì›”';
                    } else {
                        customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '24ê°œì›”'; // ê¸°ë³¸ê°’
                    }
                } else {
                    customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í˜„ê¸ˆ';
                    customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
                }
                
                customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = groups.ìµœì¢…êµ¬ë§¤ê°€.trim();
            } else {
                // ì¶”ê°€ íŒ¨í„´ ì‹œë„: ì¶”ì§€ë§Œ ìˆëŠ” ê²½ìš° (ê´„í˜¸ ì—†ìŒ)
                const pricePattern = /\*\*\s*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)(?:\s*-\s*(?:ì¶”ì§€|ì¶”ê°€ì§€ì›)\s+([\d,]+))?(?:\s*-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*(í• ë¶€\d*|\ud604\uae08)\s*([\d,]+)/i;
                const priceMatch = text.match(pricePattern);
                
                if (priceMatch) {
                    customerInfo['ì¶œê³ ê°€'] = priceMatch[1].trim();
                    customerInfo['ê³µì‹œ'] = priceMatch[2].trim();
                    if (priceMatch[3]) customerInfo['ì¶”ì§€'] = priceMatch[3].trim();
                    if (priceMatch[4]) customerInfo['í”„ë¦¬í• ë¶€'] = priceMatch[4].trim();
                    
                    // í• ë¶€/í˜„ê¸ˆ ì—¬ë¶€ í™•ì¸
                    if (priceMatch[5].includes('í• ë¶€')) {
                        customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í• ë¶€';
                        
                        // í• ë¶€ê°œì›”ìˆ˜ ì¶”ì¶œ
                        const installmentMatch = priceMatch[5].match(/(\d+)/);
                        if (installmentMatch && installmentMatch[1]) {
                            customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = installmentMatch[1] + 'ê°œì›”';
                        } else {
                            customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '24ê°œì›”'; // ê¸°ë³¸ê°’
                        }
                    } else {
                        customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í˜„ê¸ˆ';
                        customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
                    }
                    
                    customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = priceMatch[6].trim();
                } else {
                    // í˜„ê¸ˆ í˜•ì‹ íŒ¨í„´ í™•ì¸ (ì¶”ì§€ì™€ ì „í™˜ì§€ì›ê¸ˆì´ ëª¨ë‘ ìˆëŠ” ê²½ìš°)
                    const cashConversionPattern = /\*\*\s*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)(?:\s*-\s*(?:ì¶”ì§€|ì¶”ê°€ì§€ì›)\s+([\d,]+))?\s*(?:-\s*(?:ì „ì§€|ì „í™˜ì§€ì›ê¸ˆ?|ì „í™˜)\s+([\d,]+))?\s*(?:-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*í˜„ê¸ˆ\s*([\d,]+)/i;
                    const cashConversionMatch = text.match(cashConversionPattern);
                    
                    if (cashConversionMatch) {
                        customerInfo['ì¶œê³ ê°€'] = cashConversionMatch[1].trim();
                        customerInfo['ê³µì‹œ'] = cashConversionMatch[2].trim();
                        if (cashConversionMatch[3]) customerInfo['ì¶”ì§€'] = cashConversionMatch[3].trim();
                        if (cashConversionMatch[4]) customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = cashConversionMatch[4].trim();
                        if (cashConversionMatch[5]) customerInfo['í”„ë¦¬í• ë¶€'] = cashConversionMatch[5].trim();
                        customerInfo['ì¶”ì§€'] = cashConversionMatch[3].trim();
                        customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = cashConversionMatch[5].trim();
                        customerInfo['í”„ë¦¬í• ë¶€'] = cashConversionMatch[6] ? cashConversionMatch[6].trim() : '0';
                        customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í˜„ê¸ˆ';
                        customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
                        customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = cashConversionMatch[7].trim();
                    } else {
                        // ê¸°ì¡´ í˜„ê¸ˆ í˜•ì‹ íŒ¨í„´ (ì „í™˜ì§€ì›ê¸ˆ ì—†ëŠ” ê²½ìš°)
                        const cashPattern = /\*\*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)\s*-\s*ì¶”ì§€\s+([\d,]+)(?:\s*-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*í˜„ê¸ˆ\s*([\d,]+)/;
                        const cashMatch = text.match(cashPattern);
                        
                        if (cashMatch) {
                            customerInfo['ì¶œê³ ê°€'] = cashMatch[1].trim();
                            customerInfo['ê³µì‹œ'] = cashMatch[2].trim();
                            customerInfo['ì¶”ì§€'] = cashMatch[3].trim();
                            customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = '0';
                            customerInfo['í”„ë¦¬í• ë¶€'] = cashMatch[4] ? cashMatch[4].trim() : '0';
                            customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í˜„ê¸ˆ';
                            customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
                            customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = cashMatch[5].trim();
                        } else {
                            // í• ë¶€ í˜•ì‹ íŒ¨í„´ í™•ì¸ (ì „í™˜ì§€ì›ê¸ˆ í¬í•¨)
                            const installmentConversionPattern = /\*\*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)\s*-\s*ì¶”ì§€\s+([\d,]+)\s*-\s*(ì „í™˜ì§€ì›ê¸ˆ?|ì „í™˜)\s+([\d,]+)(?:\s*-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*í• ë¶€(\d+)\s*([\d,]+)/;
                            const installmentConversionMatch = text.match(installmentConversionPattern);
                            
                            if (installmentConversionMatch) {
                                customerInfo['ì¶œê³ ê°€'] = installmentConversionMatch[1].trim();
                                customerInfo['ê³µì‹œ'] = installmentConversionMatch[2].trim();
                                customerInfo['ì¶”ì§€'] = installmentConversionMatch[3].trim();
                                customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = installmentConversionMatch[5].trim();
                                customerInfo['í”„ë¦¬í• ë¶€'] = installmentConversionMatch[6] ? installmentConversionMatch[6].trim() : '0';
                                customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í• ë¶€';
                                customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = installmentConversionMatch[7] + 'ê°œì›”';
                                customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = installmentConversionMatch[8].trim();
                            } else {
                                // ê¸°ì¡´ í• ë¶€ í˜•ì‹ íŒ¨í„´ (ì „í™˜ì§€ì›ê¸ˆ ì—†ëŠ” ê²½ìš°)
                                const alternatePattern = /\*\*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)\s*-\s*ì¶”ì§€\s+([\d,]+)(?:\s*-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*í• ë¶€(\d+)\s*([\d,]+)/;
                                const alternateMatch = text.match(alternatePattern);
                                
                                if (alternateMatch) {
                                    customerInfo['ì¶œê³ ê°€'] = alternateMatch[1].trim();
                                    customerInfo['ê³µì‹œ'] = alternateMatch[2].trim();
                                    customerInfo['ì¶”ì§€'] = alternateMatch[3].trim();
                                    customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = '0';
                                    customerInfo['í”„ë¦¬í• ë¶€'] = alternateMatch[4] ? alternateMatch[4].trim() : '0';
                                    customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í• ë¶€';
                                    customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = alternateMatch[5] + 'ê°œì›”';
                                    customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = alternateMatch[6].trim();
                                } else {
                                    customerInfo['ì¶œê³ ê°€'] = '';
                                    customerInfo['ê³µì‹œ'] = '';
                                    customerInfo['ì¶”ì§€'] = '';
                                    customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = '0';
                                    customerInfo['í”„ë¦¬í• ë¶€'] = '0';
                                    customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = '';
                                    customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
                                    customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = '';
                                }
                            }
                        }
                    }
                }
            }
            
            // ëª¨ë¸ëª… ë³€í™˜ ë° ìš©ëŸ‰ ì •ë³´ ì¶”ì¶œ
            if (customerInfo['ëª¨ë¸ëª…']) {
                // ëª¨ë¸ëª… ë³€í™˜ ì ìš© (í«ë„¤ì„ â†’ ì‹¤ì œ ëª¨ë¸ëª…)
                const convertedModelName = convertModelName(customerInfo['ëª¨ë¸ëª…']);
                
                // ëª¨ë¸ì œì¡°ì‚¬ ìë™ ë¶„ë¥˜ (ì•„ì´í°/ê°¤ëŸ­ì‹œ)
                if (convertedModelName.toLowerCase().includes('ì•„ì´í°') || 
                    convertedModelName.toLowerCase().includes('iphone')) {
                    customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] = 'ì•„ì´í°';
                } else {
                    customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] = 'ê°¤ëŸ­ì‹œ';
                }
                
                // ë³€í™˜ëœ ëª¨ë¸ëª…ì—ì„œ ìš©ëŸ‰ ì •ë³´ ì¶”ì¶œ (ì˜ˆ: S936 256G â†’ ìš©ëŸ‰: 256G)
                const capacityMatch = convertedModelName.match(/(\d+(?:GB?|TB?))/i);
                if (capacityMatch) {
                    customerInfo['ìš©ëŸ‰'] = capacityMatch[1];
                    // ëª¨ë¸ëª…ì—ì„œ ìš©ëŸ‰ ë¶€ë¶„ ì œê±° (S936 256G â†’ S936)
                    customerInfo['ëª¨ë¸ëª…'] = convertedModelName.replace(/\s*\d+(?:GB?|TB?)/i, '').trim();
                    console.log(`ìš©ëŸ‰ ì¶”ì¶œ ë° ëª¨ë¸ëª… ì •ë¦¬: ${convertedModelName} â†’ ëª¨ë¸ëª…: ${customerInfo['ëª¨ë¸ëª…']}, ìš©ëŸ‰: ${customerInfo['ìš©ëŸ‰']}, ì œì¡°ì‚¬: ${customerInfo['ëª¨ë¸ì œì¡°ì‚¬']}`);
                } else {
                    customerInfo['ëª¨ë¸ëª…'] = convertedModelName;
                    customerInfo['ìš©ëŸ‰'] = '';
                    console.log(`ìš©ëŸ‰ ì—†ìŒ: ${convertedModelName} â†’ ëª¨ë¸ëª…: ${customerInfo['ëª¨ë¸ëª…']}, ì œì¡°ì‚¬: ${customerInfo['ëª¨ë¸ì œì¡°ì‚¬']}`);
                }
            } else {
                customerInfo['ìš©ëŸ‰'] = '';
                customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] = '';
            }
            
            // ë¶€ê°€ì„œë¹„ìŠ¤ì™€ ë³´í—˜ ë¶„ë¦¬ ì²˜ë¦¬
            if (customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤']) {
                const originalAddon = customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤'];
                const { ë³´í—˜, ë¶€ê°€ì„œë¹„ìŠ¤ } = parseAddonAndInsurance(customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤']);
                customerInfo['ë³´í—˜'] = ë³´í—˜;
                customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤'] = ë¶€ê°€ì„œë¹„ìŠ¤;
                
                console.log('ë¶€ê°€ì„œë¹„ìŠ¤ ë¶„ë¦¬ ê²°ê³¼:', {
                    'ì›ë³¸': originalAddon,
                    'ë¶„ë¦¬ëœ ë³´í—˜': ë³´í—˜,
                    'ë¶„ë¦¬ëœ ë¶€ê°€ì„œë¹„ìŠ¤': ë¶€ê°€ì„œë¹„ìŠ¤
                });
            }
            
            // ëª¨ë¸ì œì¡°ì‚¬ì— ë”°ë¥¸ ë³´í—˜ëª… ìë™ ì„¤ì • (ëª¨ë¸ì œì¡°ì‚¬ ì„¤ì • í›„ ì‹¤í–‰)
            if (customerInfo['ë³´í—˜'] && customerInfo['ëª¨ë¸ì œì¡°ì‚¬']) {
                if (customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] === 'ê°¤ëŸ­ì‹œ') {
                    customerInfo['ë³´í—˜'] = 'T ALLì¼€ì–´í”ŒëŸ¬ìŠ¤5 íŒŒì†80(5300)';
                    console.log('ê°¤ëŸ­ì‹œ ë³´í—˜ëª… ìë™ ì„¤ì •: T ALLì¼€ì–´í”ŒëŸ¬ìŠ¤5 íŒŒì†80(5300)');
                } else if (customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] === 'ì•„ì´í°') {
                    customerInfo['ë³´í—˜'] = 'Tì˜¬ì¼€ì–´+5 IíŒŒì†';
                    console.log('ì•„ì´í° ë³´í—˜ëª… ìë™ ì„¤ì •: Tì˜¬ì¼€ì–´+5 IíŒŒì†');
                }
            }
            
            return customerInfo;
        }

        // ì–‘ì‹ ë³€í™˜ í•¨ìˆ˜
        function convertFormat() {
            // ì¶œë ¥ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
            const outputContainer = document.getElementById('outputContainer');
            const singleOutputContainer = document.getElementById('singleOutputContainer');
            const splitOutputContainer = document.getElementById('splitOutputContainer');
            const luxExtraOutputs = document.getElementById('luxExtraOutputs');
            const dblackExtraOutputs = document.getElementById('dblackExtraOutputs');
            const actExtraOutputs = document.getElementById('actExtraOutputs');
            const bncomExtraOutputs = document.getElementById('bncomExtraOutputs');
            const hunetExtraOutputs = document.getElementById('hunetExtraOutputs');
            const millionExtraOutputs = document.getElementById('millionExtraOutputs');
            const ontExtraOutputs = document.getElementById('ontExtraOutputs');
            const keyValueTableContainer = document.getElementById('keyValueTableContainer');
            
            // ëª¨ë“  ì¶œë ¥ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
            if (splitOutputContainer) splitOutputContainer.style.display = 'none';
            if (luxExtraOutputs) luxExtraOutputs.style.display = 'none';
            if (dblackExtraOutputs) dblackExtraOutputs.style.display = 'none';
            if (actExtraOutputs) actExtraOutputs.style.display = 'none';
            if (bncomExtraOutputs) bncomExtraOutputs.style.display = 'none';
            if (hunetExtraOutputs) hunetExtraOutputs.style.display = 'none';
            if (millionExtraOutputs) millionExtraOutputs.style.display = 'none';
            if (ontExtraOutputs) ontExtraOutputs.style.display = 'none';
            const jangcheonExtraOutputs = document.getElementById('jangcheonExtraOutputs');
            if (jangcheonExtraOutputs) jangcheonExtraOutputs.style.display = 'none';
            if (keyValueTableContainer) keyValueTableContainer.style.display = 'none';
            
            // ê¸°ë³¸ ì¶œë ¥ ì»¨í…Œì´ë„ˆ í‘œì‹œ
            if (singleOutputContainer) singleOutputContainer.style.display = 'block';
            
            // ëª¨ë“  textarea ë‚´ìš© ì´ˆê¸°í™”
            const allTextareas = outputContainer.getElementsByTagName('textarea');
            for (let textarea of allTextareas) {
                textarea.value = '';
            }
            
            // ëª¨ë“  DOM ìš”ì†Œ ì°¸ì¡° ê°€ì ¸ì˜¤ê¸°
            const agencySelect = document.getElementById('agency');
            const inputText = document.getElementById('inputText');
            const telecomSelect = document.getElementById('telecom');
            const deviceSerialInput = document.getElementById('deviceSerial');
            const simSerialInput = document.getElementById('simSerial');
            
            // ì„ íƒëœ ê°’ ê°€ì ¸ì˜¤ê¸°
            const selectedTelecom = telecomSelect ? telecomSelect.value : '';
            const selectedAgency = agencySelect ? agencySelect.value : '';
            
            // ì…ë ¥ê°’ ê²€ì¦
            if (!selectedTelecom || !selectedAgency) {
                alert('í†µì‹ ì‚¬ì™€ ëŒ€ë¦¬ì ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                // ê³ ê° ì •ë³´ ì¶”ì¶œ
                const customerInfo = extractCustomerInfo(inputText.value || '');
                
                // ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸ì™€ ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ ì¶”ê°€
                if (deviceSerialInput && deviceSerialInput.value.trim()) {
                    customerInfo['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] = deviceSerialInput.value.trim();
                }
                if (simSerialInput && simSerialInput.value.trim()) {
                    customerInfo['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] = simSerialInput.value.trim();
                }

                console.log('ì¶”ì¶œëœ ê³ ê° ì •ë³´:', customerInfo);
                console.table(customerInfo);
                
                // í•„ìˆ˜ í•­ëª© ì²´í¬ ë° alert í‘œì‹œ
                const requiredFields = ['ê°€ì…ìœ í˜•', 'í• ì¸ìœ í˜•', 'ìœ ì‹¬', 'ìš”ê¸ˆì œ', 'ì•½ì •ê°œì›”ìˆ˜', 'ìµœì¢…êµ¬ë§¤ê°€', 'ìš©ëŸ‰', 'ì œì¡°ì‚¬', 'í˜„ì¬í†µì‹ ì‚¬'];
                const emptyFields = [];
                
                requiredFields.forEach(field => {
                    if (!customerInfo[field] || customerInfo[field].trim() === '') {
                        emptyFields.push(field);
                    }
                });
                
                if (emptyFields.length > 0) {
                    const missingItems = emptyFields.join(', ');
                    alert(`ë‹¤ìŒ í•­ëª©ë“¤ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤: ${missingItems}\n ì–´ë“œë¯¼ ë©”ëª¨ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.`);
                }
                
                // ìƒˆë¡œìš´ êµ¬ì¡°ì˜ í…œí”Œë¦¿ ì‹œìŠ¤í…œ ì‚¬ìš© ì‹œë„
                let result;
                let outputType;
                
                if (TELECOM_CONFIG[selectedTelecom]?.agencies[selectedAgency]) {
                    // ìƒˆë¡œìš´ êµ¬ì¡° ì‚¬ìš©
                    const agencyConfig = TELECOM_CONFIG[selectedTelecom].agencies[selectedAgency];
                    result = TemplateManager.applyTemplate(selectedTelecom, selectedAgency, customerInfo);
                    outputType = agencyConfig.outputType;
                    
                    // ê²°ê³¼ ì¶œë ¥
                    OutputManager.showOutput(result, outputType, selectedTelecom, selectedAgency);
                } else {
                    // ê¸°ì¡´ êµ¬ì¡° ì‚¬ìš© (ì´ì „ ë²„ì „ê³¼ì˜ í˜¸í™˜ì„± ìœ ì§€)
                    const isSpecialAgency = (selectedTelecom === 'KT' && selectedAgency === 'ì¬í¬') || 
                                          (selectedTelecom === 'LG' && selectedAgency === 'ì†Œë¦¬');
                    const isLuxAgency = (selectedTelecom === 'SK' && selectedAgency === 'ëŸ­ìŠ¤');
                    const isDblackAgency = (selectedTelecom === 'SK' && selectedAgency === 'ë“œë¸”ë™');
                    const isActAgency = (selectedTelecom === 'SK' && selectedAgency === 'ACT(íƒë°°)');
                    const isBncomAgency = (selectedTelecom === 'SK' && selectedAgency === 'ë¹„ì•¤ì»´');
                    const isHunetAgency = (selectedTelecom === 'LG' && selectedAgency === 'ì œì´/íœ´ë„·');
                    
                    // ê¸°ì¡´ í…œí”Œë¦¿ ì‹œìŠ¤í…œ ì‚¬ìš©
                    const template = templates[selectedTelecom]?.[selectedAgency];
                    if (!template) {
                        throw new Error('ì„ íƒí•˜ì‹  ëŒ€ë¦¬ì ì— ëŒ€í•œ í…œí”Œë¦¿ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                    
                    result = template(customerInfo);
                    
                    // ê¸°ì¡´ ì¶œë ¥ ë¡œì§ ì‚¬ìš©
                    if (isLuxAgency || isDblackAgency || isActAgency || isBncomAgency || isHunetAgency) {
                        // íŠ¹ìˆ˜ ëŒ€ë¦¬ì ì˜ ê²½ìš° ê¸°ë³¸ ì¶œë ¥ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
                        if (singleOutputContainer) singleOutputContainer.style.display = 'none';
                        
                        if (isActAgency) {
                            const actOutputs = document.getElementById('actExtraOutputs');
                            if (actOutputs) {
                                actOutputs.style.display = 'block';
                                const stockText = document.getElementById('actStockText');
                                const openText = document.getElementById('actOpenText');
                                if (stockText) stockText.value = result.stockRequest || '';
                                if (openText) openText.value = result.openRequest || '';
                            }
                        } else if (isBncomAgency) {
                            const bncomOutputs = document.getElementById('bncomExtraOutputs');
                            if (bncomOutputs) {
                                bncomOutputs.style.display = 'block';
                                const stockText = document.getElementById('bncomStockText');
                                const openText = document.getElementById('bncomOpenText');
                                if (stockText) stockText.value = result.stockRequest || '';
                                if (openText) openText.value = result.openRequest || '';
                            }
                        } else if (isHunetAgency) {
                            const hunetOutputs = document.getElementById('hunetExtraOutputs');
                            if (hunetOutputs) {
                                hunetOutputs.style.display = 'block';
                                const confirmText = document.getElementById('hunetConfirmText');
                                const deliveryText = document.getElementById('hunetDeliveryText');
                                const openText = document.getElementById('hunetOpenText');
                                if (confirmText) confirmText.value = result.confirm || '';
                                if (deliveryText) deliveryText.value = result.delivery || '';
                                if (openText) openText.value = result.open || '';
                            }
                        } else {
                            const outputDivId = isLuxAgency ? 'luxExtraOutputs' : 'dblackExtraOutputs';
                            const outputDiv = document.getElementById(outputDivId);
                            if (outputDiv) {
                                outputDiv.style.display = 'block';
                                const requestField = isLuxAgency ? 'luxRequestText' : 'dblackRequestText';
                                const stockField = isLuxAgency ? 'luxStockText' : 'dblackStockText';
                                const memoField = isLuxAgency ? 'luxMemoText' : 'dblackMemoText';
                                
                                document.getElementById(requestField).value = result.request || '';
                                document.getElementById(stockField).value = result.stock || '';
                                document.getElementById(memoField).value = result.memo || '';
                            }
                        }
                    } else if (isSpecialAgency) {
                        // íŠ¹ìˆ˜ ëŒ€ë¦¬ì  ì²˜ë¦¬ (ì¬í¬, ì†Œë¦¬) - ê¸°ë³¸ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
                        if (singleOutputContainer) singleOutputContainer.style.display = 'none';
                        
                        const container = document.getElementById('keyValueTableContainer');
                        if (container) {
                            container.style.display = 'block';
                            createKeyValueTable(customerInfo);
                        }
                    } else {
                        // ì¼ë°˜ ëŒ€ë¦¬ì  ì²˜ë¦¬
                        const container = document.getElementById('singleOutputContainer');
                        if (container) {
                            container.style.display = 'block';
                            document.getElementById('outputText').value = result;
                        }
                    }
                }
                
                // ë³€í™˜ ì´ë ¥ ì €ì¥
                saveToHistory(customerInfo, selectedTelecom, selectedAgency);
                
                // ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
                setupDoubleClickCopy();
                
            } catch (error) {
                console.error('ë³€í™˜ ì¤‘ ì˜¤ë¥˜:', error);
                alert('ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
        
        // í‚¤-ê°’ í…Œì´ë¸” ìƒì„± í•¨ìˆ˜
        function createKeyValueTable(customerInfo) {
            const tableBody = document.querySelector('#keyValueTable tbody');
            tableBody.innerHTML = ''; // í…Œì´ë¸” ì´ˆê¸°í™”
            
            // í˜„ì¬ ì„ íƒëœ ëŒ€ë¦¬ì  í™•ì¸
            const agencySelect = document.getElementById('agency');
            const selectedAgency = agencySelect ? agencySelect.value : '';
            
            // ê¸°ë³¸ ì •ë³´ ì²˜ë¦¬ (ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ê°’ ì„ íƒ)
            const processedInfo = {
                'ê°€ì…ìëª…': customerInfo['ê°€ì…ìëª…'] || customerInfo['ê³ ê°ëª…'] || '',
                'ê°œí†µë²ˆí˜¸': customerInfo['ê°œí†µë²ˆí˜¸'] || customerInfo['ì „í™”ë²ˆí˜¸'] || '',
                'ì£¼ë¯¼ë²ˆí˜¸': customerInfo['ì£¼ë¯¼ë²ˆí˜¸'] || customerInfo['ìƒë…„ì›”ì¼'] || '',
                'ëª¨ë¸ëª…': customerInfo['ëª¨ë¸ëª…'] || '',
                'ìš©ëŸ‰': customerInfo['ìš©ëŸ‰'] || '',
                'ìƒ‰ìƒ': customerInfo['ìƒ‰ìƒ'] || '',
                'ê°€ì…ìœ í˜•': customerInfo['ê°€ì…ìœ í˜•'] || '',
                'í• ì¸ìœ í˜•': customerInfo['í• ì¸ìœ í˜•'] || '',
                'ì•½ì •ê°œì›”ìˆ˜': customerInfo['ì•½ì •ê°œì›”ìˆ˜'] || '',
                'ìš”ê¸ˆì œ': customerInfo['ìš”ê¸ˆì œ'] || '',
                'í• ë¶€í˜„ê¸ˆì—¬ë¶€': customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] || '',
                'í• ë¶€ê°œì›”ìˆ˜': customerInfo['í• ë¶€ê°œì›”ìˆ˜'] || '',
                'í˜„ì¬í†µì‹ ì‚¬': customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || '',
                'ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸': customerInfo['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || '',
                'ìœ ì‹¬': customerInfo['ìœ ì‹¬'] || '',
                'ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸': customerInfo['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || '',
                'ì¶œê³ ê°€': customerInfo['ì¶œê³ ê°€'] || '',
                'ê³µì‹œì§€ì›ê¸ˆ': customerInfo['ê³µì‹œ'] || '',
                'ì¶”ê°€ì§€ì›ê¸ˆ': customerInfo['ì¶”ì§€'] || '',
                'ì „í™˜ì§€ì›ê¸ˆ': customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] || '',
                'í”„ë¦¬í• ë¶€': customerInfo['í”„ë¦¬í• ë¶€'] || '',
                'ìµœì¢…êµ¬ë§¤ê°€': customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] || '',
                'ë¶€ê°€ì„œë¹„ìŠ¤': customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤'] || '',
                'ë³´í—˜': customerInfo['ë³´í—˜'] || '',
                'ë°°ì†¡ì£¼ì†Œì§€': customerInfo['ë°°ì†¡ì£¼ì†Œì§€'] || customerInfo['íƒë°°ì£¼ì†Œ'] || '',
                'ë¯¸ì„±ë…„ìì—¬ë¶€': customerInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„'] || customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ëª…'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'] || ''
            };
            
            // í…Œì´ë¸”ì— í‘œì‹œí•  í•„ë“œ ìˆœì„œ ì •ì˜
            const basicFields = [
                'ê°€ì…ìëª…', 'ê°œí†µë²ˆí˜¸', 'ì£¼ë¯¼ë²ˆí˜¸', 'ëª¨ë¸ëª…', 'ìš©ëŸ‰', 'ìƒ‰ìƒ',
                'ê°€ì…ìœ í˜•', 'í• ì¸ìœ í˜•', 'ì•½ì •ê°œì›”ìˆ˜', 'ìš”ê¸ˆì œ', 
                'í• ë¶€í˜„ê¸ˆì—¬ë¶€', 'í• ë¶€ê°œì›”ìˆ˜', 'í˜„ì¬í†µì‹ ì‚¬'
            ];
            
            const deviceFields = [
                'ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸', 'ìœ ì‹¬', 'ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'
            ];
            
            const priceFields = [
                'ì¶œê³ ê°€', 'ê³µì‹œì§€ì›ê¸ˆ', 'ì¶”ê°€ì§€ì›ê¸ˆ', 'ì „í™˜ì§€ì›ê¸ˆ', 
                'í”„ë¦¬í• ë¶€', 'ìµœì¢…êµ¬ë§¤ê°€'
            ];
            
            const additionalFields = [
                'ë¶€ê°€ì„œë¹„ìŠ¤', 'ë³´í—˜', 'ë°°ì†¡ì£¼ì†Œì§€'
            ];
            
            const minorFields = [
                'ë¯¸ì„±ë…„ìì—¬ë¶€', 'ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„', 'ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜', 'ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'
            ];
            
            // ê¸°ë³¸ ì •ë³´ í•„ë“œ ì¶”ê°€
            basicFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ë‹¨ë§ê¸° ì •ë³´ í•„ë“œ ì¶”ê°€
            deviceFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ê°€ê²© ì •ë³´ í•„ë“œ ì¶”ê°€ (ë¹ˆ ê°’ì´ì–´ë„ í‘œì‹œ)
            priceFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                addTableRow(tableBody, fieldName, value || '');
            });
            
            // ì¶”ê°€ ì •ë³´ í•„ë“œ ì¶”ê°€
            additionalFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ë¯¸ì„±ë…„ìì¸ ê²½ìš° ë²•ì •ëŒ€ë¦¬ì¸ ì •ë³´ ì¶”ê°€
            if (processedInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] === 'Y') {
                minorFields.forEach(fieldName => {
                    const value = processedInfo[fieldName];
                    if (value !== undefined && value !== null && value !== '') {
                        addTableRow(tableBody, fieldName, value);
                    }
                });
            }
            
            // ì¶”ê°€ í…Œì´ë¸” ì•ˆë‚´ë¬¸ í‘œì‹œ
            const copyNoticeDiv = document.querySelector('.copy-notice');
            if (copyNoticeDiv) {
                copyNoticeDiv.textContent = `${selectedAgency} - ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.`;
            }
        }
        
        // í‚¤-ê°’ í…Œì´ë¸”ì— í–‰ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
        function addTableRow(tableBody, key, value) {
            const row = document.createElement('tr');
            
            const keyCell = document.createElement('td');
            keyCell.className = 'key-cell';
            keyCell.textContent = key;
            
            const valueCell = document.createElement('td');
            valueCell.className = 'value-cell';
            valueCell.textContent = value;
            valueCell.setAttribute('data-value', value);
            valueCell.onclick = function() {
                copyToClipboardWithFeedback(this.getAttribute('data-value'), this);
            };
            
            row.appendChild(keyCell);
            row.appendChild(valueCell);
            tableBody.appendChild(row);
        }
        
        // í´ë¦½ë³´ë“œì— ë³µì‚¬ í›„ í”¼ë“œë°±ì„ ì œê³µí•˜ëŠ” í•¨ìˆ˜
        function copyToClipboardWithFeedback(text, element) {
            navigator.clipboard.writeText(text).then(() => {
                // ë³µì‚¬ ì„±ê³µ í‘œì‹œ
                element.classList.add('copied');
                
                // 1.5ì´ˆ í›„ ë³µì‚¬ ì„±ê³µ í‘œì‹œ ì œê±°
                setTimeout(() => {
                    element.classList.remove('copied');
                }, 1500);
                
                // í™”ë©´ ì¤‘ì•™ì— ë³µì‚¬ ì„±ê³µ ì•Œë¦¼ í‘œì‹œ
                const copyNotice = document.createElement('div');
                copyNotice.className = 'copy-success';
                copyNotice.textContent = 'ë³µì‚¬ë¨!';
                copyNotice.style.position = 'fixed';
                copyNotice.style.top = '50%';
                copyNotice.style.left = '50%';
                copyNotice.style.transform = 'translate(-50%, -50%)';
                copyNotice.style.backgroundColor = 'rgba(76, 175, 80, 0.9)';
                copyNotice.style.color = 'white';
                copyNotice.style.padding = '10px 20px';
                copyNotice.style.borderRadius = '5px';
                copyNotice.style.zIndex = '2000';
                copyNotice.style.transition = 'opacity 0.3s';
                
                document.body.appendChild(copyNotice);
                
                // 1ì´ˆ í›„ ì•Œë¦¼ í˜ì´ë“œì•„ì›ƒ
                setTimeout(() => {
                    copyNotice.style.opacity = '0';
                    setTimeout(() => {
                        document.body.removeChild(copyNotice);
                    }, 300);
                }, 1000);
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            });
        }

        // ê²°ê³¼ ë³µì‚¬ í•¨ìˆ˜
        function copyToClipboard() {
            // í‚¤-ê°’ í…Œì´ë¸”ì´ í‘œì‹œë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            const keyValueTableContainer = document.getElementById('keyValueTableContainer');
            if (keyValueTableContainer && keyValueTableContainer.style.display !== 'none') {
                alert('í‚¤-ê°’ í…Œì´ë¸”ì—ì„œëŠ” ê° í•­ëª©ì„ í´ë¦­í•˜ì—¬ ê°œë³„ì ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // SK-íë¸Œì˜ ê²½ìš° ì—¬ëŸ¬ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ê°€ ìˆì„ ìˆ˜ ìˆìŒ
            const outputText1 = document.getElementById('outputText1');
            const outputText2 = document.getElementById('outputText2');
            const outputText = document.getElementById('outputText');
            
            let textToCopy = '';
            let elementToCopy = null;
            
            if (outputText1 && outputText1.style.display !== 'none' && outputText1.value.trim() !== '') {
                textToCopy = outputText1.value;
                elementToCopy = outputText1;
            } else if (outputText2 && outputText2.style.display !== 'none' && outputText2.value.trim() !== '') {
                textToCopy = outputText2.value;
                elementToCopy = outputText2;
            } else if (outputText && outputText.value.trim() !== '') {
                textToCopy = outputText.value;
                elementToCopy = outputText;
            } else {
                alert('ë³µì‚¬í•  í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // í´ë¦½ë³´ë“œ APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë³µì‚¬
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(textToCopy)
                    .then(() => {
                        // ë³µì‚¬ ì™„ë£Œ í‘œì‹œ
                        const originalBgColor = elementToCopy.style.backgroundColor;
                        elementToCopy.style.backgroundColor = '#e6ffe6';
                        
                        setTimeout(() => {
                            elementToCopy.style.backgroundColor = originalBgColor;
                        }, 500);
                        
                        // í™”ë©´ ì¤‘ì•™ì— ë³µì‚¬ ì„±ê³µ ì•Œë¦¼ í‘œì‹œ
                        const copyNotice = document.createElement('div');
                        copyNotice.className = 'copy-success';
                        copyNotice.textContent = 'ë³µì‚¬ë¨!';
                        copyNotice.style.position = 'fixed';
                        copyNotice.style.top = '50%';
                        copyNotice.style.left = '50%';
                        copyNotice.style.transform = 'translate(-50%, -50%)';
                        copyNotice.style.backgroundColor = 'rgba(76, 175, 80, 0.9)';
                        copyNotice.style.color = 'white';
                        copyNotice.style.padding = '10px 20px';
                        copyNotice.style.borderRadius = '5px';
                        copyNotice.style.zIndex = '2000';
                        copyNotice.style.transition = 'opacity 0.3s';
                        
                        document.body.appendChild(copyNotice);
                        
                        // 1ì´ˆ í›„ ì•Œë¦¼ í˜ì´ë“œì•„ì›ƒ
                        setTimeout(() => {
                            copyNotice.style.opacity = '0';
                            setTimeout(() => {
                                document.body.removeChild(copyNotice);
                            }, 300);
                        }, 1000);
                    })
                    .catch(err => {
                        console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                        alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    });
            } else {
                // ì˜ˆì „ ë°©ì‹ ì‚¬ìš© (Clipboard APIê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê²½ìš°)
                elementToCopy.select();
                document.execCommand('copy');
                
                // ë³µì‚¬ ì™„ë£Œ í‘œì‹œ
                const originalBgColor = elementToCopy.style.backgroundColor;
                elementToCopy.style.backgroundColor = '#e6ffe6';
                
                setTimeout(() => {
                    elementToCopy.style.backgroundColor = originalBgColor;
                }, 500);
                
                // ì•Œë¦¼ í‘œì‹œ
                alert('í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // í…ìŠ¤íŠ¸ì—ë¦¬ì–´ ë”ë¸”í´ë¦­ ë³µì‚¬ í•¨ìˆ˜
        function setupDoubleClickCopy() {
            // ì¶œë ¥ ì»¨í…Œì´ë„ˆì— ì´ë²¤íŠ¸ ìœ„ì„ ë°©ì‹ìœ¼ë¡œ ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            const outputContainer = document.getElementById('outputContainer');
            
            // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° (ì¤‘ë³µ ë°©ì§€)
            outputContainer.removeEventListener('dblclick', handleTextareaDoubleClick);
            
            // ì´ë²¤íŠ¸ ìœ„ì„ì„ ì‚¬ìš©í•˜ì—¬ ë™ì ìœ¼ë¡œ ì¶”ê°€ëœ textareaì—ë„ ì ìš©
            outputContainer.addEventListener('dblclick', handleTextareaDoubleClick);
        }
        
        // ì´ë²¤íŠ¸ ìœ„ì„ì„ ìœ„í•œ í•¸ë“¤ëŸ¬
        function handleTextareaDoubleClick(event) {
            // ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ìš”ì†Œê°€ textareaì¸ì§€ í™•ì¸
            if (event.target.tagName === 'TEXTAREA') {
                handleDoubleClick(event);
            }
        }
        
        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            // 2ì´ˆ í›„ì— í† ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸°
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }
        
        // ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        function handleDoubleClick(event) {
            const textarea = event.target;
            
            // í…ìŠ¤íŠ¸ ì„ íƒ
            textarea.select();
            
            // í´ë¦½ë³´ë“œì— ë³µì‚¬
            navigator.clipboard.writeText(textarea.value).then(() => {
                // ë³µì‚¬ ì„±ê³µ ì‹œ ì‹œê°ì  í”¼ë“œë°±
                const originalBorder = textarea.style.border;
                textarea.style.border = '2px solid #4CAF50';
                textarea.style.boxShadow = '0 0 0 2px rgba(76, 175, 80, 0.3)';
                
                // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
                showToast('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                
                // 0.5ì´ˆ í›„ì— ì›ë˜ ìŠ¤íƒ€ì¼ë¡œ ë³µì›
                setTimeout(() => {
                    textarea.style.border = originalBorder;
                    textarea.style.boxShadow = '';
                }, 500);
            }).catch(err => {
                console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì˜¤ë¥˜:', err);
                alert('ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            });
        }
        
        // ë³€í™˜ ì´ë ¥ ì €ì¥
        function saveToHistory(customerInfo, telecom, agency) {
            try {
                let history = JSON.parse(localStorage.getItem('conversionHistory') || '[]');
                
                // ì›ë³¸ í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ì €ì¥í•˜ì§€ ì•ŠìŒ (ë¶ˆí•„ìš”í•œ ë°ì´í„° ë°©ì§€)
                const inputText = document.getElementById('inputText');
                if (inputText && inputText.value.trim()) {
                    customerInfo.ì›ë³¸í…ìŠ¤íŠ¸ = inputText.value.trim();
                } else {
                    return; // ì›ë³¸ í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ì €ì¥í•˜ì§€ ì•ŠìŒ
                }
                
                // ì¤‘ë³µ ì²´í¬ (ë™ì¼í•œ ê³ ê°ëª…ê³¼ ì „í™”ë²ˆí˜¸ê°€ ìˆëŠ”ì§€)
                const exists = history.some(item => {
                    const sameName = String(item.customerInfo.ê³ ê°ëª… || '') === String(customerInfo.ê³ ê°ëª… || '');
                    const samePhone = String(item.customerInfo.ì „í™”ë²ˆí˜¸ || '') === String(customerInfo.ì „í™”ë²ˆí˜¸ || '');
                    const sameAgency = String(item.agency || '') === String(agency || '');
                    
                    // ê³ ê°ëª…ê³¼ ì „í™”ë²ˆí˜¸ê°€ ëª¨ë‘ ì¼ì¹˜í•˜ê³ , ë™ì¼í•œ ëŒ€ë¦¬ì ì¸ ê²½ìš°ì—ë§Œ ì¤‘ë³µìœ¼ë¡œ íŒë‹¨
                    return sameName && samePhone && sameAgency;
                });
                
                if (!exists) {
                    // ìµœëŒ€ 50ê°œê¹Œì§€ ì €ì¥
                    if (history.length >= 50) {
                        history.pop(); // ê°€ì¥ ì˜¤ë˜ëœ í•­ëª© ì œê±°
                    }
                    
                    // ìƒˆ í•­ëª© ì¶”ê°€ (ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê¸° ìœ„í•´ unshift ì‚¬ìš©)
                    history.unshift({
                        id: Date.now(),
                        customerInfo: customerInfo,
                        telecom: telecom,
                        agency: agency,
                        timestamp: new Date().toISOString()
                    });
                    
                    localStorage.setItem('conversionHistory', JSON.stringify(history));
                }
            } catch (e) {
                console.error('ì´ë ¥ ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
            }
        }
        
        // ë³€í™˜ ì´ë ¥ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadHistory() {
            try {
                const history = JSON.parse(localStorage.getItem('conversionHistory') || '[]');
                const historyList = document.getElementById('historyList');
                
                if (!historyList) return;
                
                if (history.length === 0) {
                    historyList.innerHTML = '<div class="no-history">ì €ì¥ëœ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }
                
                historyList.innerHTML = history.map(item => `
                    <div class="history-item" onclick="loadFromHistory('${item.id}')">
                        <div class="history-header">
                            <span class="history-name">${item.customerInfo.ê³ ê°ëª… || 'ì´ë¦„ ì—†ìŒ'}</span>
                            <span class="history-phone">${item.customerInfo.ì „í™”ë²ˆí˜¸ || item.customerInfo.ì—°ë½ì²˜ || 'ì „í™”ë²ˆí˜¸ ì—†ìŒ'}</span>
                            <span class="history-time">${new Date(item.timestamp).toLocaleString()}</span>
                        </div>
                        <div class="history-details">
                            <span class="history-model">${item.customerInfo.ëª¨ë¸ëª… || ''} ${item.customerInfo.ìƒ‰ìƒ || ''}</span>
                            <span class="history-plan">${item.customerInfo.ìš”ê¸ˆì œ || ''}</span>
                        </div>
                        <div class="history-footer">
                            <span class="history-agency">${item.telecom} / ${item.agency}</span>
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                console.error('ì´ë ¥ ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
            }
        }
        
        // ì´ë ¥ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadFromHistory(id) {
            try {
                const history = JSON.parse(localStorage.getItem('conversionHistory') || '[]');
                const item = history.find(item => item.id.toString() === id.toString());
                
                if (item) {
                    // í†µì‹ ì‚¬ì™€ ëŒ€ë¦¬ì  ì„ íƒ
                    const telecomSelect = document.getElementById('telecom');
                    const agencySelect = document.getElementById('agency');
                    
                    // í˜„ì¬ ì„ íƒëœ ê°’ ì €ì¥
                    const currentTelecom = telecomSelect.value;
                    const currentAgency = agencySelect.value;
                    
                    // ìƒˆ ê°’ìœ¼ë¡œ ì„¤ì •
                    telecomSelect.value = item.telecom;
                    
                    // ëŒ€ë¦¬ì ì´ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€ ì„ íƒ
                    const checkAgency = setInterval(() => {
                        updateAgencies();
                        
                        // ëŒ€ë¦¬ì ì´ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸ (ì˜µì…˜ ëª©ë¡ì— ìˆëŠ”ì§€)
                        const agencyOptions = Array.from(agencySelect.options).map(opt => opt.value);
                        if (agencyOptions.includes(item.agency)) {
                            clearInterval(checkAgency);
                            
                            // ëŒ€ë¦¬ì  ì„ íƒ
                            agencySelect.value = item.agency;
                            
                            // ì…ë ¥ í•„ë“œ ì±„ìš°ê¸°
                            const info = item.customerInfo;
                            const inputText = document.getElementById('inputText');
                            const deviceSerial = document.getElementById('deviceSerial');
                            const simSerial = document.getElementById('simSerial');
                            
                            // ì›ë³¸ í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒì„±
                            if (!info.ì›ë³¸í…ìŠ¤íŠ¸) {
                                let defaultText = '';
                                if (info.ê³ ê°ëª…) defaultText += `ê³ ê°ëª…: ${info.ê³ ê°ëª…}\n`;
                                if (info.ì „í™”ë²ˆí˜¸) defaultText += `ì „í™”ë²ˆí˜¸: ${info.ì „í™”ë²ˆí˜¸}\n`;
                                if (info.ëª¨ë¸ëª…) defaultText += `ëª¨ë¸ëª…: ${info.ëª¨ë¸ëª…}\n`;
                                if (info.ìƒ‰ìƒ) defaultText += `ìƒ‰ìƒ: ${info.ìƒ‰ìƒ}\n`;
                                if (info.ìš”ê¸ˆì œ) defaultText += `ìš”ê¸ˆì œ: ${info.ìš”ê¸ˆì œ}\n`;
                                if (info.ê°€ì…ìœ í˜•) defaultText += `ê°€ì…ìœ í˜•: ${info.ê°€ì…ìœ í˜•}\n`;
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€) defaultText += `í• ë¶€/í˜„ê¸ˆ: ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€}\n`;
                                if (info.ìµœì¢…êµ¬ë§¤ê°€) defaultText += `ìµœì¢…êµ¬ë§¤ê°€: ${info.ìµœì¢…êµ¬ë§¤ê°€}ì›\n`;
                                
                                inputText.value = defaultText.trim();
                            } else {
                                inputText.value = info.ì›ë³¸í…ìŠ¤íŠ¸ || '';
                            }
                            
                            if (deviceSerial) deviceSerial.value = info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || '';
                            if (simSerial) simSerial.value = info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || '';
                            
                            // ë³€í™˜ ì‹¤í–‰ (ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ì–´ UI ì—…ë°ì´íŠ¸ê°€ ì™„ë£Œë˜ë„ë¡)
                            setTimeout(() => {
                                convertFormat();
                                closeHistoryPopup();
                            }, 300);
                        }
                    }, 50);
                }
            } catch (e) {
                console.error('ì´ë ¥ ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
                alert('ì´ë ¥ ë¶ˆëŸ¬ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ì´ë ¥ íŒì—… ì—´ê¸°
        function openHistoryPopup() {
            const popup = document.getElementById('historyPopup');
            if (popup) {
                loadHistory();
                popup.style.display = 'flex';
            }
        }
        
        // ì´ë ¥ íŒì—… ë‹«ê¸°
        function closeHistoryPopup() {
            const popup = document.getElementById('historyPopup');
            if (popup) {
                popup.style.display = 'none';
            }
        }
        
        // ì´ë ¥ ì „ì²´ ì‚­ì œ
        function clearHistory() {
            if (confirm('ëª¨ë“  ë³€í™˜ ì´ë ¥ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                localStorage.removeItem('conversionHistory');
                loadHistory();
            }
        }
        
        // ëª¨ë‘ ì§€ìš°ê¸° í•¨ìˆ˜
        function clearAll() {
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('inputText').value = '';
            document.getElementById('deviceSerial').value = '';
            document.getElementById('simSerial').value = '';
            
            // ì—‘ì…€ íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
            document.getElementById('excelFile').value = '';
            document.getElementById('extractCount').textContent = '';
            
            // í†µì‹ ì‚¬ ë° ëŒ€ë¦¬ì  ì„ íƒ ì´ˆê¸°í™”
            const telecomSelect = document.getElementById('telecom');
            const agencySelect = document.getElementById('agency');
            const currentTelecom = telecomSelect.value;
            const currentAgency = agencySelect.value;
            
            // ì¶œë ¥ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™” (ê¸°ì¡´ êµ¬ì¡° ìœ ì§€)
            const outputContainer = document.getElementById('outputContainer');
            outputContainer.style.display = 'block';
            
            // Reset to the original structure with proper agency labels for both ëŸ­ìŠ¤ and ë“œë¸”ë™
            outputContainer.innerHTML = `
                <!-- ëŸ­ìŠ¤ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ) -->
                <div id="luxExtraOutputs" style="display:none;">
                    <div class="form-group">
                        <label for="luxRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                        <textarea id="luxRequestText" class="output-textarea compact-textarea" placeholder="ì‹ ì¡° ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="luxStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                        <textarea id="luxStockText" class="output-textarea compact-textarea" placeholder="ì¬ê³  ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="luxMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                        <textarea id="luxMemoText" class="output-textarea compact-textarea" placeholder="ê°œí†µ ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                </div>
                
                <!-- ë“œë¸”ë™ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ) -->
                <div id="dblackExtraOutputs" style="display:none;">
                    <div class="form-group">
                        <label for="dblackRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                        <textarea id="dblackRequestText" class="output-textarea compact-textarea" placeholder="ì‹ ì¡° ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="dblackStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                        <textarea id="dblackStockText" class="output-textarea compact-textarea" placeholder="ì¬ê³  ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="dblackMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                        <textarea id="dblackMemoText" class="output-textarea compact-textarea" placeholder="ê°œí†µ ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                </div>
                <style>
                    /* ëŸ­ìŠ¤ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ ìŠ¤íƒ€ì¼ */
                    #luxRequestText, #dblackRequestText {
                        height: 130px !important;
                        min-height: 130px;
                        resize: vertical;
                    }
                    #luxStockText, #dblackStockText {
                        height: 220px !important;
                        min-height: 220px;
                        resize: vertical;
                    }
                    #luxMemoText, #dblackMemoText {
                        height: 150px !important;
                        min-height: 150px;
                        resize: vertical;
                    }
                    #outputText1 {
                        height: 170px !important;
                        min-height: 170px;
                    }
                </style>
                <div id="singleOutputContainer">
                    <div class="form-group">
                        <label id="outputTextLabel" for="outputText">ë³€í™˜ëœ í…ìŠ¤íŠ¸:</label>
                        <textarea id="outputText" class="output-textarea" placeholder="ì—¬ê¸°ì— ë³€í™˜ëœ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤. ë”ë¸”í´ë¦­í•˜ë©´ ë³µì‚¬ë©ë‹ˆë‹¤."></textarea>
                    </div>
                </div>
                <div id="splitOutputContainer" style="display: none;"></div>
            `;
            
            // Reset telecom and agency selects after updating the output container
            telecomSelect.value = '';
            agencySelect.innerHTML = '<option value="">ëŒ€ë¦¬ì ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            agencySelect.disabled = true;
            
            // ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
            setupDoubleClickCopy();
            
            // ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤
            document.getElementById('inputText').focus();
            
            // If the current selection was ëŸ­ìŠ¤ or ë“œë¸”ë™, re-enable the agency select
            if (currentTelecom === 'SK' && (currentAgency === 'ëŸ­ìŠ¤' || currentAgency === 'ë“œë¸”ë™')) {
                updateAgencies();
                document.getElementById('agency').value = currentAgency;
            }
        }
        // ëŒ€ë¦¬ì  ì •ë³´ íŒì—… í•¨ìˆ˜
        function showAgencyInfo() {
            const telecomSelect = document.getElementById('telecom');
            const agencySelect = document.getElementById('agency');
            const selectedTelecom = telecomSelect.value;
            const selectedAgency = agencySelect.value;
            
            if (!selectedTelecom || !selectedAgency) {
                alert('í†µì‹ ì‚¬ì™€ ëŒ€ë¦¬ì ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const popup = document.getElementById('memoPopup');
            const popupTitle = document.getElementById('popupTitle');
            const popupContent = document.getElementById('memoContent');
            
            // íŒì—… ì œëª© ì„¤ì •
            popupTitle.textContent = `${selectedAgency} ì—…ë¬´ ë©”ëª¨`;
            
            // íŒì—… ë‚´ìš© ì„¤ì •
            if (agencyMemos[selectedTelecom] && agencyMemos[selectedTelecom][selectedAgency]) {
                popupContent.textContent = agencyMemos[selectedTelecom][selectedAgency];
            } else {
                popupContent.textContent = 'í•´ë‹¹ ëŒ€ë¦¬ì ì— ëŒ€í•œ ì—…ë¬´ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.';
            }
            
            // íŒì—… í‘œì‹œ
            popup.style.display = 'flex';
        }
        
        // ëŒ€ë¦¬ì  ì •ë³´ íŒì—… ë‹«ê¸° í•¨ìˆ˜
        function closeAgencyInfo() {
            const popup = document.getElementById('memoPopup');
            popup.style.display = 'none';
        }
        
        // ê°€ì…ìœ í˜•, í• ì¸ìœ í˜•, í˜„ì¬í†µì‹ ì‚¬ íŒŒì‹± í•¨ìˆ˜
        function parseSubscriptionAndDiscountInfo(customerInfo) {
            let subscriptionType = customerInfo['ê°€ì…ìœ í˜•'] || '';
            let discountType = customerInfo['í• ì¸ìœ í˜•'] || '';
            let currentTelecom = customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || '';
            let originalTelecomText = currentTelecom; // Store original for reference
            let discountMonths = '';
            let foundSubscription = false;
            let foundDiscountInSubscription = false;
            let isNormalCase = false; // Flag to check if this is a normal case (no need for special handling)

            // Define patterns for subscription types
            const subscriptionPatterns = {
                'ë²ˆí˜¸ì´ë™': /(ë²ˆí˜¸\s*ì´ë™|ë²ˆ\s*ì´|ë²ˆí˜¸\s*ë³€ê²½|ë²ˆí˜¸\s*ì´ì „)/,
                'ê¸°ê¸°ë³€ê²½': /(ê¸°ê¸°\s*ë³€ê²½|ê¸°ë³€|ê¸°ê¸°\s*êµì²´)/,
                'ì‹ ê·œê°€ì…': /(ì‹ ê·œ|ì‹ ê·œ\s*ê°€ì…|ì‹ \s*ê°€)/,
                'ë³´ìƒê¸°ë³€': /(ë³´ìƒê¸°ë³€|ë³´ìƒ\s*ê¸°ë³€|ë³´ìƒ\s*ê¸°ê¸°\s*ë³€ê²½)/
            };

            // Define patterns for discount types
            const discountPatterns = {
                'ê³µì‹œì§€ì›': /(ê³µì‹œ\s*ì§€ì›|ê³µì‹œ)/,
                'ì„ íƒì•½ì •': /(ì„ íƒ\s*ì•½ì •|ì„ ì•½)/,
                'ì„ ì•½': /(ì„ ì•½|ì„ \s*ì•½)/
            };
            
            // Major telecom providers only (SK, KT, LG)
            const majorTelecomProviders = {
                'SK': /^(SK|ì—ìŠ¤ì¼€ì´|SKT|SKí…”ë ˆì½¤|ì—ìŠ¤ì¼€ì´í…”ë ˆì½¤)$/i,
                'KT': /^(KT|ì¼€ì´í‹°|KTì˜¬ë ˆ|ì¼€ì´í‹°í…”ë ˆì½¤)$/i,
                'LG': /^(LG|ì—˜ì§€|LG U\+|ì—˜ì§€ìœ í”ŒëŸ¬ìŠ¤|LGìœ í”ŒëŸ¬ìŠ¤)$/i
            };

            // 1. First, check if discountType is empty and subscriptionType contains discount info
            if (!discountType && subscriptionType) {
                // Check for discount type patterns in subscriptionType
                for (const [type, pattern] of Object.entries(discountPatterns)) {
                    if (pattern.test(subscriptionType)) {
                        // Extract months if available (e.g., '24ê°œì›”' or '24')
                        const monthMatch = subscriptionType.match(/(\d+)\s*ê°œ?ì›”?/);
                        if (monthMatch) {
                            discountMonths = monthMatch[1] + 'ê°œì›”';
                            // Remove the months from subscriptionType
                            subscriptionType = subscriptionType.replace(monthMatch[0], '').trim();
                        }
                        // Set the discount type
                        discountType = type;
                        // Remove the discount type from subscriptionType
                        subscriptionType = subscriptionType.replace(pattern, '').trim();
                        foundDiscountInSubscription = true;
                        break;
                    }
                }
                
                // Special case: 'ê³µì‹œ' is treated as 'ê³µì‹œì§€ì›'
                if (discountType === 'ê³µì‹œ') {
                    discountType = 'ê³µì‹œì§€ì›';
                }
            }
            // If discountType is provided, process it normally
            else if (discountType) {
                // Check for discount type patterns and extract months
                for (const [type, pattern] of Object.entries(discountPatterns)) {
                    if (pattern.test(discountType)) {
                        // Extract months if available (e.g., '24ê°œì›”' or '24')
                        const monthMatch = discountType.match(/(\d+)\s*ê°œ?ì›”?/);
                        if (monthMatch) {
                            discountMonths = monthMatch[1] + 'ê°œì›”';
                            // Remove the months from discountType
                            discountType = discountType.replace(monthMatch[0], '').trim();
                        }
                        // Normalize the discount type
                        discountType = type;
                        break;
                    }
                }
                
                // Special case: 'ê³µì‹œ' is treated as 'ê³µì‹œì§€ì›'
                if (discountType === 'ê³µì‹œ') {
                    discountType = 'ê³µì‹œì§€ì›';
                }
                
                // For ê³µì‹œì§€ì›, set default 24 months if not specified
                if (discountType === 'ê³µì‹œì§€ì›' && !discountMonths) {
                    discountMonths = '24ê°œì›”';
                }
            }
            
            if (currentTelecom) {
                const telecomText = currentTelecom.trim();
                
                // Check for subscription type patterns in currentTelecom
                for (const [type, pattern] of Object.entries(subscriptionPatterns)) {
                    if (pattern.test(telecomText)) {
                        // If we find a subscription type in currentTelecom, use it
                        subscriptionType = type;
                        foundSubscription = true;
                        // Remove the subscription type from currentTelecom
                        currentTelecom = telecomText.replace(pattern, '').trim();
                        break;
                    }
                }
                
                // Clean up currentTelecom (remove any remaining dashes, spaces, etc.)
                currentTelecom = currentTelecom.replace(/^[\s\-]+|[\s\-]+$/g, '').trim();
                
                // If currentTelecom is empty after removing subscription type, set it to empty
                if (!currentTelecom) {
                    currentTelecom = '';
                }
            }

            // 2. Now check if subscriptionType contains discount info
            if (subscriptionType) {
                // First, check for discount type with months (e.g., "ê³µì‹œì§€ì› 24ê°œì›”")
                const discountWithMonths = subscriptionType.match(/(ê³µì‹œ\s*ì§€ì›|ê³µì‹œ|ì„ íƒ\s*ì•½ì •|ì„ ì•½)\s*(\d+)\s*ê°œ?ì›”?/i);
                if (discountWithMonths) {
                    const [fullMatch, discount, months] = discountWithMonths;
                    discountType = discount.includes('ê³µì‹œ') ? 'ê³µì‹œì§€ì›' : 
                                  discount.includes('ì„ ì•½') ? 'ì„ íƒì•½ì •' : discount;
                    discountMonths = months + 'ê°œì›”';
                    foundDiscountInSubscription = true;
                    subscriptionType = subscriptionType.replace(fullMatch, '').trim();
                } 
                // If no months pattern, just check for discount type
                else {
                    for (const [type, pattern] of Object.entries(discountPatterns)) {
                        if (pattern.test(subscriptionType)) {
                            discountType = type;
                            foundDiscountInSubscription = true;
                            // Remove discount info from subscriptionType
                            subscriptionType = subscriptionType.replace(pattern, '').trim();
                            break;
                        }
                    }
                }
            }


            // 4. Extract telecom provider from subscriptionType if currentTelecom is empty
            if ((!currentTelecom || currentTelecom.trim() === '') && subscriptionType) {
                const subscriptionKeywords = ['ë²ˆí˜¸ì´ë™', 'ë²ˆì´', 'ì‹ ê·œê°€ì…', 'ì‹ ê·œ', 'ë³´ìƒê¸°ë³€', 'ê¸°ê¸°ë³€ê²½', 'ê¸°ë³€'];
                const subscriptionPattern = new RegExp(`(${subscriptionKeywords.join('|')})[\s\-]*(.*)`, 'i');
                const match = subscriptionType.match(subscriptionPattern);
                
                if (match && match[1] && match[2]) {
                    // Found a subscription type and telecom provider in subscriptionType
                    const subType = match[1].trim();
                    const telecom = match[2].trim();
                    
                    // Map shortened forms to full forms
                    const subscriptionMap = {
                        'ë²ˆì´': 'ë²ˆí˜¸ì´ë™',
                        'ì‹ ê·œ': 'ì‹ ê·œê°€ì…',
                        'ê¸°ë³€': 'ê¸°ê¸°ë³€ê²½',
                        'ë³´ìƒê¸°ë³€': 'ê¸°ê¸°ë³€ê²½'
                    };
                    
                    // Set subscription type (convert to full form if needed)
                    subscriptionType = subscriptionMap[subType] || subType;
                    
                    // Set currentTelecom to the remaining text
                    currentTelecom = telecom;
                    foundSubscription = true;
                }
            }
            
            // 5. Final cleanup and validation
            if (!isNormalCase) {
                // Clean up subscription type
                if (subscriptionType) {
                    subscriptionType = subscriptionType
                        .replace(/[\s\-]+/g, ' ')
                        .trim();
                    
                    // If subscriptionType is not a valid type, try to extract it from currentTelecom
                    if (!/(ê¸°ê¸°ë³€ê²½|ë²ˆí˜¸ì´ë™|ì‹ ê·œê°€ì…|ê¸°ë³€|ë²ˆì´|ì‹ ê·œ|ë³´ìƒê¸°ë³€)/.test(subscriptionType) && currentTelecom) {
                        const telecomText = currentTelecom.trim();
                        if (telecomText.includes('ê¸°ê¸°ë³€ê²½') || telecomText.includes('ê¸°ë³€') || telecomText.includes('ë³´ìƒê¸°ë³€')) {
                            subscriptionType = 'ê¸°ê¸°ë³€ê²½';
                            currentTelecom = telecomText
                                .replace(/(ê¸°ê¸°ë³€ê²½|ê¸°ë³€|ë³´ìƒê¸°ë³€)/g, '')
                                .trim()
                                .replace(/^[\s\-]+|[\s\-]+$/g, '');
                        } else if (telecomText.includes('ë²ˆí˜¸ì´ë™') || telecomText.includes('ë²ˆì´')) {
                            subscriptionType = 'ë²ˆí˜¸ì´ë™';
                            currentTelecom = telecomText
                                .replace(/(ë²ˆí˜¸ì´ë™|ë²ˆì´)/g, '')
                                .trim()
                                .replace(/^[\s\-]+|[\s\-]+$/g, '');
                        } else if (telecomText.includes('ì‹ ê·œê°€ì…') || telecomText.includes('ì‹ ê·œ')) {
                            subscriptionType = 'ì‹ ê·œê°€ì…';
                            currentTelecom = telecomText
                                .replace(/(ì‹ ê·œê°€ì…|ì‹ ê·œ)/g, '')
                                .trim()
                                .replace(/^[\s\-]+|[\s\-]+$/g, '');
                        }
                    }
                }
                
                // If we still don't have a subscription type, try to determine from the text
                if (!subscriptionType || subscriptionType === '') {
                    const allText = [currentTelecom, subscriptionType, discountType].join(' ');
                    if (allText.includes('ê¸°ë³€') || allText.includes('ê¸°ê¸°ë³€ê²½')) {
                        subscriptionType = 'ê¸°ê¸°ë³€ê²½';
                    } else if (allText.includes('ë²ˆì´') || allText.includes('ë²ˆí˜¸ì´ë™')) {
                        subscriptionType = 'ë²ˆí˜¸ì´ë™';
                    } else if (allText.includes('ì‹ ê·œ')) {
                        subscriptionType = 'ì‹ ê·œê°€ì…';
                    }
                }
            }

            // 5. Set contract type and months for specific discount types
            let contractType = '';
            if (discountType === 'ê³µì‹œì§€ì›') {
                contractType = 'ê³µì‹œì§€ì›';
                if (!discountMonths) {
                    discountMonths = '24ê°œì›”'; // Default for ê³µì‹œì§€ì›
                }
            } else if (discountType === 'ì„ íƒì•½ì •' || discountType === 'ì„ ì•½') {
                contractType = 'ì„ íƒì•½ì •';
            }

            // 6. Clean up currentTelecom - remove any remaining subscription or discount type indicators
            for (const pattern of Object.values(subscriptionPatterns).concat(Object.values(discountPatterns))) {
                currentTelecom = currentTelecom.replace(pattern, '').trim();
            }
            
            // Remove any numbers followed by 'ê°œì›”' or 'ê°œ' from currentTelecom
            currentTelecom = currentTelecom.replace(/\d+\s*ê°œ?ì›”?/g, '').trim();

            return {
                subscriptionType: subscriptionType,
                discountType: discountType,
                currentTelecom: currentTelecom,
                discountMonths: discountMonths,
                contractType: contractType,
                original: {
                    subscriptionType: customerInfo['ê°€ì…ìœ í˜•'] || '',
                    discountType: customerInfo['í• ì¸ìœ í˜•'] || '',
                    currentTelecom: customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || ''
                }
            };
        }

        // ESC í‚¤ë¡œ íŒì—… ë‹«ê¸°
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeAgencyInfo();
                closeHistoryPopup();
            }
        });
        
        // íŒì—… ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('memoPopup').addEventListener('click', function(event) {
            if (event.target === this) {
                closeAgencyInfo();
            }
        });
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        // ìœ ìš©í•œ URL ì‚¬ì´íŠ¸ ëª©ë¡
        const usefulSites = [
            { name: 'SK ì—…ë¬´ê´€ë ¨', sites: [
                { name: 'SK í‹°ê²Œì´íŠ¸', url: 'https://tgate.sktelecom.com/' },
                { name: 'SK í‹°ê²Œì´íŠ¸ ì¡°íšŒ', url: 'https://tgateplus.sktelecom.com/scrb/frontList.do' },
                { name: 'GTS', url: 'https://gts.bizmax.net/' },
                { name: 'ë°€ë¦¬ì–¸ ì ‘ìˆ˜ ì‚¬ì´íŠ¸', url: 'http://www.inbangpan.co.kr' },
                { name: 'SK ì‚¼ë³´/íë¸Œ ì¬ê³ í‘œ(SK3 íƒ­ í™•ì¸)', url: 'https://docs.google.com/spreadsheets/d/1BlrYaOOqMFEb-TLVnvI6KXCjMJvUWT7UipUAUgvqI5g/edit?gid=634535474#gid=634535474' },
                { name: 'ëŸ­ìŠ¤ ì¬ê³ í‘œ í™•ì¸', url: 'https://docs.google.com/spreadsheets/d/1kYLutrHNPLBbjA9YNcGDVmi0kys0nK2QBPNccyu1Skc/edit#gid=2040945696'},
                { name: 'ë¹„ì•¤ì»´ ë°°ì†¡ìš”ì²­ êµ¬ê¸€ì‹œíŠ¸', url: 'https://docs.google.com/spreadsheets/d/1KjUUeRSXYM_isXf6daxfSyhO9yFJUryoHHLxhOfxhoQ/edit?gid=1068685658#gid=1068685658'},
                { name: 'SK ì‚¼ë³´/íë¸Œì¸ì¦ë²ˆí˜¸í™•ì¸ì‚¬ì´íŠ¸', url: 'http://partner.tgateapp.com/'}
            ]},
            { name: 'íœ´ëŒ€í° ìš”ê¸ˆê´€ë ¨ ì •ë³´', sites: [
                { name: 'ë ˆì¸ë³´ìš°ì»¨ì„¤íŒ…', url: 'https://goodmorningrainbow.com/renew/index.php' },
                { name: 'ìŠ¤ë§ˆíŠ¸ì´ˆì´ìŠ¤', url: 'https://www.smartchoice.or.kr/smc/index.do' }
            ]},
            { name: 'ì˜¬ë°”ë¥¸ ì£¼ì†Œ í™•ì¸', sites: [
                { name: 'ì£¼ì†Œì •ë³´ëˆ„ë¦¬ì§‘', url: 'https://www.juso.go.kr/openIndexPage.do' }
            ]},
            { name: 'ì—…ë¬´ì—ìœ ìš©í•œì‚¬ì´íŠ¸ë“¤', sites: [
                { name: 'ì‚¬ì§„-ì—‘ì…€ë³€í™˜', url: 'https://www.cardscanner.co/ko/png-to-excel' }
            ]}
        ];
        
        // ì„ íƒí•œ URL ì—´ê¸° í•¨ìˆ˜
        function openSelectedUrl() {
            const selectBox = document.getElementById('usefulUrls');
            const selectedValue = selectBox.value;
            
            if (selectedValue) {
                window.open(selectedValue, '_blank');
                // ì„ íƒë°•ìŠ¤ ì´ˆê¸°í™”
                selectBox.selectedIndex = 0;
            }
        }
        
        // ëª¨ë¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
        const MODEL_STORAGE_KEY = 'deviceModelDatabase_v1'; // ë³€ê²½ì´ë ¥ê´€ë¦¬ì™€ êµ¬ë¶„ë˜ëŠ” ê³ ìœ  í‚¤
        let deviceModelDatabase = {};
        
        // ê¸°ë³¸ ëª¨ë¸ ë°ì´í„° (ì´ˆê¸°ê°’ìœ¼ë¡œ ì‚¬ìš©)
        const defaultDeviceModels = {
            // ì‚¼ì„±
            "SM-S921N": { name: "ê°¤ëŸ­ì‹œS24", brand: "ì‚¼ì„±" },
            "SM-S926N": { name: "ê°¤ëŸ­ì‹œS24+", brand: "ì‚¼ì„±" },
            "SM-S928N": { name: "ê°¤ëŸ­ì‹œS24 Ultra", brand: "ì‚¼ì„±" },
            "SM-F946N": { name: "ê°¤ëŸ­ì‹œZí´ë“œ5", brand: "ì‚¼ì„±" },
            "SM-F731N": { name: "ê°¤ëŸ­ì‹œZí”Œë¦½5", brand: "ì‚¼ì„±" },
            "SM-S911N": { name: "ê°¤ëŸ­ì‹œS23", brand: "ì‚¼ì„±" },
            "SM-S916N": { name: "ê°¤ëŸ­ì‹œS23+", brand: "ì‚¼ì„±" },
            "SM-S918N": { name: "ê°¤ëŸ­ì‹œS23 Ultra", brand: "ì‚¼ì„±" },
            "SM-S931N": { name: "ê°¤ëŸ­ì‹œS25", brand: "ì‚¼ì„±"},
            "SM-S936N": { name: "ê°¤ëŸ­ì‹œS25+", brand: "ì‚¼ì„±"},
            "SM-S938N": { name: "ê°¤ëŸ­ì‹œS25 Ultra", brand: "ì‚¼ì„±"},
            
            // ì• í”Œ
            "A2892": { name: "ì•„ì´í°15", brand: "ì• í”Œ" },
            "A2846": { name: "ì•„ì´í°15 Pro", brand: "ì• í”Œ" },
            "A2890": { name: "ì•„ì´í°15 Pro Max", brand: "ì• í”Œ" },
            "A2882": { name: "ì•„ì´í°14", brand: "ì• í”Œ" },
            "A2893": { name: "ì•„ì´í°14 Pro", brand: "ì• í”Œ" },
            "A2895": { name: "ì•„ì´í°14 Pro Max", brand: "ì• í”Œ" }
        };
        
        // localStorageì—ì„œ ëª¨ë¸ ë°ì´í„° ë¡œë“œ
        function loadModelsFromStorage() {
            try {
                const savedData = localStorage.getItem(MODEL_STORAGE_KEY);
                if (savedData) {
                    return JSON.parse(savedData);
                }
            } catch (e) {
                console.error('ëª¨ë¸ ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
            }
            return null;
        }
        
        // ëª¨ë¸ ë°ì´í„°ë¥¼ localStorageì— ì €ì¥
        function saveModelsToStorage() {
            try {
                localStorage.setItem(MODEL_STORAGE_KEY, JSON.stringify(deviceModelDatabase));
                return true;
            } catch (e) {
                console.error('ëª¨ë¸ ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
                return false;
            }
        }
        
        // ê¸°ë³¸ ëª¨ë¸ë¡œ ì´ˆê¸°í™”í•˜ëŠ” í•¨ìˆ˜
        function resetToDefaultModels() {
            deviceModelDatabase = JSON.parse(JSON.stringify(defaultDeviceModels));
            saveModelsToStorage();
            console.log('ëª¨ë¸ ë°ì´í„°ê°€ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            return true;
        }

        // ëª¨ë¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” (ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©)
        function initializeModelDatabase() {
            const savedModels = loadModelsFromStorage();
            if (savedModels && Object.keys(savedModels).length > 0) {
                deviceModelDatabase = savedModels;
                console.log('ì €ì¥ëœ ëª¨ë¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.');
            } else {
                resetToDefaultModels();
                console.log('ê¸°ë³¸ ëª¨ë¸ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.');
            }
        }

        // ëª¨ë¸ ê²€ìƒ‰ í•¨ìˆ˜
        function searchDeviceModel(query) {
            if (!query) return [];
            
            query = query.toLowerCase().trim();
            const results = [];
            
            // ëª¨ë¸ëª…, ëª¨ë¸ë²ˆí˜¸, ë¸Œëœë“œëª…ìœ¼ë¡œ ê²€ìƒ‰
            for (const [modelNumber, model] of Object.entries(deviceModelDatabase)) {
                if (modelNumber.toLowerCase().includes(query) || 
                    model.name.toLowerCase().includes(query) ||
                    model.brand.toLowerCase().includes(query)) {
                    results.push({ modelNumber, ...model });
                }
            }
            
            return results;
        }

        // ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜
        function displayDeviceSearchResults(results) {
            const resultsContainer = document.getElementById('modelSearchResults');
            resultsContainer.innerHTML = '';
            
            if (results.length === 0) {
                resultsContainer.innerHTML = '<div style="padding: 10px; color: #888;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                resultsContainer.style.display = 'block';
                return;
            }
            
            results.forEach(model => {
                const item = document.createElement('div');
                item.className = 'model-result';
                item.style.padding = '10px';
                item.style.borderBottom = '1px solid #eee';
                item.style.cursor = 'pointer';
                item.innerHTML = `
                    <div style="font-weight: bold;">${model.name}</div>
                    <div style="font-size: 0.9em; color: #666;">
                        <span>${model.brand}</span> Â· 
                        <span>${model.modelNumber}</span>
                    </div>
                `;
                
                // í´ë¦­ ì´ë²¤íŠ¸ - ì„ íƒí•œ ëª¨ë¸ì˜ ë²ˆí˜¸ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬
                item.addEventListener('click', (event) => {
                    // ê¸°ë³¸ ë™ì‘ ë°©ì§€ (ë§í¬ ì´ë™ ë“± ë°©ì§€)
                    event.preventDefault();
                    
                    // ëª¨ë¸ ë²ˆí˜¸ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬
                    navigator.clipboard.writeText(model.modelNumber).then(() => {
                        // ê²€ìƒ‰ì°½ì—ëŠ” ëª¨ë¸ëª…ì„ ìœ ì§€
                        document.getElementById('modelSearch').value = model.name;
                        resultsContainer.style.display = 'none';
                        
                        // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ (ëª¨ë¸ëª…ê³¼ í•¨ê»˜ ëª¨ë¸ ë²ˆí˜¸ë„ í‘œì‹œ)
                        showToast(`ëª¨ë¸ ë²ˆí˜¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤: ${model.modelNumber} (${model.name})`);
                    }).catch(err => {
                        console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                        showToast('ëª¨ë¸ ë²ˆí˜¸ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    });
                });
                
                resultsContainer.appendChild(item);
            });
            
            resultsContainer.style.display = 'block';
        }

        // ëª¨ë¸ ë°ì´í„° ê´€ë¦¬ í•¨ìˆ˜ (ì½˜ì†”ì—ì„œ ì‚¬ìš©)
        const modelManagement = {
            // ëª¨ë¸ ì¶”ê°€/ìˆ˜ì •
            add: function(modelNumber, name, brand) {
                if (!modelNumber || !name) {
                    console.error('ëª¨ë¸ ë²ˆí˜¸ì™€ ì´ë¦„ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.');
                    return false;
                }
                
                deviceModelDatabase[modelNumber] = {
                    name: name,
                    brand: brand || 'ê¸°íƒ€'
                };
                
                // ë³€ê²½ì‚¬í•­ ì €ì¥
                saveModelsToStorage();
                console.log(`ëª¨ë¸ì´ ì¶”ê°€/ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤: ${modelNumber} - ${name}`);
                return true;
            },
            
            // ëª¨ë¸ ì‚­ì œ
            remove: function(modelNumber) {
                if (deviceModelDatabase[modelNumber]) {
                    const modelName = deviceModelDatabase[modelNumber].name;
                    delete deviceModelDatabase[modelNumber];
                    
                    // ë³€ê²½ì‚¬í•­ ì €ì¥
                    saveModelsToStorage();
                    console.log(`ëª¨ë¸ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤: ${modelNumber} - ${modelName}`);
                    return true;
                }
                console.error('í•´ë‹¹ ëª¨ë¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return false;
            },
            
            // ëª¨ë“  ëª¨ë¸ ëª©ë¡ ë³´ê¸°
            list: function() {
                console.log('=== ë“±ë¡ëœ ëª¨ë¸ ëª©ë¡ ===');
                for (const [modelNumber, model] of Object.entries(deviceModelDatabase)) {
                    console.log(`[${modelNumber}] ${model.brand} ${model.name}`);
                }
                console.log('======================');
                return deviceModelDatabase;
            },
            
            // ì €ì¥ì†Œ ì´ˆê¸°í™” (ê¸°ë³¸ ëª¨ë¸ë¡œ ì´ˆê¸°í™”)
            reset: function() {
                return this.resetToDefaults();
            },
            
            // ì €ì¥ì†Œ ë¹„ìš°ê¸° (ê¸°ë³¸ ëª¨ë¸ë¡œ ì´ˆê¸°í™”)
            clear: function() {
                return this.resetToDefaults();
            },
            
            // ê¸°ë³¸ ëª¨ë¸ë¡œ ì´ˆê¸°í™”
            resetToDefaults: function() {
                if (confirm('ëª¨ë“  ëª¨ë¸ ë°ì´í„°ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                    return resetToDefaultModels();
                }
                return false;
            },
            
            // ë³„ì¹­ ë„ì›€ë§
            help: function() {
                console.log('=== ëª¨ë¸ ê´€ë¦¬ ëª…ë ¹ì–´ ë„ì›€ë§ ===');
                console.log('ì¶”ê°€: model.add("ëª¨ë¸ë²ˆí˜¸", "ëª¨ë¸ì´ë¦„", "ì œì¡°ì‚¬") ë˜ëŠ” model.a(...)');
                console.log('ì‚­ì œ: model.remove("ëª¨ë¸ë²ˆí˜¸") ë˜ëŠ” model.r(...)');
                console.log('ëª©ë¡: model.list() ë˜ëŠ” model.l()');
                console.log('ì´ˆê¸°í™”: model.reset() ë˜ëŠ” model.rs() (ë¹ˆ ë°ì´í„°ë¡œ ì´ˆê¸°í™”)');
                console.log('ê¸°ë³¸ê°’ ë³µì›: model.resetToDefaults() (ê¸°ë³¸ ëª¨ë¸ë¡œ ì´ˆê¸°í™”)');
                console.log('ì „ì²´ì‚­ì œ: model.clear() ë˜ëŠ” model.c() (ëª¨ë“  ë°ì´í„° ì‚­ì œ)');
                console.log('ë„ì›€ë§: model.help()');
                console.log('======================================');
                return true;
            }
        };

        // ëª¨ë¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ì‹¤í–‰
        initializeModelDatabase();
        
        // window ê°ì²´ì— ë“±ë¡
        window.model = window.manageDeviceModels = modelManagement;
        
        // ë³„ì¹­ ë“±ë¡
        window.model.a = modelManagement.add;
        window.model.r = modelManagement.remove;
        window.model.l = modelManagement.list;
        window.model.rs = modelManagement.reset;
        window.model.c = modelManagement.clear;
        
        console.log('ëª¨ë¸ ê´€ë¦¬ ëª…ë ¹ì–´ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. model.help()ë¡œ ë„ì›€ë§ì„ í™•ì¸í•˜ì„¸ìš”.');
        
        document.addEventListener('DOMContentLoaded', function() {
            // ì´ˆê¸° í…ìŠ¤íŠ¸ì—ë¦¬ì–´ì— ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
            setupDoubleClickCopy();
            
            // ëª¨ë¸ ê²€ìƒ‰ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const searchInput = document.getElementById('modelSearch');
            const searchResults = document.getElementById('modelSearchResults');
            
            if (searchInput) {
                // ì…ë ¥ ì´ë²¤íŠ¸
                searchInput.addEventListener('input', (e) => {
                    const results = searchDeviceModel(e.target.value);
                    displayDeviceSearchResults(results);
                });
                
                // í¬ì»¤ìŠ¤ ì•„ì›ƒ ì‹œ ì•½ê°„ì˜ ì§€ì—° í›„ ê²°ê³¼ì°½ ìˆ¨ê¸°ê¸°
                searchInput.addEventListener('blur', () => {
                    setTimeout(() => {
                        searchResults.style.display = 'none';
                    }, 200);
                });
                
                // ì™¸ë¶€ í´ë¦­ ì‹œ ê²°ê³¼ì°½ ìˆ¨ê¸°ê¸°
                document.addEventListener('click', (e) => {
                    if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                        searchResults.style.display = 'none';
                    }
                });
            }
            
            // ì´ˆê¸°í™” ë©”ì‹œì§€ ì¶”ê°€
            const outputText = document.getElementById('outputText');
            if (outputText) {
                outputText.placeholder = 'ì—¬ê¸°ì— ë³€í™˜ëœ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤. ë”ë¸”í´ë¦­í•˜ë©´ ë³µì‚¬ë©ë‹ˆë‹¤.';
                // í´ë˜ìŠ¤ ì¶”ê°€
                outputText.classList.add('output-textarea');
            }
            
            // ì…ë ¥ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ì— í´ë˜ìŠ¤ ì¶”ê°€
            const inputText = document.getElementById('inputText');
            if (inputText) {
                inputText.classList.add('input-textarea');
            }
            
            // ìœ ìš©í•œ URL ëª©ë¡ ì´ˆê¸°í™”
            const usefulUrlsSelect = document.getElementById('usefulUrls');
            
            // ê·¸ë£¹ë³„ë¡œ ì‚¬ì´íŠ¸ ëª©ë¡ ì¶”ê°€
            usefulSites.forEach(group => {
                // ê·¸ë£¹ ì œëª© ì¶”ê°€
                const groupOption = document.createElement('optgroup');
                groupOption.label = group.name;
                
                // ê·¸ë£¹ ë‚´ ì‚¬ì´íŠ¸ ì¶”ê°€
                group.sites.forEach(site => {
                    const option = document.createElement('option');
                    option.value = site.url;
                    option.textContent = site.name;
                    groupOption.appendChild(option);
                });
                
                usefulUrlsSelect.appendChild(groupOption);
            });
        });

        function setupEventListeners() {
            document.getElementById('convertBtn').addEventListener('click', handleConvert);
            document.getElementById('copyBtn').addEventListener('click', handleCopy);
            document.getElementById('clearBtn').addEventListener('click', handleClear);
            
            // ì´ë²¤íŠ¸ ìœ„ì„ ì‚¬ìš©
            document.getElementById('outputContainer').addEventListener('dblclick', handleDoubleClick);
        }

        // ìƒˆë¡œìš´ í†µì‹ ì‚¬/ëŒ€ë¦¬ì  ì„¤ì • êµ¬ì¡°
        const TELECOM_CONFIG = {
            'SK': {
                name: 'SK',
                agencies: {
                    'ACT(íƒë°°)': {
                        name: 'ACT(íƒë°°)',
                        type: 'special',
                        outputType: 'split',
                        memo: agencyMemos['SK']['ACT(íƒë°°)'],
                        templates: {
                            stockRequest: (info) => {
                                return `ACT / ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''} / ${info.ê°€ì…ìœ í˜• || ''}
${info.ê³ ê°ëª… || ''} / ${info.ì „í™”ë²ˆí˜¸ || ''} / ${info.ìƒë…„ì›”ì¼ || info.ì£¼ë¯¼ë²ˆí˜¸ || ''}
ì ‘ìˆ˜ í™•ì¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.`;
                            },
                            openRequest: (info) => {
                                // ìµœì¢…í• ë¶€ì›ê¸ˆ/ê°œì›”ìˆ˜ ì²˜ë¦¬
                                let installmentInfo = '';
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                    installmentInfo = 'í˜„ê¸ˆì™„ë‚©';
                                } else if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                    installmentInfo = `${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}/${info.í• ë¶€ê°œì›”ìˆ˜ || '24'}ê°œì›”`;
                                } else {
                                    installmentInfo = info.ìµœì¢…êµ¬ë§¤ê°€ || '';
                                }
                                
                                return `ë„ë§¤c
1. ê³ ê°ëª… : ${info.ê³ ê°ëª… || info.ê°€ì…ìëª… || ''}
2. ì „í™”ë²ˆí˜¸ : ${info.ì „í™”ë²ˆí˜¸ || info.ê°œí†µë²ˆí˜¸ || ''}
3. ì£¼ë¯¼ë²ˆí˜¸ì „ì²´ : ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}
4. ë²•ëŒ€ëª… : ${info.ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„ || ''}
5. ë²•ëŒ€ì£¼ë¯¼ë²ˆí˜¸ì „ì²´ : ${info.ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸ || ''}
6. ë²•ëŒ€ì—°ë½ì²˜ : ${info.ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜ || ''}
7. ì „í†µì‹ ì‚¬ : ${info.í˜„ì¬í†µì‹ ì‚¬ || ''}
8. ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''}
9. ì¼ë ¨ë²ˆí˜¸ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
10. ìœ ì‹¬ë²ˆí˜¸(13ìë¦¬) : ${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || info.ìœ ì‹¬ || ''}
11. ìš”ê¸ˆì œ : ${info.ìš”ê¸ˆì œ || ''}
12. ê³µì‹œ/ì„ ì•½ : ${info.ê³µì‹œì„ ì•½ì—¬ë¶€ || info.í• ì¸ìœ í˜• || ''} ${info.ì•½ì •ê°œì›”ìˆ˜ || ''}
13. í˜„ê¸ˆ/í• ë¶€ : ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || ''}
14. ê³µì‹œì§€ì›ê¸ˆ : ${info.ê³µì‹œ || ''}
15. ì¶”ê°€ì§€ì›ê¸ˆ : ${info.ì¶”ì§€ || ''}
16. í”„ë¦¬í• ë¶€ : ${info.í”„ë¦¬í• ë¶€ || ''}
17. ìµœì¢…í• ë¶€ì›ê¸ˆ/ê°œì›”ìˆ˜ : ${installmentInfo}
18. ê¸°íƒ€íŠ¹ì´ì‚¬í•­ : ë„ë§¤C
19. íŒë§¤ì ëª… : ë„ë‹´`;
                            }
                        }
                    },
                    'ë“œë¸”ë™': {
                        name: 'ë“œë¸”ë™',
                        type: 'special',
                        outputType: 'multi',
                        memo: agencyMemos['SK']['ë“œë¸”ë™'],
                        templates: {
                            request: (info) => {
                                const subscriptionType = info.ê°€ì…ìœ í˜• || '';
                                const name = info.ê³ ê°ëª… || info.ê°€ì…ìëª… || '';
                                const contact = info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || '';
                                const isMinor = info.ë¯¸ì„±ë…„ìì—¬ë¶€ === 'Y';
                                
                                // ë¯¸ì„±ë…„ìì¸ ê²½ìš° íŠ¹ë³„ ì–‘ì‹ ì‚¬ìš©
                                if (isMinor) {
                                    const idInfo = info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || '';
                                    const legalGuardianName = info.ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„ || '';
                                    const legalGuardianContact = info.ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜ || '';
                                    
                                    return `â– ë¯¸ì„±ë…„ì ë²ˆí˜¸ì´ë™ & ê¸°ë³€ ì‹ ì¡°ìš”ì²­â– 
ï¼ƒê³ ê°ëª…	${name}
# ì—°ë½ì²˜	${contact}
ï¼ƒì£¼ë¯¼ë²ˆí˜¸	${idInfo}
# ë²•ëŒ€ ì„±í•¨ / ì£¼ë¯¼ë²ˆí˜¸	${legalGuardianName} / ${legalGuardianContact}`;
                                }
                                
                                // ë¯¸ì„±ë…„ìê°€ ì•„ë‹Œ ê²½ìš° ê¸°ì¡´ ë¡œì§ ì‚¬ìš©
                                const isDeviceChange = ['ê¸°ê¸°ë³€ê²½', 'ê¸°ë³€'].includes(subscriptionType);
                                const isNumberPortability = ['ë²ˆí˜¸ì´ë™', 'ë²ˆì´'].includes(subscriptionType);
                                
                                // ê°€ì…ìœ í˜•ì— ë”°ë¥¸ ì£¼ë¯¼ë²ˆí˜¸/ìƒë…„ì›”ì¼ ì„ íƒ
                                let idInfo = '';
                                let idLabel = '';
                                if (isDeviceChange) {
                                    // ê¸°ê¸°ë³€ê²½ì¸ ê²½ìš° ìƒë…„ì›”ì¼ ì‚¬ìš©
                                    idInfo = info.ìƒë…„ì›”ì¼ || info.ì£¼ë¯¼ë²ˆí˜¸ || '';
                                    idLabel = 'ìƒë…„ì›”ì¼';
                                } else if (isNumberPortability) {
                                    // ë²ˆí˜¸ì´ë™ì¸ ê²½ìš° ì£¼ë¯¼ë²ˆí˜¸ ì‚¬ìš©
                                    idInfo = info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || '';
                                    idLabel = 'ì£¼ë¯¼ë²ˆí˜¸';
                                } else {
                                    // ê¸°íƒ€ì˜ ê²½ìš° ì£¼ë¯¼ë²ˆí˜¸ ìš°ì„ 
                                    idInfo = info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || '';
                                    idLabel = 'ì£¼ë¯¼ë²ˆí˜¸';
                                }
                                
                                return `â– ${subscriptionType} ì‹ ì¡°ìš”ì²­â– 
ï¼ƒê³ ê°ëª…	${name}
ï¼ƒì—°ë½ì²˜	${contact}
ï¼ƒ${idLabel}	${idInfo}`;
                            },
                            stock: (info) => {
                                const modelColor = `${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''} / ${info.ìƒ‰ìƒ || ''} / ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}`;
                                const plan = info.ìš”ê¸ˆì œ || '';
                                const subscriptionType = info.ê°€ì…ìœ í˜• || '';
                                
                                if (info.ê³µì‹œì„ ì•½ì—¬ë¶€ === 'ê³µì‹œì§€ì›' && info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                    return `íŒë§¤ì ëª… : ì—ì´ì¹˜ì—˜
ê³ ê°ëª… : ${info.ê³ ê°ëª… || ''}	
ê°œí†µë²ˆí˜¸ : ${info.ì „í™”ë²ˆí˜¸ || ''}	
ëª¨ë¸ëª… / ìƒ‰ìƒ / ì¼ë ¨ë²ˆí˜¸ : ${modelColor}	
ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ :	${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}	
ìš”ê¸ˆì œëª…(í˜œíƒ) :	${plan}	
ê°œí†µìœ í˜• : ${subscriptionType}	
ê³µì‹œ ${info.ì•½ì •ê°œì›”ìˆ˜ || '24ê°œì›”'}		
í˜„ê¸ˆì™„ë‚©		
		
ì¶œê³ ê°€ ${info.ì¶œê³ ê°€ || ''}
ê³µì‹œì§€ì› ${info.ê³µì‹œ || ''}
ì¶”ê°€ì§€ì› ${info.ì¶”ì§€ || ''}${info.ì „í™˜ì§€ì›ê¸ˆ && info.ì „í™˜ì§€ì›ê¸ˆ !== '0' ? `
ì „í™˜ì§€ì›ê¸ˆ ${info.ì „í™˜ì§€ì›ê¸ˆ}` : ''}
ìµœì¢…êµ¬ë§¤ê°€ ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}
		
ë³´í—˜ / ë¶€ê°€ì„œë¹„ìŠ¤ : ${info.ë¶€ê°€ì„œë¹„ìŠ¤ || ''}`;
                                } else if (info.ê³µì‹œì„ ì•½ì—¬ë¶€ === 'ê³µì‹œì§€ì›' && info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                    return `íŒë§¤ì ëª… : ì—ì´ì¹˜ì—˜
ê³ ê°ëª… :	${info.ê³ ê°ëª… || ''}	
ê°œí†µë²ˆí˜¸ :	${info.ì „í™”ë²ˆí˜¸ || ''}	
ëª¨ë¸ëª… / ìƒ‰ìƒ / ì¼ë ¨ë²ˆí˜¸ :	${modelColor}	
ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ :	${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}	
ìš”ê¸ˆì œëª…(í˜œíƒ) : ${plan}	
ê°œí†µìœ í˜• : ${subscriptionType}	
ê³µì‹œ ${info.ì•½ì •ê°œì›”ìˆ˜ || '24ê°œì›”'}		
í• ë¶€ ${info.í• ë¶€ê°œì›”ìˆ˜ || '24ê°œì›”'}		
		
ì¶œê³ ê°€ ${info.ì¶œê³ ê°€ || ''}
ê³µì‹œì§€ì› ${info.ê³µì‹œ || ''}
ì¶”ê°€ì§€ì› ${info.ì¶”ì§€ || ''}${info.ì „í™˜ì§€ì›ê¸ˆ && info.ì „í™˜ì§€ì›ê¸ˆ !== '0' ? `
ì „í™˜ì§€ì›ê¸ˆ ${info.ì „í™˜ì§€ì›ê¸ˆ}` : ''}
í”„ë¦¬í• ë¶€ ${info.í”„ë¦¬í• ë¶€ || ''}
ìµœì¢…êµ¬ë§¤ê°€ ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}
		
ë³´í—˜ / ë¶€ê°€ì„œë¹„ìŠ¤ : ${info.ë¶€ê°€ì„œë¹„ìŠ¤ || ''}`;
                                }
                            },
                            memo: (info) => {
                                const subscriptionType = info.ê°€ì…ìœ í˜• || '';
                                const currentTelecom = info.í˜„ì¬í†µì‹ ì‚¬ || '';
                                const name = info.ê³ ê°ëª… || info.ê°€ì…ìëª… || '';
                                const birthDate = info.ìƒë…„ì›”ì¼ || info.ì£¼ë¯¼ë²ˆí˜¸ || '';
                                const phone = info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || '';
                                const model = info.ëª¨ë¸ëª… || '' + info.ìš©ëŸ‰ || '';
                                const color = info.ìƒ‰ìƒ || '';
                                const serialNumber = info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || '';
                                // ìœ ì‹¬ ì •ë³´ ì²˜ë¦¬ (ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ ìš°ì„ , ì—†ìœ¼ë©´ ìœ ì‹¬ ê°’ ì‚¬ìš©)
                                const usim = info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || info.ìœ ì‹¬ || '';
                                const plan = info.ìš”ê¸ˆì œ || '';
                                
                                // ì•½ì • ì •ë³´ ì²˜ë¦¬ (í• ì¸ìœ í˜• / ì•½ì •ê°œì›”ìˆ˜)
                                const discountType = info.í• ì¸ìœ í˜• || '';
                                const contractMonths = info.ì•½ì •ê°œì›”ìˆ˜ || '';
                                const contractInfo = discountType && contractMonths ? `${discountType}${contractMonths}` : (discountType || contractMonths);
                                
                                // í• ë¶€ ê°œì›” & í˜„ê¸ˆì™„ë‚© ì²˜ë¦¬
                                let installmentInfo = '';
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                    installmentInfo = 'í˜„ê¸ˆì™„ë‚©';
                                } else if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                    installmentInfo = `${info.í• ë¶€ê°œì›”ìˆ˜ || '24'}ê°œì›”`;
                                }
                                
                                // í• ë¶€ì›ê¸ˆ ì²˜ë¦¬ (ê¸°ì¬ ì•ˆí• ì‹œ í˜„ê¸ˆì™„ë‚©)
                                let installmentPrincipal = '';
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                    installmentPrincipal = info.ìµœì¢…êµ¬ë§¤ê°€ || '';
                                } else {
                                    installmentPrincipal = 'í˜„ê¸ˆì™„ë‚©';
                                }
                                
                                // ì „í™˜ì§€ì›ê¸ˆ (MNPë§Œ ì ìš©)
                                let transferSupport = '';
                                if (['ë²ˆí˜¸ì´ë™', 'ë²ˆì´'].includes(subscriptionType)) {
                                    transferSupport = info.ì „í™˜ì§€ì›ê¸ˆ || '';
                                }
                                
                                // ë³´í—˜/ë¶€ê°€/ë³µì§€ ì •ë³´ í†µí•©
                                const insurance = info.ë³´í—˜ || '';
                                const addon = info.ë¶€ê°€ì„œë¹„ìŠ¤ || '';
                                const welfare = info.ë³µì§€ || '';
                                let benefitInfo = [insurance, addon, welfare].filter(item => item).join(' / ');
                                
                                return `â–¶ê°€ì…ìœ í˜• / ì „í†µì‹ ì‚¬ : ${subscriptionType} / ${currentTelecom}
â–¶ê³ ê°ëª… : ${name}
â–¶ìƒë…„ì›”ì¼ : ${birthDate}
â–¶ê°œí†µë²ˆí˜¸ : ${phone}
â–¶ëª¨ë¸ëª… / ìƒ‰ìƒ : ${model} / ${color}
â–¶ì¼ë ¨ë²ˆí˜¸ : ${serialNumber}
â–¶ìœ ì‹¬ (í›„ì²­êµ¬ì—¬ë¶€ / ê¸°ì¬ ì—†ì„ì‹œ í›„ë‚©) : ${usim}
â–¶ìš”ê¸ˆì œ / ìš”ê¸ˆì œí˜œíƒ : ${plan}
â–¶ì•½ì • (ê³µì‹œ or ì„ ì•½12 or ì„ ì•½24) : ${contractInfo}
â–¶í• ë¶€ ê°œì›” & í˜„ê¸ˆì™„ë‚© : ${installmentInfo}
â–¶ì¶œê³ ê°€ : ${info.ì¶œê³ ê°€ || ''}
â–¶ê³µì‹œ ì§€ì›ê¸ˆ : ${info.ê³µì‹œ || ''}
â–¶ì¶”ê°€ ì§€ì›ê¸ˆ : ${info.ì¶”ì§€ || ''}
â–¶í”„ë¦¬ ê¸ˆì•¡ : ${info.í”„ë¦¬í• ë¶€ || ''}
â–¶ì „í™˜ ì§€ì›ê¸ˆ (MNPë§Œ ì ìš©) : ${transferSupport}
â–¶í• ë¶€ì›ê¸ˆ (ê¸°ì¬ ì•ˆí• ì‹œ í˜„ê¸ˆì™„ë‚©) : ${installmentPrincipal}
â–¶*ë³´í—˜ / *ë¶€ê°€ / *ë³µì§€ : ${benefitInfo}
â–¶í´ëŸ½ê¸°ë³€ ì§„í–‰ ì—¬ë¶€ : X
â–¶íŒë§¤ì²˜ / ì—°ë½ì²˜ : ë¼ì˜¨ì•„ì´/010-4671-4834`;
                            }
                        }
                    },
                    'íë¸Œ': {
                        name: 'íë¸Œ',
                        type: 'special',
                        outputType: 'split',
                        memo: agencyMemos['SK']['íë¸Œ'],
                        templates: {
                            stockRequest: (info) => {
                                // ìœ ì‹¬ ê°’ì— 'ì´ì‹¬' ë˜ëŠ” 'ê¸°ì¡´ìœ ì‹¬' í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ X, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ O
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasESim = /ì´ì‹¬|ê¸°ì¡´ìœ ì‹¬/i.test(usimValue);
                                const usimRequest = hasESim ? 'X' : 'O';
                                
                                return `â˜…ì¬ê³ ìš”ì²­(SK3)
íƒë°°orí€µ :	
ì´ë¦„: ${info.ê³ ê°ëª… || ''}
ì—°ë½ì²˜ : ${info.ì „í™”ë²ˆí˜¸ || ''}
ì£¼ì†Œ : ${info.íƒë°°ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || ''}
ìœ ì‹¬ : ${usimRequest}
ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''}
ìƒ‰ìƒ : ${info.ìƒ‰ìƒ || ''}`;
                            },
                            openRequest: (info) => {
                                const telecom = info.í˜„ì¬í†µì‹ ì‚¬ || '';
                                let paymentInfo = '';
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                    paymentInfo = 'â˜…í˜„ê¸ˆì™„ë‚©(' + info.ìµœì¢…êµ¬ë§¤ê°€ + ')';
                                } else {
                                    paymentInfo = `${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || ''} ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}ì›`;
                                }
                                
                                return `â– SK3 ê°œí†µìš”ì²­		
â— ê³ ê°ëª… / ë²ˆí˜¸ : ${info.ê³ ê°ëª… || ''} / ${info.ì „í™”ë²ˆí˜¸ || ''}	
â— ì£¼ë¯¼ë²ˆí˜¸ : ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}	
â— í†µì‹ ì‚¬/ì¸ì¦ : ${telecom}	
â— ëª¨ë¸/ìƒ‰ìƒ : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''} / ${info.ìƒ‰ìƒ || ''}	
â— ì¼ë ¨ë²ˆí˜¸ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}	
â— ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ : ${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}	
â— ìœ ì‹¬ë¹„ìš©:	${info.ìœ ì‹¬ || ''}	
â— ìš”ê¸ˆì œ / í˜œíƒ : ${info.ìš”ê¸ˆì œ || ''}	
â— ê³µì‹œì§€ì›ê¸ˆ : ${info.ê³µì‹œ || '0'}	
â— ì¶”ê°€ì§€ì›ê¸ˆ : ${info.ì¶”ì§€ || '0'}	
â— í• ë¶€ì›ê¸ˆ : ${paymentInfo}
â— ì•½ì •ìœ í˜• : ${info.í• ì¸ìœ í˜• || ''} ${info.ì•½ì •ê°œì›”ìˆ˜ || ''}
â— ë¶€ê°€ì„œë¹„ìŠ¤ : ${info.ë¶€ê°€ì„œë¹„ìŠ¤ && info.ë³´í—˜ ? `${info.ë¶€ê°€ì„œë¹„ìŠ¤} / ${info.ë³´í—˜}` : (info.ë¶€ê°€ì„œë¹„ìŠ¤ || info.ë³´í—˜ || '')}`;
                            }
                        }
                    },
                    'ë‚˜í…”': {
                        name: 'ë‚˜í…”',
                        type: 'special',
                        outputType: 'split',
                        memo: agencyMemos['SK']['ë‚˜í…”'],
                        templates: {
                            stockRequest: (info) => {
                                // ê¸°ë³¸ ì •ë³´ ì²˜ë¦¬
                                const naName = info['ê°€ì…ìëª…'] || info['ê³ ê°ëª…'] || '';
                                const naContact = info['ê°œí†µë²ˆí˜¸'] || info['ì „í™”ë²ˆí˜¸'] || '';
                                const naAddress = info['íƒë°°ì£¼ì†Œ'] || info['ë°°ì†¡ì£¼ì†Œì§€'] || '';
                                const naModel = info['ëª¨ë¸ëª…'] || '';
                                const naColor = info['ìƒ‰ìƒ'] || '';
                                
                                // ìœ ì‹¬ ê°’ì— 'ì´ì‹¬' ë˜ëŠ” 'ê¸°ì¡´ìœ ì‹¬' í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ X, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ O
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasESim = /ì´ì‹¬|ê¸°ì¡´ìœ ì‹¬/i.test(usimValue);
                                const usimRequest = hasESim ? 'X' : 'O';
                                
                                // ë°°ì†¡ìš”ì²­ ì–‘ì‹ (ì²« ë²ˆì§¸ textarea)
                                return `íƒë°°ìš”ì²­	
	
ì£¼ì†Œ : ${naAddress}
ìˆ˜ì·¨ì¸ : ${naName}
ì—°ë½ì²˜ : ${naContact}
ê¸°ì¢…/ìƒ‰ìƒ: ${naModel} ${info.ìš©ëŸ‰ || ''} / ${naColor}
ìœ ì‹¬ : ${usimRequest}`;
                            },
                            openRequest: (info) => {
                                // ê¸°ë³¸ ì •ë³´ ì²˜ë¦¬
                                const naName = info['ê°€ì…ìëª…'] || info['ê³ ê°ëª…'] || '';
                                const naContact = info['ê°œí†µë²ˆí˜¸'] || info['ì „í™”ë²ˆí˜¸'] || '';
                                const naModel = info['ëª¨ë¸ëª…'] || '';
                                const naColor = info['ìƒ‰ìƒ'] || '';
                                const naPlan = info['ìš”ê¸ˆì œ'] || '';
                                const naSubscriptionType = info['ê°€ì…ìœ í˜•'] || '';
                                
                                // ë‚˜í…” ì„ íƒì•½ì • 12ê°œì›” ì²´í¬
                                if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ íƒì•½ì •' && info['ì•½ì •ê°œì›”ìˆ˜'] === '12ê°œì›”') {
                                    alert('ë‚˜í…”ì€ ì„ íƒì•½ì • 24ê°œì›”ë§Œ ì§„í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì–´ë“œë¯¼ ë©”ëª¨ë¥¼ í™•ì¸í•˜ì„¸ìš”. \në„ìš°ë¯¸ ì–‘ì‹ì€ 24ê°œì›”ë¡œ ìë™ ë³€í™˜ë©ë‹ˆë‹¤.');
                                }
                                
                                // ì•½ì • ì •ë³´ ì²˜ë¦¬ (ê³µì‹œì§€ì› ë˜ëŠ” ì„ íƒì•½ì • + ê°œì›”ìˆ˜)
                                let contractInfo = '';
                                if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ê³µì‹œì§€ì›') {
                                    contractInfo = `ê³µì‹œì§€ì› ${info['ì•½ì •ê°œì›”ìˆ˜'] || '24ê°œì›”'}`;
                                } else if (info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ íƒì•½ì •' || info['ê³µì‹œì„ ì•½ì—¬ë¶€'] === 'ì„ ì•½') {
                                    contractInfo = `ì„ íƒì•½ì •24ê°œì›”`;
                                } else {
                                    contractInfo = `ì•½ì •ì—†ìŒ`;
                                }
                                
                                // ì„ ë‚© ì •ë³´ ì²˜ë¦¬ (í”„ë¦¬í• ë¶€ ìˆìœ¼ë©´ ê¸°ì¬, ì—†ê±°ë‚˜ 0ì´ë©´ X)
                                const prepayInfo = info['í”„ë¦¬í• ë¶€'] && info['í”„ë¦¬í• ë¶€'] !== '0' ? info['í”„ë¦¬í• ë¶€'] : 'X';
                                
                                // ì›ê¸ˆ ì •ë³´ ì²˜ë¦¬ (í• ë¶€ë©´ ìµœì¢…êµ¬ë§¤ê°€, í˜„ê¸ˆì´ë©´ ìµœì¢…êµ¬ë§¤ê°€(â˜…í˜„ê¸ˆì™„ë‚©))
                                const principalInfo = info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í• ë¶€' ? info['ìµœì¢…êµ¬ë§¤ê°€'] || '0' : `${info['ìµœì¢…êµ¬ë§¤ê°€'] || '0'}(â˜…í˜„ê¸ˆì™„ë‚©)`;
                                
                                // ê°œì›” ì •ë³´ ì²˜ë¦¬ (í• ë¶€ë©´ í• ë¶€ê°œì›”ìˆ˜, í˜„ê¸ˆì´ë©´ X)
                                const monthsInfo = info['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] === 'í• ë¶€' ? info['í• ë¶€ê°œì›”ìˆ˜'] || '24ê°œì›”' : 'X';
                                
                                // ìƒë…„ì›”ì¼ ë˜ëŠ” ì£¼ë¯¼ë²ˆí˜¸ ì²˜ë¦¬
                                // const birthOrRegNum = info['ìƒë…„ì›”ì¼'] || info['ì£¼ë¯¼ë²ˆí˜¸'] || '';
                                
                                // ìƒë…„ì›”ì¼/ì£¼ë¯¼ë²ˆí˜¸ë¥¼ yymmdd í˜•íƒœë¡œ ë³€í™˜ (- ì œê±°)
                                let birthOrRegNum = info['ìƒë…„ì›”ì¼'] || info['ì£¼ë¯¼ë²ˆí˜¸'] || '';
                                if (birthOrRegNum) {
                                    // - ì œê±°í•˜ê³  ì• 6ìë¦¬ë§Œ ì¶”ì¶œ (yymmdd)
                                    birthOrRegNum = birthOrRegNum.replace(/-/g, '').substring(0, 6);
                                }
                                
                                return `ê°œí†µìš”ì²­ / ì „ë¬¸í™”	
ìœ í˜•: ${naSubscriptionType}
ê³ ê°ëª… : ${naName}
ìƒë…„ì›”ì¼ : ${birthOrRegNum}
ë²ˆí˜¸ : ${naContact}
ê¸°ì¢…/ìƒ‰ìƒ : ${naModel} ${info.ìš©ëŸ‰ || ''} / ${naColor}
ì¼ë ¨ë²ˆí˜¸ : ${info['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || ''}
ìœ ì‹¬ : ${info['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || ''}
ìš”ê¸ˆì œ : ${naPlan}
ì•½ì • : ${contractInfo}
ì„ ë‚© : ${prepayInfo}
ì›ê¸ˆ : ${principalInfo}	
ê°œì›” : ${monthsInfo}
ë¶€ê°€ : ${info['ë¶€ê°€ì„œë¹„ìŠ¤'] && info['ë¶€ê°€ì„œë¹„ìŠ¤'] !== 'ë¬´' ? info['ë¶€ê°€ì„œë¹„ìŠ¤'] : 'X'}
ë³´í—˜ : ${info['ë³´í—˜'] || 'X'}`;
                            }
                        }
                    },
                    'ì¹´íŒŒ': {
                        name: 'ì¹´íŒŒ',
                        type: 'special',
                        outputType: 'split',
                        memo: agencyMemos['SK']['ì¹´íŒŒ'],
                        templates: {
                            stockRequest: (info) => {
                                // ìœ ì‹¬ ê°’ì— 'ì´ì‹¬' ë˜ëŠ” 'ê¸°ì¡´ìœ ì‹¬' í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ N, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ Y
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasESim = /ì´ì‹¬|ê¸°ì¡´ìœ ì‹¬/i.test(usimValue);
                                const usimRequest = hasESim ? 'X' : 'O';
                                
                                return `â˜… ë‹¨ë§ê¸° ë°°ì •ìš”ì²­ â˜…	
* ë°°ì†¡ë°©ë²• (íƒë°°orí€µ) :	
* ê³ ê°ëª… (ìˆ˜ì·¨ì¸) : ${info.ê³ ê°ëª… || ''}
* ì—°ë½ì²˜ : ${info.ì „í™”ë²ˆí˜¸ || info.ì—°ë½ì²˜ || ''}
* ì£¼ì†Œ : ${info.íƒë°°ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || ''}	 
* ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''}
* ìš©ëŸ‰ : ${info.ìš©ëŸ‰ || ''}	 
* ìƒ‰ìƒ : ${info.ìƒ‰ìƒ || ''}
* íŒë§¤ìœ í˜• : ${info.ê°€ì…ìœ í˜• || ''}
* USIM ë°œì†¡ì—¬ë¶€ : ${usimRequest}`;
                            },
                            openRequest: (info) => {
                                return `â˜…íŒë§¤ì ëª…â˜…ì—ì´ì¹˜ì—˜
ê°œí†µìœ í˜•>${info.ê°€ì…ìœ í˜• || ''}
ê³ ê°ëª…>${info.ê³ ê°ëª… || ''}
ê°œí†µë²ˆí˜¸>${info.ì „í™”ë²ˆí˜¸ || info.ì—°ë½ì²˜ || ''}
ì£¼ë¯¼ë²ˆí˜¸>${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}
ë‹¨ë§ëª¨ë¸ëª…>	${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''}
ë‹¨ë§ìƒ‰ìƒ>${info.ìƒ‰ìƒ || ''}
ì¼ë ¨ë²ˆí˜¸>${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
ìœ ì‹¬ë²ˆí˜¸>${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}
ìš”ê¸ˆì œ>${info.ìš”ê¸ˆì œ || ''}
ë¶€ê°€ì„œë¹„ìŠ¤>${info.ë¶€ê°€ì„œë¹„ìŠ¤ === 'ë¬´'? 'X' : info.ë¶€ê°€ì„œë¹„ìŠ¤ || ''}
ì•½ì •ìœ í˜•>${info.ê³µì‹œì„ ì•½ì—¬ë¶€ || ''} ${info.ì•½ì •ê°œì›”ìˆ˜ || ''}
í• ë¶€ê°œì›”ìˆ˜>${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€' ? (info.í• ë¶€ê°œì›”ìˆ˜ || '24') : 'X'}
í”„ë¦¬í• ë¶€>${info.í”„ë¦¬í• ë¶€ || ''}
í• ë¶€ì›ê¸ˆ>${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€' ? (info.ìµœì¢…êµ¬ë§¤ê°€ || '0') : '0'}
ë²ˆí˜¸ì´ë™ì¸ì¦>	`;
                            }
                        }
                    },
                    'ì‚¼ë³´(ì˜¨ë¼ì¸)': {
                        name: 'ì‚¼ë³´(ì˜¨ë¼ì¸)',
                        type: 'special',
                        outputType: 'split',
                        memo: agencyMemos['SK']['ì‚¼ë³´(ì˜¨ë¼ì¸)'],
                        templates: {
                            stockRequest: (info) => {
                                // ìœ ì‹¬ ê°’ì— 'ì´ì‹¬' ë˜ëŠ” 'ê¸°ì¡´ìœ ì‹¬' í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ X, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ O
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasESim = /ì´ì‹¬|ê¸°ì¡´ìœ ì‹¬/i.test(usimValue);
                                const usimRequest = hasESim ? 'X' : 'O';
                                
                                return `â˜…ì¬ê³ ìš”ì²­(ì‚¼ë³´)
íƒë°°orí€µ : íƒë°°
ì´ë¦„: ${info.ê³ ê°ëª… || ''}
ì—°ë½ì²˜ : ${info.ì „í™”ë²ˆí˜¸ || ''}
ì£¼ì†Œ : ${info.íƒë°°ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || ''}
ìœ ì‹¬ : ${usimRequest}	
ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''}
ìƒ‰ìƒ : ${info.ìƒ‰ìƒ || ''}`;
                            },
                            openRequest: (info) => {
                                // ê¸°íƒ€íŠ¹ì´ì‚¬í•­ êµ¬ì„±
                                let specialNotes = '';
                                
                                // í• ì¸ìœ í˜• / ì•½ì •ê°œì›”ìˆ˜
                                const discountType = info.í• ì¸ìœ í˜• || info.ê³µì‹œì„ ì•½ì—¬ë¶€ || '';
                                const contractMonths = info.ì•½ì •ê°œì›”ìˆ˜ || '';
                                if (discountType && contractMonths) {
                                    specialNotes += `${discountType} ${contractMonths}`;
                                } else if (discountType) {
                                    specialNotes += discountType;
                                }
                                
                                // ìš”ê¸ˆì œ
                                const plan = info.ìš”ê¸ˆì œ || '';
                                if (plan) {
                                    specialNotes += specialNotes ? ` / ${plan}` : plan;
                                }
                                
                                // í• ë¶€/í˜„ê¸ˆ ì •ë³´
                                let paymentInfo = '';
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                    paymentInfo = `í˜„ê¸ˆì™„ë‚©(${info.ìµœì¢…êµ¬ë§¤ê°€ || ''})`;
                                } else if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                    paymentInfo = `í• ë¶€${info.í• ë¶€ê°œì›”ìˆ˜ || '24ê°œì›”'} (${info.ìµœì¢…êµ¬ë§¤ê°€ || ''})`;
                                }
                                
                                if (paymentInfo) {
                                    specialNotes += specialNotes ? ` / ${paymentInfo}` : paymentInfo;
                                }
                                
                                // í˜„ì¬ ì›”ì„ 2ìë¦¬ í˜•ì‹ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸° (01, 02, ..., 12)
                                const currentMonth = String(new Date().getMonth() + 1).padStart(2, '0');
                                
                                return `[T-GATE ë¬´ì„  ì ‘ìˆ˜ ì–‘ì‹ ${currentMonth}ì›” â˜… ]
1. ê³ ê°ëª…: ${info.ê³ ê°ëª… || ''}
2. ì „í™”ë²ˆí˜¸: ${info.ì „í™”ë²ˆí˜¸ || ''}
3. ì£¼ë¯¼ë²ˆí˜¸(13ìë¦¬): ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}
4. ë²•ì •ëŒ€ë¦¬ì¸: ${info.ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„ || 'X'}
5. ë²•ëŒ€ì£¼ë¯¼ë²ˆí˜¸(13ìë¦¬): ${info.ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸ || 'X'}
6. ë²•ëŒ€ì—°ë½ì²˜: ${info.ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜ || 'X'}
7. ì „í†µì‹ ì‚¬ : ${info.í˜„ì¬í†µì‹ ì‚¬ || ''}
8. ëª¨ë¸ëª…: ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''}
9. ì¼ë ¨ë²ˆí˜¸: ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
10. ìœ ì‹¬ë²ˆí˜¸(13ìë¦¬): ${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}
11.ìœ ì‹¬ ì„ ë‚©/í›„ë‚©: ${info.ìœ ì‹¬ || ''}

12. ê¸°íƒ€íŠ¹ì´ì‚¬í•­ : ${specialNotes}
13. íŒë§¤ì ëª…: ì—ì´ì¹˜ì— ì”¨
14. Pì½”ë“œ: ì—ì´ì¹˜ì— ì”¨`;
                            }
                        }
                    },
                    'ë°€ë¦¬ì–¸': {
                        name: 'ë°€ë¦¬ì–¸',
                        type: 'special',
                        outputType: 'multi',
                        memo: agencyMemos['SK']['ë°€ë¦¬ì–¸'],
                        templates: {
                            request: (info) => {
                                // ê°€ì…ìœ í˜• + í• ë¶€í˜„ê¸ˆì—¬ë¶€ + 'ê°œí†µ' ì¡°í•©
                                const subscriptionType = info.ê°€ì…ìœ í˜• || '';
                                const paymentType = info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || '';
                                const requestType = `${subscriptionType} ${paymentType}ê°œí†µ`;
                                
                                // ê³ ê°ëª… (ê³ ê°ëª… ë˜ëŠ” ê°€ì…ìëª…)
                                const customerName = info.ê³ ê°ëª… || info.ê°€ì…ìëª… || '';
                                
                                // ìƒë…„ì›”ì¼/ì£¼ë¯¼ë²ˆí˜¸
                                const birthOrId = info.ìƒë…„ì›”ì¼ || info.ì£¼ë¯¼ë²ˆí˜¸ || '';
                                
                                // ê°œí†µë²ˆí˜¸/ì „í™”ë²ˆí˜¸  
                                const phoneNumber = info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || '';
                                
                                return `â˜…ì‹ ì¡°ìš”ì²­â˜…
${requestType}
${customerName}/${birthOrId}/${phoneNumber}`;
                            },
                            stock: (info) => {
                                // ìœ ì‹¬ ê°’ í™•ì¸í•´ì„œ ê¸°ì¡´ìœ ì‹¬ ì—¬ë¶€ ê²°ì •
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasExistingUsim = /ê¸°ì¡´ìœ ì‹¬|ê¸°ì¡´/i.test(usimValue);
                                const customerNameSuffix = hasExistingUsim ? ' (ê¸°ì¡´ìœ ì‹¬ì¬ì‚¬ìš©)' : '';
                                
                                return `â˜…ë¼ì˜¨ì•„ì´ ë°°ì •ìš”ì²­
${info.ê³ ê°ëª… || info.ê°€ì…ìëª… || ''}${customerNameSuffix}`;
                            },
                            memo: (info) => {
                                // ìœ ì‹¬ ìƒíƒœ ê²°ì • (ê¸°ì¡´, ê¸°ì¡´ìœ ì‹¬ ë¬¸ìì—´ì´ ì—†ìœ¼ë©´ í›„ì²­êµ¬, ìˆìœ¼ë©´ ê¸°ì¡´ìœ ì‹¬ì¬ì‚¬ìš©)
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasExistingUsim = /ê¸°ì¡´|ê¸°ì¡´ìœ ì‹¬/i.test(usimValue);
                                const usimStatus = hasExistingUsim ? 'ê¸°ì¡´ìœ ì‹¬ì¬ì‚¬ìš©' : 'í›„ì²­êµ¬';
                                
                                // í• ë¶€ì›ê¸ˆ ì²˜ë¦¬
                                let paymentInfo = '';
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                    paymentInfo = `â˜…í˜„ê¸ˆì™„ë‚©(${info.ìµœì¢…êµ¬ë§¤ê°€ || ''})`;
                                } else if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                    const priceInfo = info.ìµœì¢…êµ¬ë§¤ê°€ ? `${info.ìµœì¢…êµ¬ë§¤ê°€}` : '';
                                    const monthInfo = info.í• ë¶€ê°œì›”ìˆ˜ ? ` / ${info.í• ë¶€ê°œì›”ìˆ˜}` : '';
                                    paymentInfo = `${priceInfo}${monthInfo}`;
                                    
                                    // í”„ë¦¬í• ë¶€ê°€ ìˆëŠ” ê²½ìš° ì¶”ê°€
                                    if (info.í”„ë¦¬í• ë¶€ && info.í”„ë¦¬í• ë¶€ !== '0') {
                                        paymentInfo += ` (í”„ë¦¬í• ë¶€: ${info.í”„ë¦¬í• ë¶€})`;
                                    }
                                } else {
                                    paymentInfo = info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || '';
                                }
                                
                                // ë¶€ê°€ì„œë¹„ìŠ¤ ì •ë¦¬
                                const additionalServices = [];
                                if (info.ë¶€ê°€ì„œë¹„ìŠ¤ && info.ë¶€ê°€ì„œë¹„ìŠ¤ !== 'ë¬´') {
                                    additionalServices.push(info.ë¶€ê°€ì„œë¹„ìŠ¤);
                                }
                                if (info.ë³´í—˜) {
                                    additionalServices.push(info.ë³´í—˜);
                                }
                                const servicesText = additionalServices.length > 0 ? additionalServices.join(' / ') : '';
                                
                                return `ê°œí†µìš”ì²­(${info.ê°€ì…ìœ í˜• || ''})
*í˜„í†µì‹ ì‚¬ : ${info.í˜„ì¬í†µì‹ ì‚¬ || ''}
ì´ë¦„ : ${info.ê°€ì…ìëª… || info.ê³ ê°ëª… || ''}
ì£¼ë¯¼ë²ˆí˜¸ : ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}
ê°œí†µë²ˆí˜¸ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
êµ¬ë§¤ê¸°ì¢… : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''} / ${info.ìƒ‰ìƒ || ''}
ìœ ì‹¬ : ${usimStatus}
ìš”ê¸ˆì œ : ${info.ìš”ê¸ˆì œ || ''}
í• ë¶€ì›ê¸ˆ (í”„ë¦¬í• ë¶€) / ê°œì›”ìˆ˜ : ${paymentInfo}
ë¶€ê°€ì„œë¹„ìŠ¤ : ${servicesText}`;
                            }
                        }
                    },
                    'ì¥ì²œ': {
                        name: 'ì¥ì²œ',
                        type: 'special',
                        outputType: 'multi',
                        memo: agencyMemos['SK']['ì¥ì²œ'],
                        templates: {
                            delivery: (info) => {
                                // ìœ ì‹¬ ì—¬ë¶€ ê²°ì • (ê¸°ì¡´, ê¸°ì¡´ìœ ì‹¬ í…ìŠ¤íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ X, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ O)
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasExistingUsim = /ê¸°ì¡´|ê¸°ì¡´ìœ ì‹¬/i.test(usimValue);
                                const usimStatus = hasExistingUsim ? 'X' : 'O';
                                
                                return `â–  ë°°ì†¡ìš”ì²­(íƒë°°)
â–¶ê³ ê°ëª… : ${info.ê°€ì…ìëª… || info.ê³ ê°ëª… || ''}
â–¶ëª¨ë¸ : ${info.ëª¨ë¸ëª… || ''}${info.ìš©ëŸ‰ ? info.ìš©ëŸ‰ : ''} ${info.ìƒ‰ìƒ || ''}
â–¶ìœ ì‹¬ì—¬ë¶€ : ${usimStatus}
â–¶ë°°ì†¡ì§€ : ${info.ë°°ì†¡ì£¼ì†Œì§€ || info.íƒë°°ì£¼ì†Œ || ''}
â–¶ì—°ë½ì²˜: ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}`;
                            },
                            open: (info) => {
                                // ë¯¸ì„±ë…„ì ì—¬ë¶€ í™•ì¸
                                const isMinor = info.ë¯¸ì„±ë…„ìì—¬ë¶€ === 'Y';
                                
                                // í˜„ê¸ˆ/í• ë¶€ ì •ë³´ ì²˜ë¦¬
                                let paymentInfo = '';
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                    paymentInfo = `í˜„ê¸ˆ ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}`;
                                } else if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                    paymentInfo = `í• ë¶€ ${info.í• ë¶€ê°œì›”ìˆ˜ || ''} ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}`;
                                } else {
                                    paymentInfo = info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || '';
                                }
                                
                                // ì•½ì • ì •ë³´ ì²˜ë¦¬
                                const contractInfo = info.ê³µì‹œì„ ì•½ì—¬ë¶€ || info.í• ì¸ìœ í˜• || '';
                                
                                // í˜„ì¬í†µì‹ ì‚¬ ì¸ì¦ê°’ ì²˜ë¦¬
                                const carrierAuth = info.í˜„ì¬í†µì‹ ì‚¬ ? `${info.í˜„ì¬í†µì‹ ì‚¬} & ì¸ì¦ê°’` : '';
                                
                                if (isMinor) {
                                    // ë¯¸ì„±ë…„ì (ì²­ì†Œë…„) ì–‘ì‹
                                    return `[ ì²­ì†Œë…„ê°œí†µìš”ì²­ ì–‘ì‹ ]
ã…‡ê³ ê°ëª… : ${info.ê³ ê°ëª… || info.ê°€ì…ìëª… || ''}
ã…‡ê°œí†µë²ˆí˜¸ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
ã…‡ì£¼ë¯¼ë²ˆí˜¸(í’€ë¡œ) : ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}
ã…‡ì „í†µì‹ ì‚¬&ì¸ì¦ê°’ : ${carrierAuth}
ã…‡ë²•ëŒ€ì´ë¦„ : ${info.ë²•ì •ëŒ€ë¦¬ì¸ëª… || info.ë³´í˜¸ìëª… || ''}
ã…‡ë²•ëŒ€ ì—°ë½ì²˜ : ${info.ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜ || info.ë³´í˜¸ìì—°ë½ì²˜ || ''}
ã…‡ë²•ëŒ€ ì£¼ë¯¼ë²ˆí˜¸ : ${info.ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸ || info.ë³´í˜¸ìì£¼ë¯¼ë²ˆí˜¸ || ''}
ã…‡ê³ ê°ì²­êµ¬ì£¼ì†Œ : ${info.ì²­êµ¬ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || info.íƒë°°ì£¼ì†Œ || ''}
ã…‡ìë™ì´ì²´ : ${info.ìë™ì´ì²´ || ''}
ã…‡ìš”ê¸ˆì œ : ${info.ìš”ê¸ˆì œ || ''}
ã…‡ì•½ì •(ê³µì‹œorì„ ì•½) : ${contractInfo}
ã…‡í• ë¶€ or í˜„ê¸ˆ : ${paymentInfo}
ã…‡ê³ ê°ì„ ë‚© : ${info.í”„ë¦¬í• ë¶€ || 'X'}
ã…‡ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''} ${info.ìƒ‰ìƒ || ''}
ã…‡ì¼ë ¨ë²ˆí˜¸ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
ã…‡ìœ ì‹¬ë²ˆí˜¸ : ${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}
ã…‡ë¶€ê°€ì„œë¹„ìŠ¤ : ${info.ë¶€ê°€ì„œë¹„ìŠ¤ || 'X'}
ã…‡ë³´í—˜ê°€ì… : ${info.ë³´í—˜ || 'X'}
ã…‡ì§€ì •ë²ˆí˜¸ : X
ã…‡ë³µì§€ : X`;
                                } else {
                                    // ì„±ì¸ ì–‘ì‹
                                    return `[ ì„±ì¸ê°œí†µìš”ì²­ ì–‘ì‹ ]
ã…‡ê³ ê°ëª… : ${info.ê³ ê°ëª… || info.ê°€ì…ìëª… || ''}
ã…‡ê°œí†µë²ˆí˜¸ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
ã…‡ì£¼ë¯¼ë²ˆí˜¸(í’€ë¡œ) : ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}
ã…‡ì „í†µì‹ ì‚¬&ì¸ì¦ê°’ : ${carrierAuth}
ã…‡ê³ ê°ì²­êµ¬ì£¼ì†Œ : ${info.ì²­êµ¬ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || info.íƒë°°ì£¼ì†Œ || ''}
ã…‡ìë™ì´ì²´ : ${info.ìë™ì´ì²´ || ''}
ã…‡ìš”ê¸ˆì œ : ${info.ìš”ê¸ˆì œ || ''}
ã…‡ì•½ì •(ê³µì‹œorì„ ì•½) : ${contractInfo}
ã…‡í• ë¶€ or í˜„ê¸ˆ : ${paymentInfo}
ã…‡ê³ ê°ì„ ë‚© : ${info.í”„ë¦¬í• ë¶€ || 'X'}
ã…‡ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''} ${info.ìƒ‰ìƒ || ''}
ã…‡ì¼ë ¨ë²ˆí˜¸ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
ã…‡ìœ ì‹¬ë²ˆí˜¸ : ${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}
ã…‡ë¶€ê°€ì„œë¹„ìŠ¤ : ${info.ë¶€ê°€ì„œë¹„ìŠ¤ || 'X'}
ã…‡ë³´í—˜ê°€ì… : ${info.ë³´í—˜ || 'X'}
ã…‡ë³µì§€ : X`;
                                }
                            }
                        }
                    },
                    'ì‚¼ë³´/ì— ë””ë„ë§¤': {
                        name: 'ì‚¼ë³´/ì— ë””ë„ë§¤',
                        type: 'normal',
                        outputType: 'single',
                        memo: agencyMemos['SK']['ì‚¼ë³´/ì— ë””ë„ë§¤'],
                        template: (info) => `[ì‚¼ë³´/ì— ë””ë„ë§¤]\n${info.ê³ ê°ëª…}\n${info.ëª¨ë¸ëª…}\n${info.ìƒ‰ìƒ}\n${info.ìš”ê¸ˆì œ}\n${info.ê°€ì…ìœ í˜•}\n${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€} ${info.ìµœì¢…êµ¬ë§¤ê°€}ì›`
                    },
                    'ì½”ì›¨ì–´': {
                        name: 'ì½”ì›¨ì–´',
                        type: 'special',
                        outputType: 'single',
                        memo: agencyMemos['SK']['ì½”ì›¨ì–´'],
                        template: (info) => {
                            let result = `[ê°œí†µìš”ì²­]\nê³ ê°ëª… - ${info.ê³ ê°ëª… || ''}\nì£¼ë¯¼ë²ˆí˜¸ - ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}\nê°œí†µë²ˆí˜¸ - ${info.ì „í™”ë²ˆí˜¸ || info.ê°œí†µë²ˆí˜¸ || info.ì—°ë½ì²˜ || ''}\në‹¨ë§ì •ë³´ - ${info.ëª¨ë¸ëª… || ''} ${info.ìƒ‰ìƒ || ''}\nì¼ë ¨ë²ˆí˜¸ - ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}\nìš”ê¸ˆì œ - ${info.ìš”ê¸ˆì œ || ''}\n`;
                            
                            if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                result += `í• ë¶€ - ${info.í• ë¶€ê°œì›”ìˆ˜ || '24'}\n`;
                                if (info.í”„ë¦¬í• ë¶€ && info.í”„ë¦¬í• ë¶€ !== '0') {
                                    result += `í”„ë¦¬ - ${info.í”„ë¦¬í• ë¶€}\n`;
                                }
                                result += `í• ë¶€ì›ê¸ˆ - ${info.ìµœì¢…êµ¬ë§¤ê°€ || '0'}\n`;
                            } else if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                result += `í• ë¶€ - 0\n`;
                                result += `í• ë¶€ì›ê¸ˆ - 0\n`;
                                result += `í˜„ê¸ˆì™„ë‚© - O\n`;
                            }
                            
                            if (info.ê³µì‹œì„ ì•½ì—¬ë¶€ === 'ê³µì‹œì§€ì›' || info.ê³µì‹œì„ ì•½ì—¬ë¶€ === 'ì„ íƒì•½ì •' || info.ê³µì‹œì„ ì•½ì—¬ë¶€ === 'ì„ ì•½') {
                                result += `ì„ ì•½&ê³µì‹œ - ${info.ê³µì‹œì„ ì•½ì—¬ë¶€} ${info.ì•½ì •ê°œì›”ìˆ˜ || '24'}\n`;
                            }
                            
                            result += `ìœ ì‹¬ - ${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || info.ìœ ì‹¬ || ''}\n`;
                            return result;
                        }
                    },
                    'ì´ì•¤í‹°': {
                        name: 'ì´ì•¤í‹°',
                        type: 'special',
                        outputType: 'split',
                        memo: agencyMemos['SK']['ì´ì•¤í‹°'],
                        templates: {
                            stockRequest: (info) => {
                                // ìœ ì‹¬ ê°’ì— 'ì´ì‹¬' ë˜ëŠ” 'ê¸°ì¡´ìœ ì‹¬' í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ ë¹„êµ¬ë§¤, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ êµ¬ë§¤
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasESim = /ì´ì‹¬|ê¸°ì¡´ìœ ì‹¬/i.test(usimValue);
                                const usimStatus = hasESim ? 'ë¹„êµ¬ë§¤' : 'êµ¬ë§¤';
                                
                                return `â–¶ë°°ì†¡ë°©ë²•(íƒë°°/í€µ/ë‚´ë°©) : íƒë°°   
- ë°›ëŠ”ë¶„ : ${info.ê³ ê°ëª… || ''}
- ì—°ë½ì²˜ : ${info.ì „í™”ë²ˆí˜¸ || ''}
- ì£¼ ì†Œ : ${info.íƒë°°ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || ''}
â–¶ëª¨ë¸ëª…/ìƒ‰ìƒ : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''} / ${info.ìƒ‰ìƒ || ''}
â–¶ê¸°ê¸°ì¼ë ¨ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
â–¶ìœ ì‹¬(êµ¬ë§¤/ë¹„êµ¬ë§¤) : ${usimStatus}`;
                            },
                            openRequest: (info) => {
                                // ì§€ì •ë²ˆí˜¸ ì²˜ë¦¬ (ì‹ ê·œê°€ì…ì´ ì•„ë‹ˆë©´ X)
                                const subscriptionType = info.ê°€ì…ìœ í˜• || '';
                                const designatedNumber = ['ì‹ ê·œê°€ì…', 'ì‹ ê·œ'].includes(subscriptionType) ? '' : 'X';
                                
                                // í• ë¶€ì„ í• ì¸ ì²˜ë¦¬ (í”„ë¦¬í• ë¶€ê°€ ìˆìœ¼ë©´ í”„ë¦¬í• ë¶€ ê°’, ì—†ìœ¼ë©´ X)
                                const installmentDiscount = (info.í”„ë¦¬í• ë¶€ && info.í”„ë¦¬í• ë¶€ !== '0') ? info.í”„ë¦¬í• ë¶€ : 'X';
                                
                                // ìœ ì‹¬ ì²˜ë¦¬ (ì¦‰ë‚©/í›„ë‚©/ê¸°ì¡´)
                                const usimType = info.ìœ ì‹¬ || '';
                                
                                // ê³µì‹œ/ì„ ì•½ ì²˜ë¦¬
                                const contractType = info.ê³µì‹œì„ ì•½ì—¬ë¶€ || info.í• ì¸ìœ í˜• || '';
                                
                                // ê³µì‹œì§€ì›ì¸ ê²½ìš° ì¶”ê°€ ì •ë³´ í‘œì‹œ
                                let contractDisplayText = contractType;
                                if (contractType === 'ê³µì‹œì§€ì›') {
                                    contractDisplayText = `${contractType} ${info.ì•½ì •ê°œì›”ìˆ˜ || ''} (ê³µì‹œ ${info.ê³µì‹œ || ''} / ì¶”ì§€ ${info.ì¶”ì§€ || ''})`;
                                } else if (contractType === 'ì„ íƒì•½ì •') {
                                    contractDisplayText = `${contractType} ${info.ì•½ì •ê°œì›”ìˆ˜ || ''}`;
                                } else {
                                    contractDisplayText = `${contractType} ${info.ì•½ì •ê°œì›”ìˆ˜ || ''}`;
                                }
                                
                                // í˜„ê¸ˆ/í• ë¶€ ì²˜ë¦¬
                                let paymentType = '';
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ') {
                                    paymentType = `í˜„ê¸ˆì™„ë‚© ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}`;
                                } else if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€') {
                                    paymentType = `í• ë¶€ ${info.í• ë¶€ê°œì›”ìˆ˜ || ''} ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}`;
                                } else {
                                    paymentType = info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || '';
                                }
                                
                                return `â˜…ì •ì±…ëª…
â–¶íŒë§¤ì  : ì‹ í’
â–¶ê³ ê°ëª… : ${info.ê³ ê°ëª… || ''}
â–¶ê°œí†µë²ˆí˜¸ : ${info.ì „í™”ë²ˆí˜¸ || ''}
â–¶ì£¼ë¯¼ë²ˆí˜¸ : ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}
â–¶ì „í†µì‹ ì‚¬ : ${info.í˜„ì¬í†µì‹ ì‚¬ || ''}
â–¶ëª¨ë¸/ìƒ‰ìƒ : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''} / ${info.ìƒ‰ìƒ || ''}
â–¶ë‹¨ë§ì¼ë ¨ë²ˆí˜¸ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
â–¶ìœ ì‹¬(ì¦‰ë‚©/í›„ë‚©/ê¸°ì¡´) : ${usimType}
â–¶ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ : ${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}
â–¶ê³µì‹œ/ì„ ì•½ : ${contractDisplayText}
â–¶í˜„ê¸ˆ/í• ë¶€ : ${paymentType}
â–¶í• ë¶€ì„ í• ì¸ : ${installmentDiscount}
â–¶ìš”ê¸ˆì œ : ${info.ìš”ê¸ˆì œ || ''}
â–¶ì§€ì •ë²ˆí˜¸ : ${designatedNumber}
â–¶ë¶€ê°€ : ${info.ë¶€ê°€ì„œë¹„ìŠ¤ && info.ë¶€ê°€ì„œë¹„ìŠ¤ !== 'ë¬´' ? info.ë¶€ê°€ì„œë¹„ìŠ¤ : ''}${info.ë³´í—˜ ? '\nâ–¶ë³´í—˜ : ' + info.ë³´í—˜ : ''}`;
                            }
                        }
                    }
                }
            },
            'KT': {
                name: 'KT',
                agencies: {
                    'ì¬í¬': {
                        name: 'ì¬í¬',
                        type: 'special',
                        outputType: 'table',
                        memo: agencyMemos['KT']['ì¬í¬'],
                        template: (info) => {
                            const additionalOutput = `${info.ëª¨ë¸ëª… || ''} / ${info.ê°€ì…ìœ í˜• || ''}\n` +
                                `${info.ê³ ê°ëª… || ''} / ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''} / ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || info.ì—°ë½ì²˜ || ''}\n` +
                                `ì ‘ìˆ˜ í™•ì¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤.`;
                            return {
                                tableData: info,
                                additionalText: additionalOutput
                            };
                        }
                    },
                    'ì˜¤ì•¤í‹°': {
                        name: 'ì˜¤ì•¤í‹°',
                        type: 'special',
                        outputType: 'multi',
                        memo: agencyMemos['KT']['ì˜¤ì•¤í‹°'],
                        templates: {
                            request: (info) => `â˜…ì‹ ì¡°ìš”ì²­ â˜…
${info.ê°€ì…ìœ í˜• || ''} ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || ''}ê°œí†µ
ì„±í•¨ : ${info.ê³ ê°ëª… || info.ê°€ì…ìëª… || ''}
ì£¼ë¯¼ë²ˆí˜¸ : ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''}
ê°œí†µë²ˆí˜¸ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}`,
                            delivery: (info) => {
                                // ìœ ì‹¬ ê°’ì— 'ì´ì‹¬' ë˜ëŠ” 'ê¸°ì¡´ìœ ì‹¬' í‚¤ì›Œë“œê°€ ìˆìœ¼ë©´ ë¹„êµ¬ë§¤, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ êµ¬ë§¤
                                const usimValue = info.ìœ ì‹¬ || '';
                                const hasESim = /ì´ì‹¬|ê¸°ì¡´ìœ ì‹¬/i.test(usimValue);
                                const usimStatus = hasESim ? 'X' : 'O';
                                
                                return `ê·¸ë£¹ : ë‘˜ì§¸
ì‚¼ì°¨ì (íŒë§¤ì ) : ë¼ì˜¨ì•„ì´
ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''}
ìƒ‰ìƒ : ${info.ìƒ‰ìƒ || ''}
ì¼ë ¨ë²ˆí˜¸ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
ìœ ì‹¬ : ${usimStatus}
ë°°ì†¡ìœ í˜• : íƒë°°
ìš´ì†¡ì¥ :
ê³ ê°ëª… : ${info.ê³ ê°ëª… || info.ê°€ì…ìëª… || ''}
ì—°ë½ì²˜ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
ì£¼ì†Œ : ${info.íƒë°°ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || ''}
í• ì¦/ë¹„í• ì¦ :
ê¸°íƒ€ :`;
                            },
                            open: (info) => `íŒë§¤ì : ë¼ì˜¨
íŒë§¤ìì—°ë½ì²˜ : 010-4671-4834

ê³ ê°ëª… : ${info.ê³ ê°ëª… || info.ê°€ì…ìëª… || ''}
ê°€ì…ìœ í˜• : ${info.ê°€ì…ìœ í˜• || ''}${info.í˜„ì¬í†µì‹ ì‚¬ ? '(' + info.í˜„ì¬í†µì‹ ì‚¬ + ')' : ''}
ìƒë…„ì›”ì¼ : ${info.ìƒë…„ì›”ì¼ || info.ì£¼ë¯¼ë²ˆí˜¸ || ''}
ê°œí†µë²ˆí˜¸ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''} ${info.ìš©ëŸ‰ || ''}
ìƒ‰ìƒ : ${info.ìƒ‰ìƒ || ''}
ì¼ë ¨ë²ˆí˜¸ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
ìš”ê¸ˆì œ : ${info.ìš”ê¸ˆì œ || ''}
ìœ ì‹¬ : ${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}
í˜„ê¸ˆ/í• ë¶€(ê°œì›”ìˆ˜) : ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ' ? info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ + 'ì™„ë‚©' : info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || ''}${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€' ? '(' + (info.í• ë¶€ê°œì›”ìˆ˜ || '') + ')' : ''}
ì½”ìŠ¤ : ${info.ê³µì‹œì„ ì•½ì—¬ë¶€ || info.í• ì¸ìœ í˜• || ''}${info.ì•½ì •ê°œì›”ìˆ˜ ? ' ' + info.ì•½ì •ê°œì›”ìˆ˜ : ''}
ê³µì‹œì§€ì›ê¸ˆ : ${info.ê³µì‹œ && info.ê³µì‹œ !== '0' ? info.ê³µì‹œ : 'X'}
ì¶”ê°€ì§€ì›ê¸ˆ : ${info.ì¶”ì§€ && info.ì¶”ì§€ !== '0' ? info.ì¶”ì§€ : 'X'}
ì „í™˜ì§€ì›ê¸ˆ : ${info.ì „í™˜ì§€ì›ê¸ˆ && info.ì „í™˜ì§€ì›ê¸ˆ !== '0' ? info.ì „í™˜ì§€ì›ê¸ˆ : 'X'}
í”„ë¦¬ê¸ˆì•¡ : ${info.í”„ë¦¬í• ë¶€ && info.í”„ë¦¬í• ë¶€ !== '0' ? info.í”„ë¦¬í• ë¶€ : 'X'}
í• ë¶€ì›ê¸ˆ : ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || '' } ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}
ë³´í—˜ : ${info.ë³´í—˜ || 'X'}
ë¶€ê°€ : ${info.ë¶€ê°€ì„œë¹„ìŠ¤ || 'X'}`
                        }
                    },
                    'ì•ˆì‚°/ì´ìŠ¤í„´': {
                        name: 'ì•ˆì‚°/ì´ìŠ¤í„´',
                        type: 'normal',
                        outputType: 'single',
                        memo: agencyMemos['KT']['ì•ˆì‚°/ì´ìŠ¤í„´'],
                        template: (info) => `[ì•ˆì‚°/ì´ìŠ¤í„´] ${info.ê³ ê°ëª… || ''} - ${info.ëª¨ë¸ëª… || ''} - ${info.ìƒ‰ìƒ || ''} - ${info.ìš”ê¸ˆì œ || ''} - ${info.ê°€ì…ìœ í˜• || ''} - ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || ''} ${info.ìµœì¢…êµ¬ë§¤ê°€ ? info.ìµœì¢…êµ¬ë§¤ê°€ + 'ì›' : ''}`,
                        extensionForm: (info) => `[ì•ˆì‚°/ì´ìŠ¤í„´-ì‹ ì²­ì„œì—°ì¥]
ê³ ê°ëª…: ${info.ê³ ê°ëª… || ''}
ì—°ë½ì²˜: ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
ëª¨ë¸ëª…: ${info.ëª¨ë¸ëª… || ''}
ìƒ‰ìƒ: ${info.ìƒ‰ìƒ || ''}
ìš”ê¸ˆì œ: ${info.ìš”ê¸ˆì œ || ''}
ê°€ì…ìœ í˜•: ${info.ê°€ì…ìœ í˜• || ''}
í• ë¶€ê¸ˆì•¡: ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ || ''} ${info.ìµœì¢…êµ¬ë§¤ê°€ ? info.ìµœì¢…êµ¬ë§¤ê°€ + 'ì›' : ''}`
                    },
                    'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹': {
                        name: 'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹',
                        type: 'normal',
                        outputType: 'single',
                        memo: '',
                        template: (info) => `${info.ê³ ê°ëª… || ''} / ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''} / ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}`
                    }
                }
            },
            'LG': {
                name: 'LG',
                agencies: {
                    'ì†Œë¦¬': {
                        name: 'ì†Œë¦¬',
                        type: 'special',
                        outputType: 'table',
                        memo: agencyMemos['LG']['ì†Œë¦¬'],
                        template: (info) => {
                            const additionalOutput = `${info.ëª¨ë¸ëª… || ''} / ${info.ê°€ì…ìœ í˜• || ''}\n` +
                                `${info.ê³ ê°ëª… || ''} / ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''} / ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || info.ì—°ë½ì²˜ || ''}\n` +
                                `ì ‘ìˆ˜ í™•ì¸ ë° ì‹ ì¡° ë¶€íƒë“œë¦½ë‹ˆë‹¤.`;
                            return {
                                tableData: info,
                                additionalText: additionalOutput
                            };
                        }
                    },
                    'ì œì´/íœ´ë„·': {
                        name: 'ì œì´/íœ´ë„·',
                        type: 'special',
                        outputType: 'multi',
                        memo: agencyMemos['LG']['ì œì´/íœ´ë„·'],
                        templates: {
                            confirm: (info) => `â˜… ì ‘ìˆ˜ í™•ì¸ ìš”ì²­ë“œë¦½ë‹ˆë‹¤.
â–¶ê³ ê°ëª… : ${info.ê³ ê°ëª… || ''}
â–¶ìƒë…„ì›”ì¼ : ${info.ìƒë…„ì›”ì¼ || info.ì£¼ë¯¼ë²ˆí˜¸ || ''}
â–¶ê°œí†µë²ˆí˜¸ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
â–¶ê°€ì…ìœ í˜• : ${info.ê°€ì…ìœ í˜• || ''}
â–¶ëª¨ë¸ëª… : ${info.ëª¨ë¸ëª… || ''}`,
                            delivery: (info) => `â– ë°°ì†¡ìš”ì²­â– 

â–¶ì—…ì²´ëª… : ìœ„ì¦ˆì¼€ì´
â–¶ë°°ì†¡ë°©ë²•(íƒë°°/í€µ/ë‚´ë°©) : íƒë°°
- ë°›ëŠ”ë¶„ : ${info.ê³ ê°ëª… || ''}
- ì—°ë½ì²˜ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
- ì£¼ ì†Œ : ${info.íƒë°°ì£¼ì†Œ || info.ë°°ì†¡ì£¼ì†Œì§€ || ''}
â–¶ëª¨ë¸ëª…/ìƒ‰ìƒ : ${info.ëª¨ë¸ëª… || ''}/${info.ìƒ‰ìƒ || ''}
â–¶ê¸°ê¸°ì¼ë ¨ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
â–¶ìœ ì‹¬(êµ¬ë§¤/ë¹„êµ¬ë§¤) : ${info.ìœ ì‹¬ || ''}`,
                            open: (info) => `â–¶íŒë§¤ì²˜ : ìœ„ì¦ˆì¼€ì´
â–¶ê°€ì…ìœ í˜• : ${info.ê°€ì…ìœ í˜• || ''}
â–¶ê³ ê°ëª… : ${info.ê³ ê°ëª… || ''}
â–¶ìƒë…„ì›”ì¼ : ${info.ìƒë…„ì›”ì¼ || info.ì£¼ë¯¼ë²ˆí˜¸ || ''}
â–¶ê°œí†µë²ˆí˜¸ : ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}
â–¶ë²•ëŒ€ : ${info.ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„ || ''}
â–¶ëª¨ë¸ëª…/ìƒ‰ìƒ : ${info.ëª¨ë¸ëª… || ''}/${info.ìƒ‰ìƒ || ''}
â–¶ë‹¨ë§ì¼ë ¨ : ${info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || ''}
â–¶ìœ ì‹¬ëª¨ë¸/ì¼ë ¨ : ${info.ìœ ì‹¬ || ''}/${info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || ''}
â–¶ìš”ê¸ˆì œ : ${info.ìš”ê¸ˆì œ || ''}
â–¶ê³µì‹œ/ì„ ì•½(12/24): ${info.ê³µì‹œì„ ì•½ì—¬ë¶€ || ''}${info.ì•½ì •ê°œì›”ìˆ˜ ? '(' + info.ì•½ì •ê°œì›”ìˆ˜ + ')' : ''}
â–¶ì¶”ê°€ì§€ì›ê¸ˆ(15%) : ${info.ì¶”ì§€ || ''}
â–¶ì „í™˜ì§€ì›ê¸ˆ: ${info.ì „í™˜ì§€ì›ê¸ˆ && info.ì „í™˜ì§€ì›ê¸ˆ !== '0' ? info.ì „í™˜ì§€ì›ê¸ˆ : 'X'}
â–¶í• ë¶€(ê°œì›”)/í˜„ê¸ˆ : ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í• ë¶€' ? `í• ë¶€(${info.í• ë¶€ê°œì›”ìˆ˜ || '24ê°œì›”'})` : info.í• ë¶€í˜„ê¸ˆì—¬ë¶€ === 'í˜„ê¸ˆ' ? 'í˜„ê¸ˆ' : ''}
â–¶ì¶œê³ ê°€ : ${info.ì¶œê³ ê°€ || ''}
â–¶í”„ë¦¬(ê³ ê°ì„ ë‚©) : ${info.í”„ë¦¬í• ë¶€ && info.í”„ë¦¬í• ë¶€ !== '0' ? info.í”„ë¦¬í• ë¶€ : 'X'}
â–¶í• ë¶€ì›ê¸ˆ : ${info.ìµœì¢…êµ¬ë§¤ê°€ || ''}
â–¶ë¶€ê°€ì„œë¹„ìŠ¤ : ${info.ë¶€ê°€ì„œë¹„ìŠ¤ && info.ë¶€ê°€ì„œë¹„ìŠ¤ !== 'ë¬´' ? info.ë¶€ê°€ì„œë¹„ìŠ¤ : 'X'}
â–¶ë³´í—˜ìœ ë¬´ : ${info.ë³´í—˜ || 'X'}`
                        }
                    },
                    'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹': {
                        name: 'ì‹ ì²­ì„œì—°ì¥ì–‘ì‹',
                        type: 'normal',
                        outputType: 'single',
                        memo: '',
                        template: (info) => `${info.ê³ ê°ëª… || ''} / ${info.ì£¼ë¯¼ë²ˆí˜¸ || info.ìƒë…„ì›”ì¼ || ''} / ${info.ê°œí†µë²ˆí˜¸ || info.ì „í™”ë²ˆí˜¸ || ''}`
                    }
                }
            }
        };

        // ì´ë²¤íŠ¸ ê´€ë¦¬ í´ë˜ìŠ¤
        class EventManager {
            static init() {
                this.setupTelecomEvents();
                this.setupAgencyEvents();
                this.setupConversionEvents();
                this.setupCopyEvents();
            }

            static setupTelecomEvents() {
                const telecomSelect = document.getElementById('telecom');
                if (telecomSelect) {
                    telecomSelect.addEventListener('change', () => {
                        updateAgencies();
                        this.clearOutputs();
                    });
                }
            }

            static setupAgencyEvents() {
                const agencySelect = document.getElementById('agency');
                if (agencySelect) {
                    agencySelect.addEventListener('change', () => {
                        const agencyInfoBtn = document.getElementById('agencyInfoBtn');
                        if (agencyInfoBtn) {
                            agencyInfoBtn.disabled = !agencySelect.value;
                        }
                        this.clearOutputs();
                    });
                }
            }

            static setupConversionEvents() {
                const convertBtn = document.getElementById('convertBtn');
                if (convertBtn) {
                    convertBtn.addEventListener('click', () => {
                        convertFormat();
                    });
                }
            }

            static setupCopyEvents() {
                const copyBtn = document.getElementById('copyBtn');
                if (copyBtn) {
                    copyBtn.addEventListener('click', () => {
                        handleCopy();
                    });
                }
            }

            static clearOutputs() {
                OutputManager.hideAllContainers();
            }
        }

        // ... ê¸°ì¡´ ì½”ë“œ ...
        // ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬
        document.getElementById('excelFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = e.target.result;
                    const workbook = XLSX.read(data, {
                        type: 'binary',
                        cellDates: true,
                        cellNF: true,
                        cellText: false,
                        WTF: false
                    });
                    
                    // ì›Œí¬ë¶ ì •ë³´ ì¶œë ¥
                    console.log('=== ì—‘ì…€ íŒŒì¼ ë¶„ì„ ê²°ê³¼ ===');
                    console.log('ì›Œí¬ë¶ ì •ë³´:', {
                        'ì‹œíŠ¸ ì´ë¦„ë“¤': workbook.SheetNames,
                        'ì „ì²´ ì›Œí¬ë¶ ë°ì´í„°': workbook
                    });
                    
                    // ì²« ë²ˆì§¸ ì‹œíŠ¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    
                    // ì‹œíŠ¸ ë°ì´í„°ë¥¼ ë°°ì—´ë¡œ ë³€í™˜
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, {
                        header: 1,
                        raw: false,
                        defval: '',
                        blankrows: false
                    });
                    
                    // ì¤‘ìš” ì—´ ë°ì´í„° ì¶”ì¶œ (10ë²ˆ, 75ë²ˆ ì—´)
                    console.log('=== ì¤‘ìš” ì—´ ë°ì´í„° ë¶„ì„ ===');
                    
                    // í—¤ë” ì •ë³´ ì¶œë ¥
                    console.log('1. ì¤‘ìš” ì—´ í—¤ë” ì •ë³´:');
                    console.log('10ë²ˆ ì—´:', {
                        'í—¤ë”1': jsonData[0][9] || 'ë¹ˆ ê°’',  // 0-based indexì´ë¯€ë¡œ 9
                        'í—¤ë”2': jsonData[1][9] || 'ë¹ˆ ê°’'
                    });
                    console.log('75ë²ˆ ì—´:', {
                        'í—¤ë”1': jsonData[0][74] || 'ë¹ˆ ê°’',  // 0-based indexì´ë¯€ë¡œ 74
                        'í—¤ë”2': jsonData[1][74] || 'ë¹ˆ ê°’'
                    });
                    
                    // ì •ê·œì‹ íŒ¨í„´ ì •ì˜
                    const patterns = {
                        'ì „í™”ë²ˆí˜¸': /\*{1,2}(?:ì „í™”ë²ˆí˜¸|ê°œí†µë²ˆí˜¸)\s*[-\s:ï¼š]+\s*(010-\d{3,4}-\d{4})/,
                        'ëª¨ë¸ëª…': /\*{1,2}ëª¨ë¸ëª…\s*[-\s:ï¼š]+\s*([^*\n]+?)(?=\s+\*{1,2}|$)/,
                        'ìƒ‰ìƒ': /\*{1,2}ìƒ‰ìƒ\s*[-\s:ï¼š]+\s*([^\n\/]+?)(?=\s*\/|\s+\*{1,2}|$)/,
                        'ê³ ê°ëª…': /\*{1,2}ê³ ê°ëª…\s*[-\s:ï¼š]+\s*([^*\n\/]+?)(?=\s+\*{1,2}|$)/,
                        'ì£¼ë¯¼ë²ˆí˜¸': /\*{1,2}(?:ì£¼ë¯¼ë²ˆí˜¸|ìƒë…„ì›”ì¼)\s*[-\s:ï¼š]+\s*([^*\n\/]+?)(?=\s+\*{1,2}|$)/
                        //'ê°€ì…ìœ í˜•': /\*{1,2}ê°€ì…ìœ í˜•\s*[-\s:ï¼š]+\s*([^*\n\/]+?)(?=\s+\*{1,2}|$)/
                    };

                    // ì‹¤ì œ ë°ì´í„° ì¶”ì¶œ ë° ê°€ê³µ (3í–‰ë¶€í„°)
                    const extractedData = jsonData.slice(2)
                        .filter(row => row[74]) // 75ë²ˆ ì—´ì— ë°ì´í„°ê°€ ìˆëŠ” í–‰ë§Œ í•„í„°ë§
                        .map((row, index) => {
                            const text = row[74] || '';
                            const info = {};
                            
                            // ê° íŒ¨í„´ì— ë§ê²Œ ì •ë³´ ì¶”ì¶œ
                            Object.entries(patterns).forEach(([key, pattern]) => {
                                const match = text.match(pattern);
                                if (match && match[1]) {
                                    info[key] = match[1].trim();
                                }
                            });
                            
                            // ëª¨ë¸ëª… ë³€í™˜ ì ìš© (í«ë„¤ì„ â†’ ì‹¤ì œ ëª¨ë¸ëª…)
                            if (info['ëª¨ë¸ëª…']) {
                                const originalModelName = info['ëª¨ë¸ëª…'];
                                info['ëª¨ë¸ëª…'] = convertModelName(info['ëª¨ë¸ëª…']);
                                console.log(`ì—‘ì…€ ì²˜ë¦¬ - ëª¨ë¸ëª… ë³€í™˜: ${originalModelName} â†’ ${info['ëª¨ë¸ëª…']}`);
                            }
                            
                            // 10ë²ˆ ì—´ ë°ì´í„° ì²˜ë¦¬ (ë³´ìƒê¸°ë³€ -> ê¸°ê¸°ë³€ê²½)
                            const col10Value = row[9] === 'ë³´ìƒê¸°ë³€' ? 'ê¸°ê¸°ë³€ê²½' : (row[9] || '');
                            
                            // í…œí”Œë¦¿ í˜•ì‹ìœ¼ë¡œ ì¶œë ¥
                            const formattedResult = `${info['ê³ ê°ëª…'] || ''} / ${info['ì „í™”ë²ˆí˜¸'] || ''} / ${info['ì£¼ë¯¼ë²ˆí˜¸'] || ''} / ${info['ëª¨ë¸ëª…'] || ''} / ${info['ìƒ‰ìƒ'] || ''} / ${col10Value}`;
                            
                            return {
                                'í–‰ë²ˆí˜¸': index + 3,
                                'ì¶”ì¶œê²°ê³¼': formattedResult
                            };
                        });
                    
                    console.log('2. ì¶”ì¶œëœ ë°ì´í„°:', extractedData);
                    
                    // ë°ì´í„° ìš”ì•½
                    console.log('3. ë°ì´í„° ìš”ì•½:', {
                        'ì´ ë°ì´í„° í–‰ ìˆ˜': extractedData.length,
                        'ë¹ˆ ê°’ì´ ì•„ë‹Œ 10ë²ˆì—´ ë°ì´í„° ìˆ˜': extractedData.filter(row => row['10ë²ˆì—´']).length,
                        'ë¹ˆ ê°’ì´ ì•„ë‹Œ 75ë²ˆì—´ ë°ì´í„° ìˆ˜': extractedData.length
                    });
                    
                    // ì¶”ì¶œ ê²°ê³¼ë§Œ ë”°ë¡œ ì¶œë ¥
                    console.log('4. ì¶”ì¶œ ê²°ê³¼ ëª©ë¡:');
                    const outputText = extractedData.map(row => row['ì¶”ì¶œê²°ê³¼']).join('\n');
                    
                    // textareaì— ê²°ê³¼ ì¶œë ¥
                    document.getElementById('outputText').value = outputText;
                    
                    // ì¶”ì¶œ ê±´ìˆ˜ í‘œì‹œ
                    const extractCount = extractedData.length;
                    document.getElementById('extractCount').textContent = `${extractCount}ê±´ ì¶”ì¶œ ì™„ë£Œ`;
                    
                    // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                    alert('ì—‘ì…€ íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ë³€í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    
                } catch (error) {
                    console.error('ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                    alert('ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                }
            };
            
            reader.onerror = function(error) {
                console.error('íŒŒì¼ ì½ê¸° ì˜¤ë¥˜:', error);
                alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            };
            
            reader.readAsBinaryString(file);
        });

        // ìƒˆë¡œìš´ ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ë¡œì§ (ë°°ì†¡ìš”ì²­ ì–‘ì‹)
        document.getElementById('excelFile2').addEventListener('change', function(e) {
            // ëŒ€ë¦¬ì  ì„ íƒ ì—¬ë¶€ í™•ì¸
            const agencySelect = document.getElementById('agency');
            const selectedAgency = agencySelect ? agencySelect.value : '';
            
            if (!selectedAgency) {
                alert('ëŒ€ë¦¬ì ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”!');
                // íŒŒì¼ ì„ íƒ ì´ˆê¸°í™”
                e.target.value = '';
                return;
            }
            
            const file = e.target.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = e.target.result;
                    const workbook = XLSX.read(data, {
                        type: 'binary',
                        cellDates: true,
                        cellNF: true,
                        cellText: false,
                        WTF: false
                    });
                    
                    // ì›Œí¬ë¶ ì •ë³´ ì¶œë ¥
                    console.log('=== ìƒˆë¡œìš´ ì—‘ì…€ íŒŒì¼ ë¶„ì„ ê²°ê³¼ ===');
                    console.log('ì›Œí¬ë¶ ì •ë³´:', {
                        'ì‹œíŠ¸ ì´ë¦„ë“¤': workbook.SheetNames,
                        'ì „ì²´ ì›Œí¬ë¶ ë°ì´í„°': workbook
                    });
                    
                    // ì²« ë²ˆì§¸ ì‹œíŠ¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    
                    // ì‹œíŠ¸ ë°ì´í„°ë¥¼ ë°°ì—´ë¡œ ë³€í™˜
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, {
                        header: 1,
                        raw: false,
                        defval: '',
                        blankrows: false
                    });
                    
                    // ë°°ì†¡ìš”ì²­ ì–‘ì‹ ìƒì„±ì„ ìœ„í•œ ì²˜ë¦¬
                    console.log(`=== ${selectedAgency} ë°°ì†¡ìš”ì²­ ì–‘ì‹ ì²˜ë¦¬ ì¤‘ ===`);
                    console.log('ì „ì²´ ì‹œíŠ¸ ë°ì´í„°:', jsonData);
                    
                    // ì •ê·œì‹ íŒ¨í„´ ì •ì˜ (ë°°ì†¡ìš”ì²­ìš©ìœ¼ë¡œ ê°œì„ )
                    const deliveryPatterns = {
                        'ì „í™”ë²ˆí˜¸': /\*{1,2}(?:ì „í™”ë²ˆí˜¸|ê°œí†µë²ˆí˜¸)\s*[-\s:ï¼š]+\s*(010-\d{3,4}-\d{4})/,
                        'ëª¨ë¸ëª…': /\*{1,2}ëª¨ë¸ëª…\s*[-\s:ï¼š]+\s*([^*\n]+?)(?=\s+\*{1,2}|$)/,
                        'ìƒ‰ìƒ': /\*{1,2}ìƒ‰ìƒ\s*[-\s:ï¼š]+\s*([^\n\/]+?)(?=\s*\/|\s+\*{1,2}|$)/,
                        'ê³ ê°ëª…': /\*{1,2}ê³ ê°ëª…\s*[-\s:ï¼š]+\s*([^*\n\/]+?)(?=\s+\*{1,2}|$)/,
                        'ì£¼ë¯¼ë²ˆí˜¸': /\*{1,2}(?:ì£¼ë¯¼ë²ˆí˜¸|ìƒë…„ì›”ì¼)\s*[-\s:ï¼š]+\s*([^*\n\/]+?)(?=\s+\*{1,2}|$)/,
                        // íƒë°°ì£¼ì†Œì—ì„œ ì£¼ì†Œì™€ ì—°ë½ì²˜ë¥¼ ë¶„ë¦¬
                        'íƒë°°ì£¼ì†Œ': /\*{1,2}íƒ\s*ë°°\s*(?:ì£¼\s*ì†Œ|ì£¼\s*ì†Œ\s*ì§€)?\s*[-:ï¼š]\s*([^/]+?)(?=\s*\/\s*010-|\s+\*{1,2}|$)/i,
                        'íƒë°°ì—°ë½ì²˜': /\*{1,2}íƒ\s*ë°°\s*(?:ì£¼\s*ì†Œ|ì£¼\s*ì†Œ\s*ì§€)?\s*[-:ï¼š]\s*[^/]+?\s*\/\s*(010-\d{3,4}-\d{4})/i,
                        'ë°°ì†¡ì£¼ì†Œì§€': /\*{1,2}(?:íƒ\s*ë°°|ë°°\s*ì†¡)\s*(?:ì£¼\s*ì†Œ|ì£¼\s*ì†Œ\s*ì§€)?\s*[-:ï¼š]\s*([^/]+?)(?=\s*\/\s*010-|\s+\*{1,2}|$)/i,
                        'ë°°ì†¡ì—°ë½ì²˜': /\*{1,2}(?:íƒ\s*ë°°|ë°°\s*ì†¡)\s*(?:ì£¼\s*ì†Œ|ì£¼\s*ì†Œ\s*ì§€)?\s*[-:ï¼š]\s*[^/]+?\s*\/\s*(010-\d{3,4}-\d{4})/i
                    };

                    // ë°°ì†¡ìš”ì²­ ë°ì´í„° ì¶”ì¶œ ë° ê°€ê³µ (2í–‰ë¶€í„° - í—¤ë” 1í–‰ ì œì™¸)
                    const processedData = jsonData.slice(2) // 3í–‰ë¶€í„° ì‹œì‘ (í—¤ë” 2í–‰ ì œì™¸)
                        .filter(row => row[74]) // 75ë²ˆ ì—´ì— ë°ì´í„°ê°€ ìˆëŠ” í–‰ë§Œ í•„í„°ë§
                        .map((row, index) => {
                            const text = row[74] || '';
                            const info = {};
                            
                            // ê° íŒ¨í„´ì— ë§ê²Œ ì •ë³´ ì¶”ì¶œ
                            Object.entries(deliveryPatterns).forEach(([key, pattern]) => {
                                const match = text.match(pattern);
                                if (match && match[1]) {
                                    info[key] = match[1].trim();
                                }
                            });
                            
                            // ëª¨ë¸ëª… ë³€í™˜ ì ìš© (í«ë„¤ì„ â†’ ì‹¤ì œ ëª¨ë¸ëª…)
                            if (info['ëª¨ë¸ëª…']) {
                                const originalModelName = info['ëª¨ë¸ëª…'];
                                info['ëª¨ë¸ëª…'] = convertModelName(info['ëª¨ë¸ëª…']);
                                console.log(`${selectedAgency} ë°°ì†¡ ì²˜ë¦¬ - ëª¨ë¸ëª… ë³€í™˜: ${originalModelName} â†’ ${info['ëª¨ë¸ëª…']}`);
                            }
                            
                            // íƒë°°ì£¼ì†Œì™€ ë°°ì†¡ì£¼ì†Œì§€, ì—°ë½ì²˜ í†µí•© ì²˜ë¦¬
                            const address = info['íƒë°°ì£¼ì†Œ'] || info['ë°°ì†¡ì£¼ì†Œì§€'] || '';
                            const deliveryContact = info['íƒë°°ì—°ë½ì²˜'] || info['ë°°ì†¡ì—°ë½ì²˜'] || '';
                            
                            // ëŒ€ë¦¬ì ë³„ ë°°ì†¡ìš”ì²­ ì–‘ì‹ ì ìš©
                            let formattedResult = '';
                            
                            if (selectedAgency === 'ë‚˜í…”') {
                                // ë‚˜í…” ë°°ì†¡ìš”ì²­ ì–‘ì‹: ê³ ê°ëª…/ì£¼ì†Œ/ë°°ì†¡ì—°ë½ì²˜/ëª¨ë¸ëª…/ìƒ‰ìƒ
                                formattedResult = `${info['ê³ ê°ëª…'] || ''}/${address.trim()}/${deliveryContact}/${info['ëª¨ë¸ëª…'] || ''}/${info['ìƒ‰ìƒ'] || ''}`;
                            } else {
                                // ê¸°ë³¸ ì–‘ì‹ (ë‹¤ë¥¸ ëŒ€ë¦¬ì ìš©)
                                formattedResult = `${info['ê³ ê°ëª…'] || ''} / ${info['ì „í™”ë²ˆí˜¸'] || ''} / ${info['ëª¨ë¸ëª…'] || ''} / ${info['ìƒ‰ìƒ'] || ''} / ${address}`;
                            }
                            
                            return formattedResult;
                        })
                        .filter(result => result.trim()); // ë¹ˆ ê²°ê³¼ ì œì™¸
                    
                    // ê²°ê³¼ë¥¼ textareaì— ì¶œë ¥
                    document.getElementById('outputText').value = processedData.join('\n');
                    
                    // ì¶”ì¶œ ê±´ìˆ˜ í‘œì‹œ (ëŒ€ë¦¬ì ë³„ë¡œ í‘œì‹œ)
                    const extractCount = processedData.length;
                    document.getElementById('extractCount2').textContent = `${extractCount}ê±´ ${selectedAgency} ë°°ì†¡ìš”ì²­ ì–‘ì‹ìœ¼ë¡œ ì²˜ë¦¬ ì™„ë£Œ`;
                    
                    // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                    alert(`${selectedAgency} ë°°ì†¡ìš”ì²­ ì–‘ì‹ìœ¼ë¡œ ì—‘ì…€ íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    
                } catch (error) {
                    console.error('ìƒˆë¡œìš´ ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                    alert('ìƒˆë¡œìš´ ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                }
            };
            
            reader.onerror = function(error) {
                console.error('íŒŒì¼ ì½ê¸° ì˜¤ë¥˜:', error);
                alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            };
            
            reader.readAsBinaryString(file);
        });

        // ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ê¸°ëŠ¥
        const CORRECT_PASSWORD = '5577'; // ì›í•˜ëŠ” 4ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½í•˜ì„¸ìš”

        function checkPassword() {
            const inputPassword = document.getElementById('passwordInput').value;
            const errorDiv = document.getElementById('passwordError');
            
            if (inputPassword.length !== 4) {
                showPasswordError('4ìë¦¬ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (inputPassword === CORRECT_PASSWORD) {
                // ë¹„ë°€ë²ˆí˜¸ê°€ ë§ìœ¼ë©´ ëª¨ë‹¬ ìˆ¨ê¸°ê³  ë©”ì¸ ì½˜í…ì¸  í‘œì‹œ
                document.getElementById('passwordModal').style.display = 'none';
                document.querySelector('.main-content').style.display = 'block';
                
                // í˜ì´ì§€ ì´ˆê¸°í™” í•¨ìˆ˜ í˜¸ì¶œ (ê¸°ì¡´ì— ìˆë‹¤ë©´)
                if (typeof initializePage === 'function') {
                    initializePage();
                }
            } else {
                showPasswordError('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }

        function showPasswordError(message) {
            const errorDiv = document.getElementById('passwordError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™” ë° í¬ì»¤ìŠ¤
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordInput').focus();
            
            // 3ì´ˆ í›„ ì—ëŸ¬ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 3000);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤
        window.addEventListener('load', function() {
            document.getElementById('passwordInput').focus();
        });

        // Enter í‚¤ë¡œ ë¹„ë°€ë²ˆí˜¸ í™•ì¸
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkPassword();
            }
        });

        // ìˆ«ìë§Œ ì…ë ¥ ê°€ëŠ¥í•˜ë„ë¡ ì œí•œ + 4ìë¦¬ ì…ë ¥ ì‹œ ìë™ í™•ì¸
        document.getElementById('passwordInput').addEventListener('input', function(e) {
            const value = e.target.value;
            const numericValue = value.replace(/[^0-9]/g, '');
            if (value !== numericValue) {
                e.target.value = numericValue;
            }
            
            // 4ìë¦¬ê°€ ì…ë ¥ë˜ë©´ ìë™ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ í™•ì¸
            if (numericValue.length === 4) {
                setTimeout(() => {
                    checkPassword();
                }, 100); // ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ì–´ UI ì—…ë°ì´íŠ¸ í›„ ì‹¤í–‰
            }
        });
    </script>
    </div> <!-- main-content ë‹«ëŠ” íƒœê·¸ -->
</body>
</html>

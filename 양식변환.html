<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—…ë¬´ ë„ìš°ë¯¸</title>
    <!-- SheetJS ìŠ¤íƒ€ì¼ë§ ì§€ì› ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
    <!-- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ -->
    <script src="js/utils.js"></script>
    <!-- ì—‘ì…€ ê´€ë¦¬ ëª¨ë“ˆ -->
    <script src="js/excel-manager.js"></script>
    <!-- ëŒ€ë¦¬ì  ì„¤ì • ë°ì´í„° -->
    <script src="js/agencies-config.js"></script>
    <!-- ì•± ì„¤ì • ë°ì´í„° (ì‚¬ì´íŠ¸, ìƒìˆ˜ ë“±) -->
    <script src="js/app-config.js"></script>
    <!-- í…œí”Œë¦¿ ì„¤ì • ë°ì´í„° (TELECOM_CONFIG) -->
    <script src="js/templates-config.js"></script>
    <style>
        /* ëª¨ë¸ ê²€ìƒ‰ ê²°ê³¼ ìŠ¤íƒ€ì¼ */
        .model-result:hover {
            background-color: #f5f5f5;
        }

        /* ê²€ìƒ‰ ê²°ê³¼ ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        #modelSearchResults::-webkit-scrollbar {
            width: 8px;
        }

        #modelSearchResults::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        #modelSearchResults::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        #modelSearchResults::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Toast Notification Styles */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
            font-size: 14px;
            font-weight: 500;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }

        .layout-container {
            display: flex;
            gap: 20px;
        }

        .input-column {
            flex: 1;
        }

        .output-column {
            flex: 1;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        select, textarea, input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        select {
            background-color: white;
            cursor: pointer;
        }

        textarea {
            resize: vertical;
        }

        .input-textarea {
            min-height: 300px;
        }

        .output-textarea {
            min-height: 300px;
        }
        
        /* ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ ì „ìš© textarea ìŠ¤íƒ€ì¼ */
        .drblack-request-textarea {
            min-height: 150px;  /* ê¸°ì¡´ ë†’ì´ì˜ ì ˆë°˜ */
            height: 150px;      /* ê³ ì • ë†’ì´ ì„¤ì • */
            resize: vertical;   /* ì„¸ë¡œ í¬ê¸° ì¡°ì ˆë§Œ ê°€ëŠ¥í•˜ë„ë¡ */
        }

        /* ì˜¤ì•¤í‹° ì‹ ì¡°ìš”ì²­ ì „ìš© textarea ìŠ¤íƒ€ì¼ */
        #ontRequestText {
            height: 120px !important;
            min-height: 120px;
            resize: vertical;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #convertBtn {
            background-color: #4CAF50;
            color: white;
            flex: 2;
        }

        #convertBtn:hover {
            background-color: #45a049;
        }

        #copyBtn {
            background-color: #2196F3;
            color: white;
            flex: 1;
        }

        #copyBtn:hover {
            background-color: #0b7dda;
        }

        #clearBtn {
            background-color: #f44336;
            color: white;
            flex: 1;
        }

        #clearBtn:hover {
            background-color: #d32f2f;
        }

        #outputText {
            background-color: #f9f9f9;
        }

        .output-section {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .output-section h3 {
            margin-bottom: 10px;
            color: #333;
        }
        
        /* URL ì„ íƒë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .url-container {
            margin-bottom: 20px;
            width: 50%;
            margin-right: auto;
            margin-left: 0;
        }
        
        .url-select {
            width: auto;
            min-width: 200px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            background-color: #f8f9fa;
            cursor: pointer;
        }
        
        /* ëŒ€ë¦¬ì  ë©”ëª¨ íŒì—… ìŠ¤íƒ€ì¼ */
        .info-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 14px;
            cursor: pointer;
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
        }
        
        .info-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .popup-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        /* ì´ë ¥ ëª©ë¡ ìŠ¤íƒ€ì¼ */
        .history-list {
            margin: 10px 0;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .history-item {
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .history-item:hover {
            background-color: #f5f5f5;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .history-name {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .history-phone {
            color: #555;
            flex-grow: 1;
        }
        
        .history-time {
            color: #888;
            font-size: 0.9em;
        }
        
        .history-details {
            margin: 5px 0;
            color: #333;
        }
        
        .history-model {
            display: inline-block;
            margin-right: 10px;
        }
        
        .history-plan {
            color: #2c7be5;
        }
        
        .history-footer {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            color: #666;
        }
        
        .no-history {
            text-align: center;
            padding: 20px;
            color: #888;
        }
        
        .history-actions {
            text-align: right;
            margin-top: 15px;
        }
        
        .btn-clear-history {
            background-color: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .btn-clear-history:hover {
            background-color: #cc0000;
        }
        
        .popup-close {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }
        
        .popup-title {
            margin-top: 0;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .memo-content {
            white-space: pre-line;
            line-height: 1.5;
        }
        
        /* í‚¤-ê°’ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .key-value-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }
        
        .key-value-table th {
            background-color: #f5f5f5;
            padding: 6px 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #ddd;
            width: 30%;
            font-size: 12px;
        }
        
        .key-value-table td {
            padding: 5px 8px;
            border: 1px solid #ddd;
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s;
            font-size: 13px;
            line-height: 1.3;
        }
        
        .key-value-table td:hover {
            background-color: #f0f8ff;
        }
        
        .key-value-table td::after {
            content: "í´ë¦­í•˜ì—¬ ë³µì‚¬";
            position: absolute;
            right: 8px;
            color: #999;
            font-size: 10px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .key-value-table td:hover::after {
            opacity: 1;
        }
        
        .key-value-table td.copied {
            background-color: #e6ffe6;
        }
        
        .key-value-table td.copied::after {
            content: "ë³µì‚¬ë¨!";
            color: #4CAF50;
            opacity: 1;
            font-size: 10px;
        }
        
        .copy-notice {
            text-align: center;
            margin-bottom: 10px;
            color: #666;
            font-style: italic;
            font-size: 12px;
        }

        @media (max-width: 900px) {
            .layout-container {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }

        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ */
        .output-textarea {
            width: 100%;
            min-height: 200px;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: 'Nanum Gothic', sans-serif;
            font-size: 14px;
            resize: vertical;
        }
        
        /* ACT íƒë°°ìš© ì‘ì€ textarea */
        .act-stock-textarea {
            min-height: 100px !important;
            height: 100px !important;
        }

        /* ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        #passwordModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .password-modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            text-align: center;
            min-width: 300px;
        }

        .password-modal-content h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .password-input {
            width: 200px;
            padding: 15px;
            font-size: 18px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
            letter-spacing: 3px;
        }

        .password-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .password-submit {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }

        .password-submit:hover {
            background-color: #45a049;
        }

        .password-error {
            color: #f44336;
            margin-top: 10px;
            font-size: 14px;
        }

        .main-content {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ëª¨ë‹¬ -->
    <div id="passwordModal">
        <div class="password-modal-content">
            <h2>ğŸ”’ ì ‘ê·¼ ì¸ì¦</h2>
            <p>4ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
            <input type="password" id="passwordInput" class="password-input" maxlength="4" placeholder="****" autocomplete="off">
            <br>
            <button onclick="checkPassword()" class="password-submit">í™•ì¸</button>
            <div id="passwordError" class="password-error" style="display: none;"></div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="main-content">
    <div class="container">
        <h1>í•œê²°ì´ ì—…ë¬´ ë„ìš°ë¯¸</h1>
        
        <div class="url-container" style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; flex-wrap: nowrap; width: 100%;">
            <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                <label for="usefulUrls" style="font-size: 14px; color: #555;">ìœ ìš©í•œ ì‚¬ì´íŠ¸:</label>
                <select id="usefulUrls" onchange="openSelectedUrl()" style="min-width: 200px; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <!-- ì‚¬ì´íŠ¸ ëª©ë¡ì€ ì´ê³³ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </select>
            </div>
            
                          <div style="display: flex; flex-direction: column; gap: 8px; margin-left: 20px;">
                  <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                      <label for="excelFile" style="font-size: 14px; color: #555;">ì–´ë“œë¯¼ ì—‘ì…€ ì²¨ë¶€ë¡œ ì ‘ìˆ˜í™•ì¸/ì‹ ì¡°ìš”ì²­ ì–‘ì‹ ë§Œë“¤ê¸°:</label>
                      <input type="file" id="excelFile" accept=".xlsx, .xls" style="font-size: 14px;"/>
                      <span id="extractCount" style="font-size: 14px; color: #2196F3; margin-left: 10px; font-weight: bold;"></span>
                  </div>
                  <div style="display: flex; flex-direction: column; gap: 5px;">
                      <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                          <label for="excelFile2" style="font-size: 14px; color: #555;">ì–´ë“œë¯¼ ì—‘ì…€ ì²¨ë¶€ë¡œ ëŒ€ë¦¬ì ë³„ ë°°ì†¡ìš”ì²­ ì—‘ì…€ ìƒì„±(ëŒ€ë¦¬ì  ë¨¼ì € ì„ íƒ í•„ìˆ˜)</label>
                          <input type="file" id="excelFile2" accept=".xlsx, .xls" style="font-size: 14px;"/>
                          <span id="extractCount2" style="font-size: 14px; color: #e91e63; margin-left: 10px; font-weight: bold;"></span>
                      </div>
                      <div style="margin-left: 5px;">
                          <button id="downloadDeliveryBtn" onclick="downloadDeliveryExcel()" style="display: none; background-color: #4CAF50; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">ë°°ì†¡ìš”ì²­ì–‘ì‹ ë‹¤ìš´ë¡œë“œ</button>
                      </div>
                  </div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap; margin-left: auto;">
                <label for="modelSearch" style="font-size: 14px; color: #555;">ëª¨ë¸ ê²€ìƒ‰:</label>
                <div style="position: relative; min-width: 250px;">
                    <input type="text" id="modelSearch" 
                           placeholder="ì˜ˆ: S24, ì•„ì´í°" 
                           style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                    <div id="modelSearchResults" style="display: none; position: absolute; top: 100%; left: 0; right: 0; 
                          background: white; border: 1px solid #ddd; border-radius: 4px; max-height: 300px; 
                          overflow-y: auto; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="layout-container">
            <!-- ì…ë ¥ ì»¨í…Œì´ë„ˆ (ì™¼ìª½ ì˜ì—­) -->
            <div class="input-column">
                <div class="form-row">
                    <div class="form-group">
                        <label for="telecom">í†µì‹ ì‚¬ ì„ íƒ:</label>
                        <select id="telecom" onchange="updateAgencies()">
                            <option value="">í†µì‹ ì‚¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="SK">SK</option>
                            <option value="KT">KT</option>
                            <option value="LG">LG</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="agency">ëŒ€ë¦¬ì  ì„ íƒ:</label>
                        <div style="display: flex; align-items: center;">
                            <select id="agency" disabled>
                                <option value="">ëŒ€ë¦¬ì ì„ ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                            <button type="button" id="agencyInfoBtn" class="info-button" onclick="showAgencyInfo()" disabled>i</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="deviceSerial">ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸:</label>
                        <input type="text" id="deviceSerial" class="form-control" placeholder="ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div class="form-group">
                        <label for="simSerial">ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸:</label>
                        <input type="text" id="simSerial" class="form-control" placeholder="ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="inputText">ì›ë³¸ í…ìŠ¤íŠ¸:</label>
                    <textarea id="inputText" class="input-textarea" placeholder="ì—¬ê¸°ì— ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                
                <div class="button-group">
                    <button id="convertBtn" onclick="convertFormat()">ë³€í™˜í•˜ê¸°</button>
                    <button id="historyBtn" onclick="openHistoryPopup()">ë³€í™˜ë‚´ì—­ì¡°íšŒ</button>
                    <button id="clearBtn" onclick="clearAll()">ëª¨ë‘ ì§€ìš°ê¸°</button>
                </div>
            </div>
            
            <!-- ì¶œë ¥ ì»¨í…Œì´ë„ˆ (ì˜¤ë¥¸ìª½ ì˜ì—­) -->
            <div class="output-column">
                <div id="outputContainer" style="display: block;">
                    <!-- ëŸ­ìŠ¤ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ/ìš°ì£¼íŒ¨ìŠ¤) -->
                    <div id="luxExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="luxRequestText">ëŸ­ìŠ¤ ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxStockText">ëŸ­ìŠ¤ ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxMemoText">ëŸ­ìŠ¤ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxUniverseText">ëŸ­ìŠ¤ ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹:</label>
                            <textarea id="luxUniverseText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- íë¸Œ ì „ìš© ì¶”ê°€ textarea (ì¬ê³ /ê°œí†µ/ìš°ì£¼íŒ¨ìŠ¤) -->
                    <div id="cubeExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="cubeStockText">íë¸Œ ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="cubeStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="cubeOpenText">íë¸Œ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="cubeOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="cubeUniverseText">íë¸Œ ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹:</label>
                            <textarea id="cubeUniverseText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë“œë¸”ë™ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ) -->
                    <div id="dblackExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="dblackRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    <style>
                        #luxRequestText {
                            height: 130px !important;
                            min-height: 130px;
                            resize: vertical;
                        }
                        #luxStockText {
                            height: 110px !important;
                            min-height: 110px;
                            resize: vertical;
                        }
                        #luxMemoText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #luxUniverseText {
                            height: 120px !important;
                            min-height: 120px;
                            resize: vertical;
                        }
                        
                        /* íë¸Œ textarea ìŠ¤íƒ€ì¼ */
                        #cubeStockText {
                            height: 130px !important;
                            min-height: 130px;
                            resize: vertical;
                        }
                        #cubeOpenText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #cubeUniverseText {
                            height: 120px !important;
                            min-height: 120px;
                            resize: vertical;
                        }
                        /* ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ textarea ìŠ¤íƒ€ì¼ */
                        #dblackRequestText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #outputText1 {
                            height: 170px !important;
                            min-height: 170px;
                        }
                        
                        /* íœ´ë„· textarea ìŠ¤íƒ€ì¼ */
                        #hunetConfirmText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #hunetDeliveryText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #hunetOpenText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        
                        /* ë°€ë¦¬ì–¸ textarea ìŠ¤íƒ€ì¼ */
                        #millionRequestText {
                            height: 100px !important;
                            min-height: 100px;
                            resize: vertical;
                        }
                        
                        /* ë°€ë¦¬ì–¸ ë°°ì •ìš”ì²­ textarea ìŠ¤íƒ€ì¼ (ì ˆë°˜ í¬ê¸°) */
                        #millionStockText {
                            height: 100px !important;
                            min-height: 100px;
                            resize: vertical;
                        }
                        
                        /* í•œì˜¬ ì ‘ìˆ˜í™•ì¸ textarea ìŠ¤íƒ€ì¼ (ì ˆë°˜ í¬ê¸°) */
                        #hanolConfirmText {
                            height: 70px !important;
                            min-height: 70px;
                            resize: vertical;
                        }
                    </style>
                    <div id="singleOutputContainer">
                        <div class="form-group">
                            <label id="outputTextLabel" for="outputText">ë³€í™˜ëœ í…ìŠ¤íŠ¸:</label>
                            <textarea id="outputText" class="output-textarea"></textarea>
                        </div>
                    </div>
                    
                    <div id="splitOutputContainer" style="display: none;">
                    </div>
                    
                    <!-- ACT(íƒë°°) ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸/ê°œí†µìš”ì²­) -->
                    <div id="actExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="actStockText">ACT(íƒë°°) ì ‘ìˆ˜í™•ì¸ì–‘ì‹:</label>
                            <textarea id="actStockText" class="output-textarea compact-textarea act-stock-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="actOpenText">ACT(íƒë°°) ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="actOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë¹„ì•¤ì»´ ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸&ì‹ ì¡°ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="bncomExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="bncomStockText">ë¹„ì•¤ì»´ ì ‘ìˆ˜í™•ì¸&ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="bncomStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="bncomOpenText">ë¹„ì•¤ì»´ ê°œí†µìš”ì²­:</label>
                            <textarea id="bncomOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- íœ´ë„· ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸/ë°°ì†¡ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="hunetExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="hunetConfirmText">íœ´ë„· ì ‘ìˆ˜í™•ì¸ì–‘ì‹:</label>
                            <textarea id="hunetConfirmText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hunetDeliveryText">íœ´ë„· ë°°ì†¡ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hunetDeliveryText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hunetOpenText">íœ´ë„· ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hunetOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë°€ë¦¬ì–¸ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°ìš”ì²­/ë°°ì •ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="millionExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="millionRequestText">ë°€ë¦¬ì–¸ ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="millionRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="millionStockText">ë°€ë¦¬ì–¸ ë°°ì •ìš”ì²­:</label>
                            <textarea id="millionStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="millionMemoText">ë°€ë¦¬ì–¸ ê°œí†µìš”ì²­:</label>
                            <textarea id="millionMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ì˜¤ì•¤í‹° ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°ìš”ì²­/ë°°ì •ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="ontExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="ontRequestText">ì˜¤ì•¤í‹° ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="ontRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="ontStockText">ì˜¤ì•¤í‹° ë°°ì •ìš”ì²­:</label>
                            <textarea id="ontStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="ontMemoText">ì˜¤ì•¤í‹° ê°œí†µìš”ì²­:</label>
                            <textarea id="ontMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ì¥ì²œ ì „ìš© ì¶”ê°€ textarea (ë°°ì†¡ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="jangcheonExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="jangcheonDeliveryText">ì¥ì²œ ë°°ì†¡ìš”ì²­:</label>
                            <textarea id="jangcheonDeliveryText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="jangcheonOpenText">ì¥ì²œ ê°œí†µìš”ì²­:</label>
                            <textarea id="jangcheonOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- í•œì˜¬ ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸/ë°°ì†¡ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="hanolExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="hanolConfirmText">í•œì˜¬ ì ‘ìˆ˜í™•ì¸ì–‘ì‹:</label>
                            <textarea id="hanolConfirmText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hanolDeliveryText">í•œì˜¬ ë°°ì†¡ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hanolDeliveryText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hanolOpenText">í•œì˜¬ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hanolOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <div id="keyValueTableContainer" style="display: none;">
                        <div class="copy-notice">ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.</div>
                        <table class="key-value-table" id="keyValueTable">
                            <tbody>
                                <!-- í‚¤-ê°’ í–‰ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- ì–‘ì‹ì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš°ë¥¼ ìœ„í•œ í…œí”Œë¦¿ -->
                <div id="splitOutputTemplate" style="display: none;">
                    <div class="output-section">
                        <h3>ì¬ê³ ìš”ì²­:</h3>
                        <textarea id="outputText1" class="output-textarea"></textarea>
                    </div>
                    <div class="output-section">
                        <h3>ê°œí†µìš”ì²­:</h3>
                        <textarea id="outputText2" class="output-textarea"></textarea>
                    </div>
                </div>
                
                <!-- í‚¤-ê°’ í…Œì´ë¸” í…œí”Œë¦¿ -->
                <div id="keyValueTableTemplate" style="display: none;">
                    <div class="copy-notice">ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.</div>
                    <table class="key-value-table" id="keyValueTable">
                        <tbody>
                            <!-- í‚¤-ê°’ í–‰ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast">í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
    
    <!-- ë³€í™˜ ì´ë ¥ íŒì—… -->
    <div id="historyPopup" class="popup-overlay">
        <div class="popup-content" style="max-width: 800px;">
            <span class="popup-close" onclick="closeHistoryPopup()">&times;</span>
            <h3 class="popup-title">ë³€í™˜ ì´ë ¥</h3>
            <div id="historyList" class="history-list">
                <!-- ì´ë ¥ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            <div class="history-actions">
                <button onclick="clearHistory()" class="btn-clear-history">ì „ì²´ ì‚­ì œ</button>
            </div>
        </div>
    </div>
    
    <!-- ëŒ€ë¦¬ì  ë©”ëª¨ íŒì—… -->
    <div id="memoPopup" class="popup-overlay">
        <div class="popup-content">
            <span class="popup-close" onclick="closeAgencyInfo()">&times;</span>
            <h3 class="popup-title" id="popupTitle">ëŒ€ë¦¬ì  ì—…ë¬´ ë©”ëª¨</h3>
            <div class="memo-content" id="memoContent"></div>
        </div>
    </div>
    
    <script>
        // í…œí”Œë¦¿ ê´€ë¦¬ í´ë˜ìŠ¤
        class TemplateManager {
            static getTemplate(telecom, agency) {
                const agencyConfig = TELECOM_CONFIG[telecom]?.agencies[agency];
                if (!agencyConfig) return null;
                
                return agencyConfig.templates || agencyConfig.template;
            }

            static applyTemplate(telecom, agency, customerInfo) {
                const template = this.getTemplate(telecom, agency);
                if (!template) throw new Error('í…œí”Œë¦¿ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');

                const agencyConfig = TELECOM_CONFIG[telecom].agencies[agency];
                
                switch(agencyConfig.outputType) {
                    case 'split':
                        return {
                            stockRequest: template.stockRequest(customerInfo),
                            openRequest: template.openRequest(customerInfo)
                        };
                    case 'multi':
                        // íœ´ë„·ê³¼ ì˜¤ì•¤í‹°ì˜ ê²½ìš° íŠ¹ë³„í•œ ì²˜ë¦¬
                        if (agency === 'ì œì´/íœ´ë„·') {
                            return {
                                confirm: template.confirm(customerInfo),
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else if (agency === 'ì˜¤ì•¤í‹°') {
                            return {
                                request: template.request(customerInfo),
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else if (agency === 'ì¥ì²œ') {
                            return {
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else if (agency === 'ëŸ­ìŠ¤') {
                            return {
                                request: template.request(customerInfo),
                                stock: template.delivery(customerInfo),  // ë°°ì†¡/ì¬ê³  ìš”ì²­ì„œë¥¼ ì¬ê³ ìš”ì²­ì–‘ì‹ìœ¼ë¡œ
                                open: template.open(customerInfo),       // ê°œí†µìš”ì²­ì–‘ì‹
                                universe: template.universe(customerInfo) // ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹
                            };
                        } else if (agency === 'íë¸Œ') {
                            return {
                                stock: template.stockRequest(customerInfo),   // ì¬ê³ ìš”ì²­
                                open: template.openRequest(customerInfo),     // ê°œí†µìš”ì²­
                                universe: template.universe(customerInfo)     // ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹
                            };
                        } else if (agency === 'í•œì˜¬') {
                            return {
                                confirm: template.confirm(customerInfo),   // ì ‘ìˆ˜í™•ì¸ì–‘ì‹
                                delivery: template.delivery(customerInfo), // ë°°ì†¡ìš”ì²­ì–‘ì‹
                                open: template.open(customerInfo)          // ê°œí†µìš”ì²­ì–‘ì‹
                            };
                    } else {
                            return {
                                request: template.request(customerInfo),
                                stock: template.stock(customerInfo),
                                memo: template.memo(customerInfo)
                            };
                        }
                    case 'table':
                        return template(customerInfo);
                    default:
                        return template(customerInfo);
                }
            }
        }

        // ì¶œë ¥ ê´€ë¦¬ í´ë˜ìŠ¤
        class OutputManager {
            static showOutput(result, outputType, telecom, agency) {
                // ëª¨ë“  ì¶œë ¥ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
                this.hideAllContainers();
                
                switch(outputType) {
                    case 'split':
                        this.showSplitOutput(result);
                        break;
                    case 'multi':
                        this.showMultiOutput(result, agency);
                        break;
                    case 'table':
                        this.showTableOutput(result);
                        break;
                    default:
                        this.showSingleOutput(result);
                }
            }

            static hideAllContainers() {
                const containers = [
                    'luxExtraOutputs',
                    'dblackExtraOutputs',
                    'singleOutputContainer',
                    'splitOutputContainer',
                    'keyValueTableContainer',
                    'actExtraOutputs',
                    'bncomExtraOutputs',
                    'hunetExtraOutputs',
                    'millionExtraOutputs',
                    'ontExtraOutputs',
                    'jangcheonExtraOutputs',
                    'hanolExtraOutputs'
                ];
                
                containers.forEach(id => {
                    const container = document.getElementById(id);
                    if (container) container.style.display = 'none';
                });
                
                // íë¸Œ ì»¨í…Œì´ë„ˆë„ ìˆ¨ê¸°ê¸°
                const cubeContainer = document.getElementById('cubeExtraOutputs');
                if (cubeContainer) cubeContainer.style.display = 'none';
                
                // ì¶”ê°€ í…ìŠ¤íŠ¸ div ì œê±°
                const additionalTextDiv = document.getElementById('additionalTextDiv');
                if (additionalTextDiv) {
                    additionalTextDiv.remove();
                }
            }

            static showSplitOutput(result) {
                const container = document.getElementById('splitOutputContainer');
                if (!container) return;

                // í˜„ì¬ ì„ íƒëœ ëŒ€ë¦¬ì  ê°€ì ¸ì˜¤ê¸°
                const agencySelect = document.getElementById('agency');
                const selectedAgency = agencySelect ? agencySelect.value : '';

                // ì¹´íŒŒ, ì‚¼ë³´(ì˜¨ë¼ì¸), ì´ì•¤í‹°ì¼ ë•Œ íŠ¹ë³„ ë¼ë²¨ ì‚¬ìš©
                let firstLabel = 'ì ‘ìˆ˜í™•ì¸';
                if (selectedAgency === 'ì¹´íŒŒ') {
                    firstLabel = 'ë°°ì†¡ìš”ì²­';
                } else if (selectedAgency === 'ì‚¼ë³´(ì˜¨ë¼ì¸)') {
                    firstLabel = 'ì¬ê³ ìš”ì²­';
                } else if (selectedAgency === 'ì´ì•¤í‹°') {
                    firstLabel = 'ë°°ì†¡ìš”ì²­';
                }

                container.style.display = 'block';
                container.innerHTML = `
                    <div class="form-group">
                        <label for="outputText1">${selectedAgency} ${firstLabel}:</label>
                        <textarea id="outputText1" class="output-textarea">${result.stockRequest || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="outputText2">${selectedAgency} ê°œí†µìš”ì²­:</label>
                        <textarea id="outputText2" class="output-textarea">${result.openRequest || ''}</textarea>
                    </div>
                `;
            }

            static showMultiOutput(result, agency) {
                let container;
                
                // ëŒ€ë¦¬ì ì— ë”°ë¥¸ ì»¨í…Œì´ë„ˆ ì„ íƒ
                if (agency === 'ë“œë¸”ë™') {
                    container = document.getElementById('dblackExtraOutputs');
                } else if (agency === 'ì œì´/íœ´ë„·') {
                    container = document.getElementById('hunetExtraOutputs');
                } else if (agency === 'ë°€ë¦¬ì–¸') {
                    container = document.getElementById('millionExtraOutputs');
                } else if (agency === 'ì˜¤ì•¤í‹°') {
                    container = document.getElementById('ontExtraOutputs');
                } else if (agency === 'ì¥ì²œ') {
                    container = document.getElementById('jangcheonExtraOutputs');
                } else if (agency === 'í•œì˜¬') {
                    container = document.getElementById('hanolExtraOutputs');
                } else if (agency === 'ëŸ­ìŠ¤') {
                    container = document.getElementById('luxExtraOutputs');
                } else if (agency === 'íë¸Œ') {
                    container = document.getElementById('cubeExtraOutputs');
                    } else {
                    container = document.getElementById('luxExtraOutputs');
                }
                
                if (!container) return;
                container.style.display = 'block';

                if (agency === 'ë“œë¸”ë™') {
                    // ë“œë¸”ë™ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    container.innerHTML = `
                        <div class="form-group">
                            <label for="dblackRequestText">ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackRequestText" class="output-textarea compact-textarea">${result.request || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackStockText">ë“œë¸”ë™ ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackStockText" class="output-textarea compact-textarea">${result.stock || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackMemoText">ë“œë¸”ë™ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackMemoText" class="output-textarea compact-textarea">${result.memo || ''}</textarea>
                        </div>
                    `;
                } else if (agency === 'ì œì´/íœ´ë„·') {
                    // íœ´ë„· ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (3ê°œ textarea)
                    const confirmText = document.getElementById('hunetConfirmText');
                    const deliveryText = document.getElementById('hunetDeliveryText');
                    const openText = document.getElementById('hunetOpenText');
                    
                    if (confirmText) confirmText.value = result.confirm || '';
                    if (deliveryText) deliveryText.value = result.delivery || '';
                    if (openText) openText.value = result.open || '';
                } else if (agency === 'ë°€ë¦¬ì–¸') {
                    // ë°€ë¦¬ì–¸ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const requestText = document.getElementById('millionRequestText');
                    const stockText = document.getElementById('millionStockText');
                    const memoText = document.getElementById('millionMemoText');
                    
                    if (requestText) requestText.value = result.request || '';
                    if (stockText) stockText.value = result.stock || '';
                    if (memoText) memoText.value = result.memo || '';
                } else if (agency === 'ì˜¤ì•¤í‹°') {
                    // ì˜¤ì•¤í‹° ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const requestText = document.getElementById('ontRequestText');
                    const stockText = document.getElementById('ontStockText');
                    const memoText = document.getElementById('ontMemoText');
                    
                    if (requestText) requestText.value = result.request || '';
                    if (stockText) stockText.value = result.delivery || '';
                    if (memoText) memoText.value = result.open || '';
                } else if (agency === 'ì¥ì²œ') {
                    // ì¥ì²œ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const deliveryText = document.getElementById('jangcheonDeliveryText');
                    const openText = document.getElementById('jangcheonOpenText');
                    
                    if (deliveryText) deliveryText.value = result.delivery || '';
                    if (openText) openText.value = result.open || '';
                } else if (agency === 'í•œì˜¬') {
                    // í•œì˜¬ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (3ê°œ textarea)
                    const confirmText = document.getElementById('hanolConfirmText');
                    const deliveryText = document.getElementById('hanolDeliveryText');
                    const openText = document.getElementById('hanolOpenText');
                    
                    if (confirmText) confirmText.value = result.confirm || '';
                    if (deliveryText) deliveryText.value = result.delivery || '';
                    if (openText) openText.value = result.open || '';
                } else if (agency === 'ëŸ­ìŠ¤') {
                    // ëŸ­ìŠ¤ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (4ê°œ textarea)
                    const requestText = document.getElementById('luxRequestText');
                    const stockText = document.getElementById('luxStockText');
                    const openText = document.getElementById('luxMemoText');
                    const universeText = document.getElementById('luxUniverseText');
                    
                    if (requestText) requestText.value = result.request || '';
                    if (stockText) stockText.value = result.stock || '';
                    if (openText) openText.value = result.open || '';
                    if (universeText) universeText.value = result.universe || '';
                } else if (agency === 'íë¸Œ') {
                    // íë¸Œ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (3ê°œ textarea)
                    const stockText = document.getElementById('cubeStockText');
                    const openText = document.getElementById('cubeOpenText');
                    const universeText = document.getElementById('cubeUniverseText');
                    
                    if (stockText) stockText.value = result.stock || '';
                    if (openText) openText.value = result.open || '';
                    if (universeText) universeText.value = result.universe || '';
                } else {
                    // ê¸°íƒ€ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (ê¸°ë³¸ ëŸ­ìŠ¤ í˜•íƒœ)
                    container.innerHTML = `
                        <div class="form-group">
                            <label for="luxRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxRequestText" class="output-textarea compact-textarea">${result.request || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxStockText" class="output-textarea compact-textarea">${result.stock || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxMemoText" class="output-textarea compact-textarea">${result.open || ''}</textarea>
                        </div>
                    `;
                }
            }

            static showTableOutput(result) {
                const container = document.getElementById('keyValueTableContainer');
                if (!container) return;

                container.style.display = 'block';
                // í…Œì´ë¸” ì¶œë ¥ ë¡œì§ êµ¬í˜„ - result.tableDataë¥¼ ì „ë‹¬
                createKeyValueTable(result.tableData || result);
                
                // additionalTextê°€ ìˆìœ¼ë©´ í…Œì´ë¸” ì•„ë˜ì— í‘œì‹œ
                if (result.additionalText) {
                    let additionalTextDiv = document.getElementById('additionalTextDiv');
                    if (!additionalTextDiv) {
                        additionalTextDiv = document.createElement('div');
                        additionalTextDiv.id = 'additionalTextDiv';
                        additionalTextDiv.style.cssText = `
                            margin-top: 20px;
                            padding: 15px;
                            background-color: #f8f9fa;
                            border: 1px solid #e9ecef;
                            border-radius: 5px;
                            white-space: pre-line;
                            font-family: 'Nanum Gothic', sans-serif;
                            line-height: 1.5;
                        `;
                        container.appendChild(additionalTextDiv);
                    }
                    additionalTextDiv.textContent = result.additionalText;
                }
            }

            static showSingleOutput(result) {
                const container = document.getElementById('singleOutputContainer');
                if (!container) return;

                container.style.display = 'block';
                document.getElementById('outputText').value = result;
            }
        }

        // í†µì‹ ì‚¬ ì„ íƒì— ë”°ë¼ ëŒ€ë¦¬ì  ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateAgencies() {
            const telecomSelect = document.getElementById('telecom');
            const agencySelect = document.getElementById('agency');
            const agencyInfoBtn = document.getElementById('agencyInfoBtn');
            
            // ëŒ€ë¦¬ì  ì„ íƒ ì´ˆê¸°í™”
            agencySelect.innerHTML = '<option value="">ëŒ€ë¦¬ì ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            agencySelect.disabled = true;
            agencyInfoBtn.disabled = true;
            
            const selectedTelecom = telecomSelect.value;
            
            if (selectedTelecom) {
                // ì„ íƒëœ í†µì‹ ì‚¬ì— í•´ë‹¹í•˜ëŠ” ëŒ€ë¦¬ì  ëª©ë¡ ì¶”ê°€
                agencies[selectedTelecom].forEach(agency => {
                    const option = document.createElement('option');
                    option.value = agency;
                    option.textContent = agency;
                    agencySelect.appendChild(option);
                });
                
                // ëŒ€ë¦¬ì  ì„ íƒ í™œì„±í™”
                agencySelect.disabled = false;
                agencyInfoBtn.disabled = false;
            }
        }

        // í…ìŠ¤íŠ¸ì—ì„œ ê³ ê° ì •ë³´ ì¶”ì¶œ
        // function extractCustomerInfo(text) {
        //     const customerInfo = {};
            
        //     // ì •ê·œì‹ íŒ¨í„´ìœ¼ë¡œ ê° í•­ëª© ì¶”ì¶œ
        //     const patterns = {
        //         'ì „í™”ë²ˆí˜¸': /\*{1,2}(?:ì „\s*í™”\s*ë²ˆ\s*í˜¸|ê°œ\s*í†µ\s*ë²ˆ\s*í˜¸)\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ê°œí†µë²ˆí˜¸': /\*{1,2}(?:ì „\s*í™”\s*ë²ˆ\s*í˜¸|ê°œ\s*í†µ\s*ë²ˆ\s*í˜¸)\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ëª¨ë¸ëª…': /\*{1,2}ëª¨\s*ë¸\s*ëª…\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ìƒ‰ìƒ': /\*{1,2}ìƒ‰\s*ìƒ\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ê³ ê°ëª…': /\*{1,2}(?:ê³ \s*ê°\s*ëª…|ê°€\s*ì…\s*ì\s*ëª…)\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ê°€ì…ìëª…': /\*{1,2}(?:ê³ \s*ê°\s*ëª…|ê°€\s*ì…\s*ì\s*ëª…)\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ì£¼ë¯¼ë²ˆí˜¸': /\*{1,2}(?:ì£¼\s*ë¯¼\s*ë²ˆ\s*í˜¸|ìƒ\s*ë…„\s*ì›”\s*ì¼)\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ìƒë…„ì›”ì¼': /\*{1,2}(?:ì£¼\s*ë¯¼\s*ë²ˆ\s*í˜¸|ìƒ\s*ë…„\s*ì›”\s*ì¼)\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'íƒë°°ì£¼ì†Œ': /\*{1,2}íƒ\s*ë°°\s*(?:ì£¼\s*ì†Œ|ì£¼\s*ì†Œ\s*ì§€)?\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ë°°ì†¡ì£¼ì†Œì§€': /\*{1,2}(?:íƒ\s*ë°°|ë°°\s*ì†¡)\s*(?:ì£¼\s*ì†Œ|ì£¼\s*ì†Œ\s*ì§€)?\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'í˜„ì¬í†µì‹ ì‚¬': /\*{1,2}í˜„\s*ì¬\s*í†µ\s*ì‹ \s*ì‚¬\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ìš”ê¸ˆì œ': /\*{1,2}ìš”\s*ê¸ˆ\s*ì œ\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ê°€ì…ìœ í˜•': /\*{1,2}ê°€\s*ì…\s*ìœ \s*í˜•\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'í• ì¸ìœ í˜•': /\*{1,2}í• \s*ì¸\s*(?:ìœ \s*í˜•|ë°©\s*ì‹)\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ìœ ì‹¬': /\*{1,2}ìœ \s*ì‹¬\s*(?:ë¹„\s*ìš©)?\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ë¶€ê°€ì„œë¹„ìŠ¤': /\*{1,2}ë¶€\s*ê°€\s*ì„œ\s*ë¹„\s*ìŠ¤\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ë³´í—˜': /\*{1,2}ë³´\s*í—˜\s*[-:ï¼š]\s*([^\n]+)/i,
        //         'ë²•ëŒ€ì •ë³´': /\*{1,2}ë²•\s*ëŒ€\s*ì •\s*ë³´\s*[-:ï¼š]\s*([^/]+)\s*\/\s*([\d-]+)\s*\/\s*([\d-]+)/i
        //     };
            
        //     // ê° íŒ¨í„´ì— ë§ê²Œ ì •ë³´ ì¶”ì¶œ
        //     for (const [key, pattern] of Object.entries(patterns)) {
        //         const match = text.match(pattern);
        //         if (match) {
        //             if (key === 'ë²•ëŒ€ì •ë³´') {
        //                 // ë²•ëŒ€ì •ë³´ê°€ ìˆëŠ” ê²½ìš° (ë¯¸ì„±ë…„ì)
        //                 customerInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] = 'Y';
        //                 customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„'] = match[1].trim();
        //                 customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'] = match[2].trim().replace(/\s*-\s*/g, '-');
        //                 customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜'] = match[3].trim().replace(/[\s\-]/g, '').replace(/(\d{3})(\d{3,4})(\d{4})/, '$1-$2-$3');
        //                 continue;
        //             }
                    
        //             // ì¼ë°˜ í•„ë“œ ì²˜ë¦¬
        //             if (match[1]) {
        //                 let value = match[1].trim();
                        
        //                 // ì „í™”ë²ˆí˜¸/ê°œí†µë²ˆí˜¸ í¬ë§· ì •ê·œí™” (01012345678 -> 010-1234-5678)
        //                 if ((key === 'ì „í™”ë²ˆí˜¸' || key === 'ê°œí†µë²ˆí˜¸') && value) {
        //                     // ê´„í˜¸ ì•ˆì˜ ë‚´ìš© ì œê±° (ì˜ˆ: (íœ´ëŒ€ì „í™”) ì œê±°)
        //                     value = value.replace(/\([^)]*\)/g, '').trim();
        //                     // ëª¨ë“  ê³µë°±ê³¼ í•˜ì´í”ˆ ì œê±°
        //                     const numbers = value.replace(/[^\d]/g, '');
        //                     // 01012345678 -> 010-1234-5678 í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        //                     if (numbers.length >= 10) {
        //                         value = numbers.replace(/(\d{3})(\d{3,4})(\d{4})/, '$1-$2-$3');
        //                         customerInfo[key] = value;  // ë³€í™˜ëœ ê°’ ì €ì¥
                                
        //                         // ì „í™”ë²ˆí˜¸ì—ì„œ ê°œí†µë²ˆí˜¸ ì¶”ì¶œ (ê°œí†µë²ˆí˜¸ê°€ ì—†ì„ ê²½ìš°ì—ë§Œ)
        //                         if (key === 'ì „í™”ë²ˆí˜¸' && !customerInfo['ê°œí†µë²ˆí˜¸']) {
        //                             customerInfo['ê°œí†µë²ˆí˜¸'] = value;  // ì „í™”ë²ˆí˜¸ë¥¼ ê°œí†µë²ˆí˜¸ë¡œë„ ì €ì¥
        //                         }
        //                     }
        //                 }
                        
        //                 // ìƒë…„ì›”ì¼/ì£¼ë¯¼ë²ˆí˜¸ í¬ë§· ì •ê·œí™” (000718 - 3251915 -> 000718-3251915)
        //                 if ((key === 'ìƒë…„ì›”ì¼' || key === 'ì£¼ë¯¼ë²ˆí˜¸') && value) {
        //                     // í•˜ì´í”ˆ ì£¼ë³€ì˜ ê³µë°± ì œê±°
        //                     value = value.replace(/\s*-\s*/g, '-');
        //                 }
                        
        //                 // ë°°ì†¡ì£¼ì†Œ/íƒë°°ì£¼ì†Œì—ì„œ "/" ì´í›„ì˜ ì „í™”ë²ˆí˜¸ ë¶€ë¶„ ì œê±°
        //                 if ((key === 'íƒë°°ì£¼ì†Œ' || key === 'ë°°ì†¡ì£¼ì†Œì§€') && value) {
        //                     // "/" ì´í›„ì˜ ì „í™”ë²ˆí˜¸ íŒ¨í„´ ì œê±° (ì˜ˆ: / 010-8316-1294)
        //                     value = value.replace(/\s*\/\s*010-\d{3,4}-\d{4}.*$/, '').trim();
        //                 }
                        
        //                 customerInfo[key] = value;
        //             } else {
        //                 customerInfo[key] = '';
        //             }
        //         } else {
        //             customerInfo[key] = '';
        //         }
        //     }
            
        //     // ë¯¸ì„±ë…„ì ì—¬ë¶€ ê¸°ë³¸ê°’ ì„¤ì • (ë²•ëŒ€ì •ë³´ê°€ ì—†ìœ¼ë©´ 'N')
        //     if (!customerInfo.hasOwnProperty('ë¯¸ì„±ë…„ìì—¬ë¶€')) {
        //         customerInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] = 'N';
        //         customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„'] = '';
        //         customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'] = '';
        //         customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜'] = '';
        //     }
            
        //     // ê°œí†µë²ˆí˜¸ì™€ ì „í™”ë²ˆí˜¸ í†µí•© ì²˜ë¦¬ (ì „í™”ë²ˆí˜¸ê°€ ì—†ì„ ê²½ìš° ê°œí†µë²ˆí˜¸ ì‚¬ìš©)
        //     if (!customerInfo['ì „í™”ë²ˆí˜¸'] && customerInfo['ê°œí†µë²ˆí˜¸']) {
        //         customerInfo['ì „í™”ë²ˆí˜¸'] = customerInfo['ê°œí†µë²ˆí˜¸'];
        //     }
            
        //     // ê³ ê°ëª…ê³¼ ê°€ì…ìëª… í†µí•© ì²˜ë¦¬ (ê³ ê°ëª…ì´ ì—†ì„ ê²½ìš° ê°€ì…ìëª… ì‚¬ìš©)
        //     if (!customerInfo['ê³ ê°ëª…'] && customerInfo['ê°€ì…ìëª…']) {
        //         customerInfo['ê³ ê°ëª…'] = customerInfo['ê°€ì…ìëª…'];
        //     }
            
        //     // ì£¼ë¯¼ë²ˆí˜¸ì™€ ìƒë…„ì›”ì¼ í†µí•© ì²˜ë¦¬ (ì£¼ë¯¼ë²ˆí˜¸ê°€ ì—†ì„ ê²½ìš° ìƒë…„ì›”ì¼ ì‚¬ìš©)
        //     if (!customerInfo['ì£¼ë¯¼ë²ˆí˜¸'] && customerInfo['ìƒë…„ì›”ì¼']) {
        //         customerInfo['ì£¼ë¯¼ë²ˆí˜¸'] = customerInfo['ìƒë…„ì›”ì¼'];
        //     }
            
        //     // íƒë°°ì£¼ì†Œì™€ ë°°ì†¡ì£¼ì†Œì§€ í†µí•© ì²˜ë¦¬ (íƒë°°ì£¼ì†Œê°€ ì—†ì„ ê²½ìš° ë°°ì†¡ì£¼ì†Œì§€ ì‚¬ìš©)
        //     if (!customerInfo['íƒë°°ì£¼ì†Œ'] && customerInfo['ë°°ì†¡ì£¼ì†Œì§€']) {
        //         customerInfo['íƒë°°ì£¼ì†Œ'] = customerInfo['ë°°ì†¡ì£¼ì†Œì§€'];
        //     }
            
        //     // 1. Parse subscription, discount, and telecom info using the new function
        //     let subInfo;
        //     try {
        //         // utils.jsì—ì„œ ì „ì—­ìœ¼ë¡œ ë…¸ì¶œëœ í•¨ìˆ˜ ì‚¬ìš©
        //         if (typeof window.parseSubscriptionAndDiscountInfo === 'function') {
        //                                  subInfo = window.parseSubscriptionAndDiscountInfo({
        //                  'ê°€ì…ìœ í˜•': customerInfo['ê°€ì…ìœ í˜•'] || '',
        //                  'í• ì¸ìœ í˜•': customerInfo['í• ì¸ìœ í˜•'] || '',
        //                  'í˜„ì¬í†µì‹ ì‚¬': customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || ''
        //              });
        //              console.log('parseSubscriptionAndDiscountInfo ì‹¤í–‰ ì„±ê³µ');
        //              console.log('ì…ë ¥ ë°ì´í„°:', {
        //                  'ê°€ì…ìœ í˜•': customerInfo['ê°€ì…ìœ í˜•'] || '',
        //                  'í• ì¸ìœ í˜•': customerInfo['í• ì¸ìœ í˜•'] || '',
        //                  'í˜„ì¬í†µì‹ ì‚¬': customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || ''
        //              });
        //              console.log('íŒŒì‹± ê²°ê³¼:', subInfo);
        //         } else {
        //             throw new Error('parseSubscriptionAndDiscountInfo í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        //         }
        //     } catch (error) {
        //         console.error('parseSubscriptionAndDiscountInfo ì˜¤ë¥˜:', error);
        //         // ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ê°’ ì‚¬ìš©
        //         subInfo = {
        //             subscriptionType: customerInfo['ê°€ì…ìœ í˜•'] || '',
        //             discountType: customerInfo['í• ì¸ìœ í˜•'] || '',
        //             currentTelecom: customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || '',
        //             discountMonths: '',
        //             contractType: ''
        //         };
        //     }

        //     // 2. Update customer info with parsed values
        //     customerInfo['ê°€ì…ìœ í˜•'] = subInfo.subscriptionType;
        //     customerInfo['í• ì¸ìœ í˜•'] = subInfo.discountType;
        //     customerInfo['í˜„ì¬í†µì‹ ì‚¬'] = subInfo.currentTelecom;
            
        //     // 2-1. ê°€ì…ìœ í˜•ì´ ë¹„ì–´ìˆëŠ” ê²½ìš° í˜„ì¬í†µì‹ ì‚¬ì™€ ì„ íƒëœ í†µì‹ ì‚¬ ë¹„êµí•˜ì—¬ ìë™ ì„¤ì •
        //     if (!customerInfo['ê°€ì…ìœ í˜•'] || customerInfo['ê°€ì…ìœ í˜•'].trim() === '') {
        //         alert('ì–´ë“œë¯¼ ë©”ëª¨ì˜ ê°€ì…ìœ í˜•ì´ í™•ì¸ë˜ì§€ì•Šì•„ ìë™ ë³€í™˜ì„ ì‹œì‘í•©ë‹ˆë‹¤. \n í˜„ì¬í†µì‹ ì‚¬ì™€ ì„ íƒëœ í†µì‹ ì‚¬ë¥¼ ë¹„êµí•˜ì—¬ ê°€ì…ìœ í˜•ì„ ìë™ ì„¤ì •í•©ë‹ˆë‹¤. \n ë³€í™˜ëœ ì–‘ì‹ì„ í•œë²ˆë” ì²´í¬í•˜ì„¸ìš”.');
        //         // í˜„ì¬ ì„ íƒëœ í†µì‹ ì‚¬ ê°€ì ¸ì˜¤ê¸°
        //         const selectedTelecom = document.getElementById('telecom') ? document.getElementById('telecom').value : '';
        //         const currentTelecom = customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || '';
                
        //         console.log('ê°€ì…ìœ í˜• ìë™ íŒë‹¨:', {
        //             'ì„ íƒëœí†µì‹ ì‚¬': selectedTelecom,
        //             'í˜„ì¬í†µì‹ ì‚¬': currentTelecom
        //         });
                
        //         // í˜„ì¬í†µì‹ ì‚¬ì™€ ì„ íƒëœ í†µì‹ ì‚¬ ë¹„êµ
        //         if (currentTelecom && selectedTelecom) {
        //             if (currentTelecom.toLowerCase().trim() !== selectedTelecom.toLowerCase().trim()) {
        //                 customerInfo['ê°€ì…ìœ í˜•'] = 'ë²ˆí˜¸ì´ë™';
        //                 console.log('ê°€ì…ìœ í˜• ìë™ì„¤ì •: ë²ˆí˜¸ì´ë™ (í˜„ì¬í†µì‹ ì‚¬ â‰  ì„ íƒí†µì‹ ì‚¬)');
        //             } else {
        //                 customerInfo['ê°€ì…ìœ í˜•'] = 'ê¸°ê¸°ë³€ê²½';
        //                 console.log('ê°€ì…ìœ í˜• ìë™ì„¤ì •: ê¸°ê¸°ë³€ê²½ (í˜„ì¬í†µì‹ ì‚¬ = ì„ íƒí†µì‹ ì‚¬)');
        //             }
        //         } else {
        //             console.log('ê°€ì…ìœ í˜• ìë™ì„¤ì • ë¶ˆê°€: í†µì‹ ì‚¬ ì •ë³´ ë¶€ì¡±');
        //         }
        //     }
            
        //     console.log('ì ìš© í›„ customerInfo:', {
        //         'ê°€ì…ìœ í˜•': customerInfo['ê°€ì…ìœ í˜•'],
        //         'í• ì¸ìœ í˜•': customerInfo['í• ì¸ìœ í˜•'],
        //         'í˜„ì¬í†µì‹ ì‚¬': customerInfo['í˜„ì¬í†µì‹ ì‚¬']
        //     });

        //     // 3. Set ê³µì‹œì„ ì•½ì—¬ë¶€ and ì•½ì •ê°œì›”ìˆ˜ based on discount type
        //     if (subInfo.discountType === 'ê³µì‹œì§€ì›') {
        //         customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'] = 'ê³µì‹œì§€ì›';
        //         customerInfo['ì•½ì •ê°œì›”ìˆ˜'] = subInfo.discountMonths || '24ê°œì›”';
        //     } else if (subInfo.discountType === 'ì„ íƒì•½ì •' || subInfo.discountType === 'ì„ ì•½') {
        //         customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'] = subInfo.discountType;
        //         customerInfo['ì•½ì •ê°œì›”ìˆ˜'] = subInfo.discountMonths || '';
        //     } else {
        //         customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'] = '';
        //         customerInfo['ì•½ì •ê°œì›”ìˆ˜'] = '';
        //     }
            
        //     console.log('ìµœì¢… ì•½ì • ì •ë³´:', {
        //         'ê³µì‹œì„ ì•½ì—¬ë¶€': customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'],
        //         'ì•½ì •ê°œì›”ìˆ˜': customerInfo['ì•½ì •ê°œì›”ìˆ˜']
        //     });
            
        //     // ì¶œê³ ê°€, ê³µì‹œ, ì¶”ì§€, ì „í™˜ì§€ì›ê¸ˆ, í”„ë¦¬í• ë¶€, í• ë¶€/í˜„ê¸ˆ ì •ë³´ ì¶”ì¶œ
        //     // 1. ê¸°ë³¸ê°’ ì´ˆê¸°í™”
        //     customerInfo['ì¶”ì§€'] = '0';
        //     customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = '0';
        //     customerInfo['í”„ë¦¬í• ë¶€'] = '0';
            
        //     // 2. ê´„í˜¸ í¬í•¨ íŒ¨í„´ (ì˜ˆ: **ì¶œê³ ê°€ (1,540,000)- ê³µì‹œ(700,000)- ì „ì§€(100,000) = í˜„ê¸ˆ(740,000))
        //     const parenthesizedPattern = /\*\*\s*ì¶œê³ ê°€\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?\s*-\s*ê³µì‹œ\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?\s*(?:-\s*(?:ì¶”ì§€|ì¶”ê°€ì§€ì›)\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?)?\s*(?:-\s*(?:ì „ì§€|ì „í™˜ì§€ì›ê¸ˆ?|ì „í™˜)\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?)?\s*(?:-\s*í”„ë¦¬í• ë¶€\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?)?\s*=\s*(í• ë¶€\d*|\ud604\uae08)\s*[\(\[]?\s*([\d,]+)\s*[\]\)]?/i;
            
        //     // 3. ì¼ë°˜ íŒ¨í„´ (ê´„í˜¸ ì—†ìŒ, ê¸°ì¡´ í˜•ì‹ ìœ ì§€)
        //     const normalPattern = /\*\*\s*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)\s*(?:-\s*(?:ì¶”ì§€|ì¶”ê°€ì§€ì›)\s+([\d,]+))?\s*(?:-\s*(?:ì „ì§€|ì „í™˜ì§€ì›ê¸ˆ?|ì „í™˜)\s+([\d,]+))?\s*(?:-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*(í• ë¶€\d*|\ud604\uae08)\s*([\d,]+)/i;
            
        //     // 4. íŒ¨í„´ ë§¤ì¹­ ì‹œë„ (ê´„í˜¸ í¬í•¨ íŒ¨í„´ ë¨¼ì € ì‹œë„)
        //     let match = text.match(parenthesizedPattern) || text.match(normalPattern);
            
        //     if (match) {
        //         // ë§¤ì¹­ëœ ê·¸ë£¹ ì¸ë±ìŠ¤ ì •ë¦¬
        //         const groups = {
        //             ì¶œê³ ê°€: match[1] || '0',
        //             ê³µì‹œ: match[2] || '0',
        //             ì¶”ì§€: match[3] || '0',
        //             ì „í™˜ì§€ì›ê¸ˆ: match[4] || '0',
        //             í”„ë¦¬í• ë¶€: match[5] || '0',
        //             í• ë¶€í˜„ê¸ˆ: match[6] || 'í˜„ê¸ˆ',
        //             ìµœì¢…êµ¬ë§¤ê°€: match[7] || '0'
        //         };
                
        //         // ê³ ê° ì •ë³´ì— í• ë‹¹ (0ì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ì—…ë°ì´íŠ¸)
        //         customerInfo['ì¶œê³ ê°€'] = groups.ì¶œê³ ê°€.trim();
        //         customerInfo['ê³µì‹œ'] = groups.ê³µì‹œ.trim();
        //         if (groups.ì¶”ì§€ !== '0') customerInfo['ì¶”ì§€'] = groups.ì¶”ì§€.trim();
        //         if (groups.ì „í™˜ì§€ì›ê¸ˆ !== '0') customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = groups.ì „í™˜ì§€ì›ê¸ˆ.trim();
        //         if (groups.í”„ë¦¬í• ë¶€ !== '0') customerInfo['í”„ë¦¬í• ë¶€'] = groups.í”„ë¦¬í• ë¶€.trim();
                
        //         console.log('ë§¤ì¹­ëœ ì •ë³´:', groups); // ë””ë²„ê¹…ìš©
                
        //         // í• ë¶€/í˜„ê¸ˆ ì—¬ë¶€ í™•ì¸
        //         if (groups.í• ë¶€í˜„ê¸ˆ.includes('í• ë¶€')) {
        //             customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í• ë¶€';
                    
        //             // í• ë¶€ê°œì›”ìˆ˜ ì¶”ì¶œ
        //             const installmentMatch = groups.í• ë¶€í˜„ê¸ˆ.match(/(\d+)/);
        //             if (installmentMatch && installmentMatch[1]) {
        //                 customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = installmentMatch[1] + 'ê°œì›”';
        //             } else {
        //                 customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '24ê°œì›”'; // ê¸°ë³¸ê°’
        //             }
        //         } else {
        //             customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í˜„ê¸ˆ';
        //             customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
        //         }
                
        //         customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = groups.ìµœì¢…êµ¬ë§¤ê°€.trim();
        //     } else {
        //         // ì¶”ê°€ íŒ¨í„´ ì‹œë„: ì¶”ì§€ë§Œ ìˆëŠ” ê²½ìš° (ê´„í˜¸ ì—†ìŒ)
        //         const pricePattern = /\*\*\s*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)(?:\s*-\s*(?:ì¶”ì§€|ì¶”ê°€ì§€ì›)\s+([\d,]+))?(?:\s*-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*(í• ë¶€\d*|\ud604\uae08)\s*([\d,]+)/i;
        //         const priceMatch = text.match(pricePattern);
                
        //         if (priceMatch) {
        //             customerInfo['ì¶œê³ ê°€'] = priceMatch[1].trim();
        //             customerInfo['ê³µì‹œ'] = priceMatch[2].trim();
        //             if (priceMatch[3]) customerInfo['ì¶”ì§€'] = priceMatch[3].trim();
        //             if (priceMatch[4]) customerInfo['í”„ë¦¬í• ë¶€'] = priceMatch[4].trim();
                    
        //             // í• ë¶€/í˜„ê¸ˆ ì—¬ë¶€ í™•ì¸
        //             if (priceMatch[5].includes('í• ë¶€')) {
        //                 customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í• ë¶€';
                        
        //                 // í• ë¶€ê°œì›”ìˆ˜ ì¶”ì¶œ
        //                 const installmentMatch = priceMatch[5].match(/(\d+)/);
        //                 if (installmentMatch && installmentMatch[1]) {
        //                     customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = installmentMatch[1] + 'ê°œì›”';
        //                 } else {
        //                     customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '24ê°œì›”'; // ê¸°ë³¸ê°’
        //                 }
        //             } else {
        //                 customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í˜„ê¸ˆ';
        //                 customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
        //             }
                    
        //             customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = priceMatch[6].trim();
        //         } else {
        //             // í˜„ê¸ˆ í˜•ì‹ íŒ¨í„´ í™•ì¸ (ì¶”ì§€ì™€ ì „í™˜ì§€ì›ê¸ˆì´ ëª¨ë‘ ìˆëŠ” ê²½ìš°)
        //             const cashConversionPattern = /\*\*\s*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)(?:\s*-\s*(?:ì¶”ì§€|ì¶”ê°€ì§€ì›)\s+([\d,]+))?\s*(?:-\s*(?:ì „ì§€|ì „í™˜ì§€ì›ê¸ˆ?|ì „í™˜)\s+([\d,]+))?\s*(?:-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*í˜„ê¸ˆ\s*([\d,]+)/i;
        //             const cashConversionMatch = text.match(cashConversionPattern);
                    
        //             if (cashConversionMatch) {
        //                 customerInfo['ì¶œê³ ê°€'] = cashConversionMatch[1].trim();
        //                 customerInfo['ê³µì‹œ'] = cashConversionMatch[2].trim();
        //                 if (cashConversionMatch[3]) customerInfo['ì¶”ì§€'] = cashConversionMatch[3].trim();
        //                 if (cashConversionMatch[4]) customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = cashConversionMatch[4].trim();
        //                 if (cashConversionMatch[5]) customerInfo['í”„ë¦¬í• ë¶€'] = cashConversionMatch[5].trim();
        //                 customerInfo['ì¶”ì§€'] = cashConversionMatch[3].trim();
        //                 customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = cashConversionMatch[5].trim();
        //                 customerInfo['í”„ë¦¬í• ë¶€'] = cashConversionMatch[6] ? cashConversionMatch[6].trim() : '0';
        //                 customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í˜„ê¸ˆ';
        //                 customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
        //                 customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = cashConversionMatch[7].trim();
        //             } else {
        //                 // ê¸°ì¡´ í˜„ê¸ˆ í˜•ì‹ íŒ¨í„´ (ì „í™˜ì§€ì›ê¸ˆ ì—†ëŠ” ê²½ìš°)
        //                 const cashPattern = /\*\*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)\s*-\s*ì¶”ì§€\s+([\d,]+)(?:\s*-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*í˜„ê¸ˆ\s*([\d,]+)/;
        //                 const cashMatch = text.match(cashPattern);
                        
        //                 if (cashMatch) {
        //                     customerInfo['ì¶œê³ ê°€'] = cashMatch[1].trim();
        //                     customerInfo['ê³µì‹œ'] = cashMatch[2].trim();
        //                     customerInfo['ì¶”ì§€'] = cashMatch[3].trim();
        //                     customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = '0';
        //                     customerInfo['í”„ë¦¬í• ë¶€'] = cashMatch[4] ? cashMatch[4].trim() : '0';
        //                     customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í˜„ê¸ˆ';
        //                     customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
        //                     customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = cashMatch[5].trim();
        //                 } else {
        //                     // í• ë¶€ í˜•ì‹ íŒ¨í„´ í™•ì¸ (ì „í™˜ì§€ì›ê¸ˆ í¬í•¨)
        //                     const installmentConversionPattern = /\*\*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)\s*-\s*ì¶”ì§€\s+([\d,]+)\s*-\s*(ì „í™˜ì§€ì›ê¸ˆ?|ì „í™˜)\s+([\d,]+)(?:\s*-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*í• ë¶€(\d+)\s*([\d,]+)/;
        //                     const installmentConversionMatch = text.match(installmentConversionPattern);
                            
        //                     if (installmentConversionMatch) {
        //                         customerInfo['ì¶œê³ ê°€'] = installmentConversionMatch[1].trim();
        //                         customerInfo['ê³µì‹œ'] = installmentConversionMatch[2].trim();
        //                         customerInfo['ì¶”ì§€'] = installmentConversionMatch[3].trim();
        //                         customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = installmentConversionMatch[5].trim();
        //                         customerInfo['í”„ë¦¬í• ë¶€'] = installmentConversionMatch[6] ? installmentConversionMatch[6].trim() : '0';
        //                         customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í• ë¶€';
        //                         customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = installmentConversionMatch[7] + 'ê°œì›”';
        //                         customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = installmentConversionMatch[8].trim();
        //                     } else {
        //                         // ê¸°ì¡´ í• ë¶€ í˜•ì‹ íŒ¨í„´ (ì „í™˜ì§€ì›ê¸ˆ ì—†ëŠ” ê²½ìš°)
        //                         const alternatePattern = /\*\*ì¶œê³ ê°€\s+([\d,]+)\s*-\s*ê³µì‹œ\s+([\d,]+)\s*-\s*ì¶”ì§€\s+([\d,]+)(?:\s*-\s*í”„ë¦¬í• ë¶€\s+([\d,]+))?\s*=\s*í• ë¶€(\d+)\s*([\d,]+)/;
        //                         const alternateMatch = text.match(alternatePattern);
                                
        //                         if (alternateMatch) {
        //                             customerInfo['ì¶œê³ ê°€'] = alternateMatch[1].trim();
        //                             customerInfo['ê³µì‹œ'] = alternateMatch[2].trim();
        //                             customerInfo['ì¶”ì§€'] = alternateMatch[3].trim();
        //                             customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = '0';
        //                             customerInfo['í”„ë¦¬í• ë¶€'] = alternateMatch[4] ? alternateMatch[4].trim() : '0';
        //                             customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = 'í• ë¶€';
        //                             customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = alternateMatch[5] + 'ê°œì›”';
        //                             customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = alternateMatch[6].trim();
        //                         } else {
        //                             customerInfo['ì¶œê³ ê°€'] = '';
        //                             customerInfo['ê³µì‹œ'] = '';
        //                             customerInfo['ì¶”ì§€'] = '';
        //                             customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] = '0';
        //                             customerInfo['í”„ë¦¬í• ë¶€'] = '0';
        //                             customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] = '';
        //                             customerInfo['í• ë¶€ê°œì›”ìˆ˜'] = '';
        //                             customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] = '';
        //                         }
        //                     }
        //                 }
        //             }
        //         }
        //     }
            
        //     // ëª¨ë¸ëª… ë³€í™˜ ë° ìš©ëŸ‰ ì •ë³´ ì¶”ì¶œ
        //     if (customerInfo['ëª¨ë¸ëª…']) {
        //         // ë¨¼ì € ì›ë³¸ ëª¨ë¸ëª…ì—ì„œ ìš©ëŸ‰ ì •ë³´ ì¶”ì¶œ (convertModelName ì‹¤í–‰ ì „)
        //         let capacityMatch = null;
        //         let hasUnit = false;
        //         let extractedCapacity = '';
        //         let originalModelName = customerInfo['ëª¨ë¸ëª…'];
                
        //         // 1. ë‹¨ìœ„ê°€ ìˆëŠ” ìš©ëŸ‰ ë¨¼ì € ì°¾ê¸° (256G, 512GB, 1TB ë“±)
        //         capacityMatch = originalModelName.match(/(?:^|\s|_)(\d+)(?:\s*[GT]?[B]?)(?=\s|$|_)/i);
                
        //         let capacityFound = false;
                
        //         if (capacityMatch) {
        //             // ë§¤ì¹­ëœ ê²°ê³¼ì—ì„œ ì‹¤ì œë¡œ ë‹¨ìœ„ê°€ ìˆëŠ”ì§€ í™•ì¸
        //             const matchedText = capacityMatch[0].replace(/^[\s_]+|[\s_]+$/g, '');
        //             const hasActualUnit = matchedText.match(/[GT]?[B]?$/i);
        //             // ì‹¤ì œë¡œ G, GB, TB ë“±ì˜ ë‹¨ìœ„ê°€ ìˆëŠ”ì§€ í™•ì¸ (ë¹ˆ ë¬¸ìì—´ì´ ì•„ë‹Œ ê²½ìš°)
        //             const hasRealUnit = hasActualUnit && hasActualUnit[0] && hasActualUnit[0].length > 0;
                    
        //             if (hasRealUnit) {
        //                 // ì‹¤ì œë¡œ ë‹¨ìœ„ê°€ ìˆëŠ” ê²½ìš°
        //                 hasUnit = true;
        //                 extractedCapacity = capacityMatch[1];
        //                 customerInfo['ìš©ëŸ‰'] = matchedText;
        //                 // ì›ë³¸ ëª¨ë¸ëª…ì—ì„œ ìš©ëŸ‰ ë¶€ë¶„ ì œê±°
        //                 originalModelName = originalModelName.replace(/(?:^|\s|_)\d+(?:\s*[GT]?[B]?)(?:\s|$|_)/i, ' ').replace(/\s+/g, ' ').trim();
        //                 capacityFound = true;
        //             }
        //         }
                
        //         if (!capacityFound) {
        //             // 2. ë‹¨ìœ„ê°€ ì—†ëŠ” ìš©ëŸ‰ ì°¾ê¸° (256, 512 ë“±)
        //             capacityMatch = originalModelName.match(/(?:^|\s|_)(\d+)(?:\s|$|_)/i);
                    
        //             if (capacityMatch) {
        //                 hasUnit = false;
        //                 extractedCapacity = capacityMatch[1];
        //                 customerInfo['ìš©ëŸ‰'] = extractedCapacity + 'G';
        //                 // ì›ë³¸ ëª¨ë¸ëª…ì—ì„œ ìš©ëŸ‰ ë¶€ë¶„ ì œê±°
        //                 originalModelName = originalModelName.replace(/(?:^|\s|_)\d+(?:\s|$|_)/i, ' ').replace(/\s+/g, ' ').trim();
        //                 capacityFound = true;
        //             } else {
        //                 // 3. ìš©ëŸ‰ì„ ì°¾ì§€ ëª»í•œ ê²½ìš°
        //                 customerInfo['ìš©ëŸ‰'] = '';
        //             }
        //         }
                
        //         // ìš©ëŸ‰ì´ ì œê±°ëœ ëª¨ë¸ëª…ìœ¼ë¡œ ë³€í™˜ ì ìš© (í«ë„¤ì„ â†’ ì‹¤ì œ ëª¨ë¸ëª…)
        //         const convertedModelName = convertModelName(originalModelName);
        //         customerInfo['ëª¨ë¸ëª…'] = convertedModelName;
                
        //         // ëª¨ë¸ì œì¡°ì‚¬ ìë™ ë¶„ë¥˜ (ì•„ì´í°/ê°¤ëŸ­ì‹œ)
        //         if (convertedModelName.toLowerCase().includes('ì•„ì´í°') || 
        //             convertedModelName.toLowerCase().includes('iphone')) {
        //             customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] = 'ì•„ì´í°';
        //         } else {
        //             customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] = 'ê°¤ëŸ­ì‹œ';
        //         }
        //     } else {
        //         customerInfo['ìš©ëŸ‰'] = '';
        //         customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] = '';
        //     }
            
        //     // ë¶€ê°€ì„œë¹„ìŠ¤ì™€ ë³´í—˜ ë¶„ë¦¬ ì²˜ë¦¬ (ê°œì„ ëœ ë²„ì „)
        //     if (customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤']) {
        //         const originalAddon = customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤'];
        //         const parsed = parseAddonAndInsuranceEnhanced(customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤']);
                
        //         // ë¶„ë¦¬ëœ ê²°ê³¼ë¥¼ customerInfoì— ì €ì¥
        //         customerInfo['ë³´í—˜'] = parsed.ë³´í—˜;
        //         customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤'] = parsed.ë¶€ê°€ì„œë¹„ìŠ¤1;
        //         customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤2'] = parsed.ë¶€ê°€ì„œë¹„ìŠ¤2;
                
        //         console.log('ë¶€ê°€ì„œë¹„ìŠ¤ ë¶„ë¦¬ ê²°ê³¼:', {
        //             'ì›ë³¸': originalAddon,
        //             'ë¶„ë¦¬ëœ ë³´í—˜': parsed.ë³´í—˜,
        //             'ë¶„ë¦¬ëœ ë¶€ê°€ì„œë¹„ìŠ¤1': parsed.ë¶€ê°€ì„œë¹„ìŠ¤1,
        //             'ë¶„ë¦¬ëœ ë¶€ê°€ì„œë¹„ìŠ¤2': parsed.ë¶€ê°€ì„œë¹„ìŠ¤2
        //         });
        //     } else {
        //         customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤2'] = '';
        //     }
            
        //     // ëª¨ë¸ì œì¡°ì‚¬ì— ë”°ë¥¸ ë³´í—˜ëª… ìë™ ì„¤ì • (ëª¨ë¸ì œì¡°ì‚¬ ì„¤ì • í›„ ì‹¤í–‰)
        //     if (customerInfo['ë³´í—˜'] && customerInfo['ëª¨ë¸ì œì¡°ì‚¬']) {
        //         if (customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] === 'ê°¤ëŸ­ì‹œ') {
        //             customerInfo['ë³´í—˜'] = 'T ALLì¼€ì–´í”ŒëŸ¬ìŠ¤5 íŒŒì†80(5300)';
        //             console.log('ê°¤ëŸ­ì‹œ ë³´í—˜ëª… ìë™ ì„¤ì •: T ALLì¼€ì–´í”ŒëŸ¬ìŠ¤5 íŒŒì†80(5300)');
        //         } else if (customerInfo['ëª¨ë¸ì œì¡°ì‚¬'] === 'ì•„ì´í°') {
        //             customerInfo['ë³´í—˜'] = 'Tì˜¬ì¼€ì–´+5 IíŒŒì†';
        //             console.log('ì•„ì´í° ë³´í—˜ëª… ìë™ ì„¤ì •: Tì˜¬ì¼€ì–´+5 IíŒŒì†');
        //         }
        //     }
            
        //     return customerInfo;
        // }

        // ì–‘ì‹ ë³€í™˜ í•¨ìˆ˜
        function convertFormat() {
            // ì¶œë ¥ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
            const outputContainer = document.getElementById('outputContainer');
            const singleOutputContainer = document.getElementById('singleOutputContainer');
            const splitOutputContainer = document.getElementById('splitOutputContainer');
            const luxExtraOutputs = document.getElementById('luxExtraOutputs');
            const dblackExtraOutputs = document.getElementById('dblackExtraOutputs');
            const actExtraOutputs = document.getElementById('actExtraOutputs');
            const bncomExtraOutputs = document.getElementById('bncomExtraOutputs');
            const hunetExtraOutputs = document.getElementById('hunetExtraOutputs');
            const millionExtraOutputs = document.getElementById('millionExtraOutputs');
            const ontExtraOutputs = document.getElementById('ontExtraOutputs');
            const keyValueTableContainer = document.getElementById('keyValueTableContainer');
            
            // ëª¨ë“  ì¶œë ¥ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸°
            if (splitOutputContainer) splitOutputContainer.style.display = 'none';
            if (luxExtraOutputs) luxExtraOutputs.style.display = 'none';
            if (dblackExtraOutputs) dblackExtraOutputs.style.display = 'none';
            if (actExtraOutputs) actExtraOutputs.style.display = 'none';
            if (bncomExtraOutputs) bncomExtraOutputs.style.display = 'none';
            if (hunetExtraOutputs) hunetExtraOutputs.style.display = 'none';
            if (millionExtraOutputs) millionExtraOutputs.style.display = 'none';
            if (ontExtraOutputs) ontExtraOutputs.style.display = 'none';
            const jangcheonExtraOutputs = document.getElementById('jangcheonExtraOutputs');
            if (jangcheonExtraOutputs) jangcheonExtraOutputs.style.display = 'none';
            if (keyValueTableContainer) keyValueTableContainer.style.display = 'none';
            
            // ê¸°ë³¸ ì¶œë ¥ ì»¨í…Œì´ë„ˆ í‘œì‹œ
            if (singleOutputContainer) singleOutputContainer.style.display = 'block';
            
            // ëª¨ë“  textarea ë‚´ìš© ì´ˆê¸°í™”
            const allTextareas = outputContainer.getElementsByTagName('textarea');
            for (let textarea of allTextareas) {
                textarea.value = '';
            }
            
            // ëª¨ë“  DOM ìš”ì†Œ ì°¸ì¡° ê°€ì ¸ì˜¤ê¸°
            const agencySelect = document.getElementById('agency');
            const inputText = document.getElementById('inputText');
            const telecomSelect = document.getElementById('telecom');
            const deviceSerialInput = document.getElementById('deviceSerial');
            const simSerialInput = document.getElementById('simSerial');
            
            // ì„ íƒëœ ê°’ ê°€ì ¸ì˜¤ê¸°
            const selectedTelecom = telecomSelect ? telecomSelect.value : '';
            const selectedAgency = agencySelect ? agencySelect.value : '';
            
            // ì…ë ¥ê°’ ê²€ì¦
            if (!selectedTelecom || !selectedAgency) {
                alert('í†µì‹ ì‚¬ì™€ ëŒ€ë¦¬ì ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                // ê³ ê° ì •ë³´ ì¶”ì¶œ
                const customerInfo = extractCustomerInfo(inputText.value || '');
            
            // ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸ì™€ ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ ì¶”ê°€
            if (deviceSerialInput && deviceSerialInput.value.trim()) {
                customerInfo['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] = deviceSerialInput.value.trim();
            }
            if (simSerialInput && simSerialInput.value.trim()) {
                customerInfo['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] = simSerialInput.value.trim();
            }
            
                console.log('ì¶”ì¶œëœ ê³ ê° ì •ë³´:', customerInfo);
                console.table(customerInfo);
                
                // KT ëŒ€ë¦¬ì  ì•½ì • ì²´í¬
                if (selectedTelecom === 'KT') {
                    const ê³µì‹œì„ ì•½ì—¬ë¶€ = customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'] || customerInfo['í• ì¸ìœ í˜•'] || '';
                    const ì•½ì •ê°œì›”ìˆ˜ = customerInfo['ì•½ì •ê°œì›”ìˆ˜'] || '';
                    
                    if (ê³µì‹œì„ ì•½ì—¬ë¶€ === 'ì„ íƒì•½ì •' && ì•½ì •ê°œì›”ìˆ˜ === '12ê°œì›”') {
                        alert('KT ëŒ€ë¦¬ì ì€ ì„ íƒì•½ì • 24ê°œì›”ë§Œ ì§„í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì–´ë“œë¯¼ ë©”ëª¨ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
                    }
                }
                
                // í•„ìˆ˜ í•­ëª© ì²´í¬ ë° alert í‘œì‹œ
                const requiredFields = ['ê°€ì…ìœ í˜•', 'í• ì¸ìœ í˜•', 'ìœ ì‹¬', 'ìš”ê¸ˆì œ', 'ì•½ì •ê°œì›”ìˆ˜', 'ìµœì¢…êµ¬ë§¤ê°€', 'ìš©ëŸ‰', 'ëª¨ë¸ì œì¡°ì‚¬', 'í˜„ì¬í†µì‹ ì‚¬'];
                const emptyFields = [];
                
                requiredFields.forEach(field => {
                    if (!customerInfo[field] || customerInfo[field].trim() === '') {
                        emptyFields.push(field);
                    }
                });
                
                if (emptyFields.length > 0) {
                    const missingItems = emptyFields.join(', ');
                    alert(`ë‹¤ìŒ í•­ëª©ë“¤ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤: ${missingItems}\n ì–´ë“œë¯¼ ë©”ëª¨ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.`);
                }
                
                // ìƒˆë¡œìš´ êµ¬ì¡°ì˜ í…œí”Œë¦¿ ì‹œìŠ¤í…œ ì‚¬ìš© ì‹œë„
                let result;
                let outputType;
                
                if (TELECOM_CONFIG[selectedTelecom]?.agencies[selectedAgency]) {
                    // ìƒˆë¡œìš´ êµ¬ì¡° ì‚¬ìš©
                    const agencyConfig = TELECOM_CONFIG[selectedTelecom].agencies[selectedAgency];
                    result = TemplateManager.applyTemplate(selectedTelecom, selectedAgency, customerInfo);
                    outputType = agencyConfig.outputType;
                    
                    // ê²°ê³¼ ì¶œë ¥
                    OutputManager.showOutput(result, outputType, selectedTelecom, selectedAgency);
                } else {
                    // TELECOM_CONFIGì— ì—†ëŠ” ëŒ€ë¦¬ì ì€ ì˜¤ë¥˜ ì²˜ë¦¬
                    throw new Error(`ì„ íƒí•˜ì‹  ëŒ€ë¦¬ì  (${selectedAgency})ì— ëŒ€í•œ í…œí”Œë¦¿ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. TELECOM_CONFIGì— ì¶”ê°€ê°€ í•„ìš”í•©ë‹ˆë‹¤.`);
                }
                
                // ë³€í™˜ ì´ë ¥ ì €ì¥
                saveToHistory(customerInfo, selectedTelecom, selectedAgency);
                    
                    // ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
                    setupDoubleClickCopy();
                
            } catch (error) {
                console.error('ë³€í™˜ ì¤‘ ì˜¤ë¥˜:', error);
                alert('ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
        
        // í‚¤-ê°’ í…Œì´ë¸” ìƒì„± í•¨ìˆ˜
        function createKeyValueTable(customerInfo) {
            const tableBody = document.querySelector('#keyValueTable tbody');
            tableBody.innerHTML = ''; // í…Œì´ë¸” ì´ˆê¸°í™”
            
            // í˜„ì¬ ì„ íƒëœ ëŒ€ë¦¬ì  í™•ì¸
            const agencySelect = document.getElementById('agency');
            const selectedAgency = agencySelect ? agencySelect.value : '';
            
            // ê¸°ë³¸ ì •ë³´ ì²˜ë¦¬ (ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ê°’ ì„ íƒ)
            const processedInfo = {
                'ê°€ì…ìëª…': customerInfo['ê°€ì…ìëª…'] || customerInfo['ê³ ê°ëª…'] || '',
                'ê°œí†µë²ˆí˜¸': customerInfo['ê°œí†µë²ˆí˜¸'] || customerInfo['ì „í™”ë²ˆí˜¸'] || '',
                'ì£¼ë¯¼ë²ˆí˜¸': customerInfo['ì£¼ë¯¼ë²ˆí˜¸'] || customerInfo['ìƒë…„ì›”ì¼'] || '',
                'ëª¨ë¸ëª…': customerInfo['ëª¨ë¸ëª…'] || '',
                'ìš©ëŸ‰': customerInfo['ìš©ëŸ‰'] || '',
                'ìƒ‰ìƒ': customerInfo['ìƒ‰ìƒ'] || '',
                'ê°€ì…ìœ í˜•': customerInfo['ê°€ì…ìœ í˜•'] || '',
                'í• ì¸ìœ í˜•': customerInfo['í• ì¸ìœ í˜•'] || '',
                'ì•½ì •ê°œì›”ìˆ˜': customerInfo['ì•½ì •ê°œì›”ìˆ˜'] || '',
                'ìš”ê¸ˆì œ': customerInfo['ìš”ê¸ˆì œ'] || '',
                'í• ë¶€í˜„ê¸ˆì—¬ë¶€': customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] || '',
                'í• ë¶€ê°œì›”ìˆ˜': customerInfo['í• ë¶€ê°œì›”ìˆ˜'] || '',
                'í˜„ì¬í†µì‹ ì‚¬': customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || '',
                'ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸': customerInfo['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || '',
                'ìœ ì‹¬': customerInfo['ìœ ì‹¬'] || '',
                'ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸': customerInfo['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || '',
                'ì¶œê³ ê°€': customerInfo['ì¶œê³ ê°€'] || '',
                'ê³µì‹œì§€ì›ê¸ˆ': customerInfo['ê³µì‹œ'] || '',
                'ì¶”ê°€ì§€ì›ê¸ˆ': customerInfo['ì¶”ì§€'] || '',
                'ì „í™˜ì§€ì›ê¸ˆ': customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] || '',
                'í”„ë¦¬í• ë¶€': customerInfo['í”„ë¦¬í• ë¶€'] || '',
                'ìµœì¢…êµ¬ë§¤ê°€': customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] || '',
                'ë¶€ê°€ì„œë¹„ìŠ¤': customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤'] || '',
                'ë¶€ê°€ì„œë¹„ìŠ¤2': customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤2'] || '',
                'ë³´í—˜': customerInfo['ë³´í—˜'] || '',
                'ë°°ì†¡ì£¼ì†Œì§€': customerInfo['ë°°ì†¡ì£¼ì†Œì§€'] || customerInfo['íƒë°°ì£¼ì†Œ'] || '',
                'ë¯¸ì„±ë…„ìì—¬ë¶€': customerInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„'] || customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ëª…'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'] || ''
            };
            
            // í…Œì´ë¸”ì— í‘œì‹œí•  í•„ë“œ ìˆœì„œ ì •ì˜
            const basicFields = [
                'ê°€ì…ìëª…', 'ê°œí†µë²ˆí˜¸', 'ì£¼ë¯¼ë²ˆí˜¸', 'ëª¨ë¸ëª…', 'ìš©ëŸ‰', 'ìƒ‰ìƒ',
                'ê°€ì…ìœ í˜•', 'í• ì¸ìœ í˜•', 'ì•½ì •ê°œì›”ìˆ˜', 'ìš”ê¸ˆì œ', 
                'í• ë¶€í˜„ê¸ˆì—¬ë¶€', 'í• ë¶€ê°œì›”ìˆ˜', 'í˜„ì¬í†µì‹ ì‚¬'
            ];
            
            const deviceFields = [
                'ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸', 'ìœ ì‹¬', 'ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'
            ];
            
            const priceFields = [
                'ì¶œê³ ê°€', 'ê³µì‹œì§€ì›ê¸ˆ', 'ì¶”ê°€ì§€ì›ê¸ˆ', 'ì „í™˜ì§€ì›ê¸ˆ', 
                'í”„ë¦¬í• ë¶€', 'ìµœì¢…êµ¬ë§¤ê°€'
            ];
            
            const additionalFields = [
                'ë¶€ê°€ì„œë¹„ìŠ¤', 'ë¶€ê°€ì„œë¹„ìŠ¤2', 'ë³´í—˜', 'ë°°ì†¡ì£¼ì†Œì§€'
            ];
            
            const minorFields = [
                'ë¯¸ì„±ë…„ìì—¬ë¶€', 'ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„', 'ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜', 'ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'
            ];
            
            // ê¸°ë³¸ ì •ë³´ í•„ë“œ ì¶”ê°€
            basicFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ë‹¨ë§ê¸° ì •ë³´ í•„ë“œ ì¶”ê°€
            deviceFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ê°€ê²© ì •ë³´ í•„ë“œ ì¶”ê°€ (ë¹ˆ ê°’ì´ì–´ë„ í‘œì‹œ)
            priceFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                addTableRow(tableBody, fieldName, value || '');
            });
            
            // ì¶”ê°€ ì •ë³´ í•„ë“œ ì¶”ê°€
            additionalFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ë¯¸ì„±ë…„ìì¸ ê²½ìš° ë²•ì •ëŒ€ë¦¬ì¸ ì •ë³´ ì¶”ê°€
            if (processedInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] === 'Y') {
                minorFields.forEach(fieldName => {
                    const value = processedInfo[fieldName];
                    if (value !== undefined && value !== null && value !== '') {
                        addTableRow(tableBody, fieldName, value);
                    }
                });
            }
            
            // ì¶”ê°€ í…Œì´ë¸” ì•ˆë‚´ë¬¸ í‘œì‹œ
            const copyNoticeDiv = document.querySelector('.copy-notice');
            if (copyNoticeDiv) {
                copyNoticeDiv.textContent = `${selectedAgency} - ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.`;
            }
        }
        
        // í‚¤-ê°’ í…Œì´ë¸”ì— í–‰ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
        function addTableRow(tableBody, key, value) {
            const row = document.createElement('tr');
            
            const keyCell = document.createElement('td');
            keyCell.className = 'key-cell';
            keyCell.textContent = key;
            
            const valueCell = document.createElement('td');
            valueCell.className = 'value-cell';
            valueCell.textContent = value;
            valueCell.setAttribute('data-value', value);
            valueCell.onclick = function() {
                copyToClipboardWithFeedback(this.getAttribute('data-value'), this);
            };
            
            row.appendChild(keyCell);
            row.appendChild(valueCell);
            tableBody.appendChild(row);
        }
        
        
        
        // ë³€í™˜ ì´ë ¥ ì €ì¥
        function saveToHistory(customerInfo, telecom, agency) {
            try {
                let history = JSON.parse(localStorage.getItem('conversionHistory') || '[]');
                
                // ì›ë³¸ í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ì €ì¥í•˜ì§€ ì•ŠìŒ (ë¶ˆí•„ìš”í•œ ë°ì´í„° ë°©ì§€)
                const inputText = document.getElementById('inputText');
                if (inputText && inputText.value.trim()) {
                    customerInfo.ì›ë³¸í…ìŠ¤íŠ¸ = inputText.value.trim();
                } else {
                    return; // ì›ë³¸ í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ì €ì¥í•˜ì§€ ì•ŠìŒ
                }
                
                // ì¤‘ë³µ ì²´í¬ (ë™ì¼í•œ ê³ ê°ëª…ê³¼ ì „í™”ë²ˆí˜¸ê°€ ìˆëŠ”ì§€)
                const exists = history.some(item => {
                    const sameName = String(item.customerInfo.ê³ ê°ëª… || '') === String(customerInfo.ê³ ê°ëª… || '');
                    const samePhone = String(item.customerInfo.ì „í™”ë²ˆí˜¸ || '') === String(customerInfo.ì „í™”ë²ˆí˜¸ || '');
                    const sameAgency = String(item.agency || '') === String(agency || '');
                    
                    // ê³ ê°ëª…ê³¼ ì „í™”ë²ˆí˜¸ê°€ ëª¨ë‘ ì¼ì¹˜í•˜ê³ , ë™ì¼í•œ ëŒ€ë¦¬ì ì¸ ê²½ìš°ì—ë§Œ ì¤‘ë³µìœ¼ë¡œ íŒë‹¨
                    return sameName && samePhone && sameAgency;
                });
                
                if (!exists) {
                    // ìµœëŒ€ 50ê°œê¹Œì§€ ì €ì¥
                    if (history.length >= 50) {
                        history.pop(); // ê°€ì¥ ì˜¤ë˜ëœ í•­ëª© ì œê±°
                    }
                    
                    // ìƒˆ í•­ëª© ì¶”ê°€ (ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê¸° ìœ„í•´ unshift ì‚¬ìš©)
                    history.unshift({
                        id: Date.now(),
                        customerInfo: customerInfo,
                        telecom: telecom,
                        agency: agency,
                        timestamp: new Date().toISOString()
                    });
                    
                    localStorage.setItem('conversionHistory', JSON.stringify(history));
                }
            } catch (e) {
                console.error('ì´ë ¥ ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
            }
        }
        
        // ë³€í™˜ ì´ë ¥ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadHistory() {
            try {
                const history = JSON.parse(localStorage.getItem('conversionHistory') || '[]');
                const historyList = document.getElementById('historyList');
                
                if (!historyList) return;
                
                if (history.length === 0) {
                    historyList.innerHTML = '<div class="no-history">ì €ì¥ëœ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }
                
                historyList.innerHTML = history.map(item => `
                    <div class="history-item" onclick="loadFromHistory('${item.id}')">
                        <div class="history-header">
                            <span class="history-name">${item.customerInfo.ê³ ê°ëª… || 'ì´ë¦„ ì—†ìŒ'}</span>
                            <span class="history-phone">${item.customerInfo.ì „í™”ë²ˆí˜¸ || item.customerInfo.ì—°ë½ì²˜ || 'ì „í™”ë²ˆí˜¸ ì—†ìŒ'}</span>
                            <span class="history-time">${new Date(item.timestamp).toLocaleString()}</span>
                        </div>
                        <div class="history-details">
                            <span class="history-model">${item.customerInfo.ëª¨ë¸ëª… || ''} ${item.customerInfo.ìƒ‰ìƒ || ''}</span>
                            <span class="history-plan">${item.customerInfo.ìš”ê¸ˆì œ || ''}</span>
                        </div>
                        <div class="history-footer">
                            <span class="history-agency">${item.telecom} / ${item.agency}</span>
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                console.error('ì´ë ¥ ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
            }
        }
        
        // ì´ë ¥ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadFromHistory(id) {
            try {
                const history = JSON.parse(localStorage.getItem('conversionHistory') || '[]');
                const item = history.find(item => item.id.toString() === id.toString());
                
                if (item) {
                    // í†µì‹ ì‚¬ì™€ ëŒ€ë¦¬ì  ì„ íƒ
                    const telecomSelect = document.getElementById('telecom');
                    const agencySelect = document.getElementById('agency');
                    
                    // í˜„ì¬ ì„ íƒëœ ê°’ ì €ì¥
                    const currentTelecom = telecomSelect.value;
                    const currentAgency = agencySelect.value;
                    
                    // ìƒˆ ê°’ìœ¼ë¡œ ì„¤ì •
                    telecomSelect.value = item.telecom;
                    
                    // ëŒ€ë¦¬ì ì´ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¸ë‹¤ê°€ ì„ íƒ
                    const checkAgency = setInterval(() => {
                        updateAgencies();
                        
                        // ëŒ€ë¦¬ì ì´ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸ (ì˜µì…˜ ëª©ë¡ì— ìˆëŠ”ì§€)
                        const agencyOptions = Array.from(agencySelect.options).map(opt => opt.value);
                        if (agencyOptions.includes(item.agency)) {
                            clearInterval(checkAgency);
                            
                            // ëŒ€ë¦¬ì  ì„ íƒ
                            agencySelect.value = item.agency;
                            
                            // ì…ë ¥ í•„ë“œ ì±„ìš°ê¸°
                            const info = item.customerInfo;
                            const inputText = document.getElementById('inputText');
                            const deviceSerial = document.getElementById('deviceSerial');
                            const simSerial = document.getElementById('simSerial');
                            
                            // ì›ë³¸ í…ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒì„±
                            if (!info.ì›ë³¸í…ìŠ¤íŠ¸) {
                                let defaultText = '';
                                if (info.ê³ ê°ëª…) defaultText += `ê³ ê°ëª…: ${info.ê³ ê°ëª…}\n`;
                                if (info.ì „í™”ë²ˆí˜¸) defaultText += `ì „í™”ë²ˆí˜¸: ${info.ì „í™”ë²ˆí˜¸}\n`;
                                if (info.ëª¨ë¸ëª…) defaultText += `ëª¨ë¸ëª…: ${info.ëª¨ë¸ëª…}\n`;
                                if (info.ìƒ‰ìƒ) defaultText += `ìƒ‰ìƒ: ${info.ìƒ‰ìƒ}\n`;
                                if (info.ìš”ê¸ˆì œ) defaultText += `ìš”ê¸ˆì œ: ${info.ìš”ê¸ˆì œ}\n`;
                                if (info.ê°€ì…ìœ í˜•) defaultText += `ê°€ì…ìœ í˜•: ${info.ê°€ì…ìœ í˜•}\n`;
                                if (info.í• ë¶€í˜„ê¸ˆì—¬ë¶€) defaultText += `í• ë¶€/í˜„ê¸ˆ: ${info.í• ë¶€í˜„ê¸ˆì—¬ë¶€}\n`;
                                if (info.ìµœì¢…êµ¬ë§¤ê°€) defaultText += `ìµœì¢…êµ¬ë§¤ê°€: ${info.ìµœì¢…êµ¬ë§¤ê°€}ì›\n`;
                                
                                inputText.value = defaultText.trim();
                            } else {
                                inputText.value = info.ì›ë³¸í…ìŠ¤íŠ¸ || '';
                            }
                            
                            if (deviceSerial) deviceSerial.value = info.ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸ || '';
                            if (simSerial) simSerial.value = info.ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸ || '';
                            
                            // ë³€í™˜ ì‹¤í–‰ (ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ì–´ UI ì—…ë°ì´íŠ¸ê°€ ì™„ë£Œë˜ë„ë¡)
                            setTimeout(() => {
                                convertFormat();
                                closeHistoryPopup();
                            }, 300);
                        }
                    }, 50);
                }
            } catch (e) {
                console.error('ì´ë ¥ ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', e);
                alert('ì´ë ¥ ë¶ˆëŸ¬ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ì´ë ¥ íŒì—… ì—´ê¸°
        function openHistoryPopup() {
            const popup = document.getElementById('historyPopup');
            if (popup) {
                loadHistory();
                popup.style.display = 'flex';
            }
        }
        
        // ì´ë ¥ íŒì—… ë‹«ê¸°
        function closeHistoryPopup() {
            const popup = document.getElementById('historyPopup');
            if (popup) {
                popup.style.display = 'none';
            }
        }
        
        // ì´ë ¥ ì „ì²´ ì‚­ì œ
        function clearHistory() {
            if (confirm('ëª¨ë“  ë³€í™˜ ì´ë ¥ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                localStorage.removeItem('conversionHistory');
                loadHistory();
            }
        }
        
        // ëª¨ë‘ ì§€ìš°ê¸° í•¨ìˆ˜
        function clearAll() {
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('inputText').value = '';
            document.getElementById('deviceSerial').value = '';
            document.getElementById('simSerial').value = '';
            
            // ì—‘ì…€ íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™” (excel-manager.jsì™€ ì—°ë™)
            if (typeof clearExcelInputs === 'function') {
                clearExcelInputs();
            } else {
                // fallback: ì§ì ‘ ì´ˆê¸°í™”
                document.getElementById('excelFile').value = '';
                document.getElementById('extractCount').textContent = '';
                
                const excelFile2 = document.getElementById('excelFile2');
                if (excelFile2) excelFile2.value = '';
                
                const extractCount2Element = document.getElementById('extractCount2');
                if (extractCount2Element) {
                    extractCount2Element.textContent = '';
                }
                
                const downloadBtn = document.getElementById('downloadDeliveryBtn');
                if (downloadBtn) {
                    downloadBtn.style.display = 'none';
                    downloadBtn.removeAttribute('data-telecom');
                    downloadBtn.removeAttribute('data-agency');
                    downloadBtn.removeAttribute('data-count');
                }
            }
            
            // í†µì‹ ì‚¬ ë° ëŒ€ë¦¬ì  ì„ íƒ ì´ˆê¸°í™”
            const telecomSelect = document.getElementById('telecom');
            const agencySelect = document.getElementById('agency');
            const currentTelecom = telecomSelect.value;
            const currentAgency = agencySelect.value;
            
            // ì¶œë ¥ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™” (ê¸°ì¡´ êµ¬ì¡° ìœ ì§€)
            const outputContainer = document.getElementById('outputContainer');
            outputContainer.style.display = 'block';
            
            // Reset to the original structure with proper agency labels for both ëŸ­ìŠ¤ and ë“œë¸”ë™
            outputContainer.innerHTML = `
                <!-- ëŸ­ìŠ¤ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ) -->
                <div id="luxExtraOutputs" style="display:none;">
                    <div class="form-group">
                        <label for="luxRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                        <textarea id="luxRequestText" class="output-textarea compact-textarea" placeholder="ì‹ ì¡° ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="luxStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                        <textarea id="luxStockText" class="output-textarea compact-textarea" placeholder="ì¬ê³  ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="luxMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                        <textarea id="luxMemoText" class="output-textarea compact-textarea" placeholder="ê°œí†µ ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                </div>
                
                <!-- ë“œë¸”ë™ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ) -->
                <div id="dblackExtraOutputs" style="display:none;">
                    <div class="form-group">
                        <label for="dblackRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                        <textarea id="dblackRequestText" class="output-textarea compact-textarea" placeholder="ì‹ ì¡° ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="dblackStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                        <textarea id="dblackStockText" class="output-textarea compact-textarea" placeholder="ì¬ê³  ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="dblackMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                        <textarea id="dblackMemoText" class="output-textarea compact-textarea" placeholder="ê°œí†µ ìš”ì²­ ì–‘ì‹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    </div>
                </div>
                <style>
                    /* ëŸ­ìŠ¤ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ ìŠ¤íƒ€ì¼ */
                    #luxRequestText, #dblackRequestText {
                        height: 130px !important;
                        min-height: 130px;
                        resize: vertical;
                    }
                    #luxStockText, #dblackStockText {
                        height: 220px !important;
                        min-height: 220px;
                        resize: vertical;
                    }
                    #luxMemoText, #dblackMemoText {
                        height: 150px !important;
                        min-height: 150px;
                        resize: vertical;
                    }
                    #outputText1 {
                        height: 170px !important;
                        min-height: 170px;
                    }
                </style>
                <div id="singleOutputContainer">
                    <div class="form-group">
                        <label id="outputTextLabel" for="outputText">ë³€í™˜ëœ í…ìŠ¤íŠ¸:</label>
                        <textarea id="outputText" class="output-textarea" placeholder="ì—¬ê¸°ì— ë³€í™˜ëœ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤. ë”ë¸”í´ë¦­í•˜ë©´ ë³µì‚¬ë©ë‹ˆë‹¤."></textarea>
                    </div>
                </div>
                <div id="splitOutputContainer" style="display: none;"></div>
            `;
            
            // Reset telecom and agency selects after updating the output container
            telecomSelect.value = '';
            agencySelect.innerHTML = '<option value="">ëŒ€ë¦¬ì ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            agencySelect.disabled = true;
            
            // ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
            setupDoubleClickCopy();
            
            // ì…ë ¥ í•„ë“œì— í¬ì»¤ìŠ¤
            document.getElementById('inputText').focus();
            
            // If the current selection was ëŸ­ìŠ¤ or ë“œë¸”ë™, re-enable the agency select
            if (currentTelecom === 'SK' && (currentAgency === 'ëŸ­ìŠ¤' || currentAgency === 'ë“œë¸”ë™')) {
                updateAgencies();
                document.getElementById('agency').value = currentAgency;
            }
        }
        // ëŒ€ë¦¬ì  ì •ë³´ íŒì—… í•¨ìˆ˜
        function showAgencyInfo() {
            const telecomSelect = document.getElementById('telecom');
            const agencySelect = document.getElementById('agency');
            const selectedTelecom = telecomSelect.value;
            const selectedAgency = agencySelect.value;
            
            if (!selectedTelecom || !selectedAgency) {
                alert('í†µì‹ ì‚¬ì™€ ëŒ€ë¦¬ì ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const popup = document.getElementById('memoPopup');
            const popupTitle = document.getElementById('popupTitle');
            const popupContent = document.getElementById('memoContent');
            
            // íŒì—… ì œëª© ì„¤ì •
            popupTitle.textContent = `${selectedAgency} ì—…ë¬´ ë©”ëª¨`;
            
            // íŒì—… ë‚´ìš© ì„¤ì •
            if (agencyMemos[selectedTelecom] && agencyMemos[selectedTelecom][selectedAgency]) {
                popupContent.textContent = agencyMemos[selectedTelecom][selectedAgency];
            } else {
                popupContent.textContent = 'í•´ë‹¹ ëŒ€ë¦¬ì ì— ëŒ€í•œ ì—…ë¬´ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.';
            }
            
            // íŒì—… í‘œì‹œ
            popup.style.display = 'flex';
        }
        
        // ëŒ€ë¦¬ì  ì •ë³´ íŒì—… ë‹«ê¸° í•¨ìˆ˜
        function closeAgencyInfo() {
            const popup = document.getElementById('memoPopup');
            popup.style.display = 'none';
        }
        // ESC í‚¤ë¡œ íŒì—… ë‹«ê¸°
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeAgencyInfo();
                closeHistoryPopup();
            }
        });
        
        // íŒì—… ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('memoPopup').addEventListener('click', function(event) {
            if (event.target === this) {
                closeAgencyInfo();
            }
        });     

        // utils.jsì—ì„œ ì œê³µí•˜ëŠ” í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
        if (typeof initializeModelDatabase === 'function') {
            initializeModelDatabase();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ìë™ ì ê¸ˆ ê¸°ëŠ¥ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            // ë©”ì¸ ì½˜í…ì¸ ê°€ í‘œì‹œëœ ìƒíƒœì¼ ë•Œë§Œ ìë™ ì ê¸ˆ ì‹œì‘
            const mainContent = document.querySelector('.main-content');
            const passwordModal = document.getElementById('passwordModal');
            
            if (mainContent && mainContent.style.display !== 'none' && 
                passwordModal && passwordModal.style.display === 'none') {
                // ìë™ ì ê¸ˆ ë§¤ë‹ˆì € ì‹œì‘
                autoLockManager = new AutoLockManager();
                console.log(`ìë™ ì ê¸ˆ ê¸°ëŠ¥ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. (${AUTO_LOCK_TIMEOUT_MINUTES}ë¶„ í›„ ìë™ ì ê¸ˆ)`);
            }
        });
        
        document.addEventListener('DOMContentLoaded', function() {
            // ì´ˆê¸° í…ìŠ¤íŠ¸ì—ë¦¬ì–´ì— ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
            setupDoubleClickCopy();
            
            // ëª¨ë¸ ê²€ìƒ‰ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const searchInput = document.getElementById('modelSearch');
            const searchResults = document.getElementById('modelSearchResults');
            
            if (searchInput) {
                // ì…ë ¥ ì´ë²¤íŠ¸
                searchInput.addEventListener('input', (e) => {
                    const results = searchDeviceModel(e.target.value);
                    displayDeviceSearchResults(results);
                });
                
                // í¬ì»¤ìŠ¤ ì•„ì›ƒ ì‹œ ì•½ê°„ì˜ ì§€ì—° í›„ ê²°ê³¼ì°½ ìˆ¨ê¸°ê¸°
                searchInput.addEventListener('blur', () => {
                    setTimeout(() => {
                        searchResults.style.display = 'none';
                    }, 200);
                });
                
                // ì™¸ë¶€ í´ë¦­ ì‹œ ê²°ê³¼ì°½ ìˆ¨ê¸°ê¸°
                document.addEventListener('click', (e) => {
                    if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                        searchResults.style.display = 'none';
                    }
                });
            }
            
            // ì´ˆê¸°í™” ë©”ì‹œì§€ ì¶”ê°€
            const outputText = document.getElementById('outputText');
            if (outputText) {
                outputText.placeholder = 'ì—¬ê¸°ì— ë³€í™˜ëœ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤. ë”ë¸”í´ë¦­í•˜ë©´ ë³µì‚¬ë©ë‹ˆë‹¤.';
                // í´ë˜ìŠ¤ ì¶”ê°€
                outputText.classList.add('output-textarea');
            }
            
            // ì…ë ¥ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ì— í´ë˜ìŠ¤ ì¶”ê°€
            const inputText = document.getElementById('inputText');
            if (inputText) {
                inputText.classList.add('input-textarea');
            }
        });

        function setupEventListeners() {
            document.getElementById('convertBtn').addEventListener('click', handleConvert);
            document.getElementById('copyBtn').addEventListener('click', handleCopy);
            document.getElementById('clearBtn').addEventListener('click', handleClear);
            
            // ì´ë²¤íŠ¸ ìœ„ì„ ì‚¬ìš©
            document.getElementById('outputContainer').addEventListener('dblclick', handleDoubleClick);
        }
        // ì´ë²¤íŠ¸ ê´€ë¦¬ í´ë˜ìŠ¤
        class EventManager {
            static init() {
                this.setupTelecomEvents();
                this.setupAgencyEvents();
                this.setupConversionEvents();
                this.setupCopyEvents();
            }

            static setupTelecomEvents() {
                const telecomSelect = document.getElementById('telecom');
                if (telecomSelect) {
                    telecomSelect.addEventListener('change', () => {
                        updateAgencies();
                        this.clearOutputs();
                    });
                }
            }

            static setupAgencyEvents() {
                const agencySelect = document.getElementById('agency');
                if (agencySelect) {
                    agencySelect.addEventListener('change', () => {
                        const agencyInfoBtn = document.getElementById('agencyInfoBtn');
                        if (agencyInfoBtn) {
                            agencyInfoBtn.disabled = !agencySelect.value;
                        }
                        this.clearOutputs();
                    });
                }
            }

            static setupConversionEvents() {
                const convertBtn = document.getElementById('convertBtn');
                if (convertBtn) {
                    convertBtn.addEventListener('click', () => {
                        convertFormat();
                    });
                }
            }

            static setupCopyEvents() {
                const copyBtn = document.getElementById('copyBtn');
                if (copyBtn) {
                    copyBtn.addEventListener('click', () => {
                        handleCopy();
                    });
                }
            }

            static clearOutputs() {
                OutputManager.hideAllContainers();
            }
        }



        // ìë™ ì ê¸ˆ ê¸°ëŠ¥ í´ë˜ìŠ¤
        class AutoLockManager {
            constructor(timeoutMinutes = AUTO_LOCK_TIMEOUT_MINUTES) { // ìƒìˆ˜ ì‚¬ìš©
                this.timeoutDuration = timeoutMinutes * 60 * 1000; // ë°€ë¦¬ì´ˆë¡œ ë³€í™˜
                this.timeoutId = null;
                this.isLocked = false;
                this.lastActivityTime = Date.now();
                
                // í™œë™ ê°ì§€ ì´ë²¤íŠ¸ë“¤
                this.activityEvents = [
                    'mousedown', 'mousemove', 'keypress', 'scroll', 
                    'touchstart', 'click', 'keydown', 'input', 'change'
                ];
                
                this.init();
            }
            
            init() {
                console.log(`ìë™ ì ê¸ˆ ê¸°ëŠ¥ ì´ˆê¸°í™”: ${this.timeoutDuration / 60000}ë¶„ í›„ ìë™ ì ê¸ˆ`);
                this.setupActivityListeners();
                this.startTimer();
            }
            
            setupActivityListeners() {
                // ëª¨ë“  í™œë™ ì´ë²¤íŠ¸ì— ëŒ€í•´ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
                this.activityEvents.forEach(event => {
                    document.addEventListener(event, () => {
                        this.resetTimer();
                    }, true);
                });
                
                // ì°½ í¬ì»¤ìŠ¤ ì´ë²¤íŠ¸ë„ ì¶”ê°€
                window.addEventListener('focus', () => {
                    this.resetTimer();
                });
            }
            
            startTimer() {
                this.clearTimer();
                this.timeoutId = setTimeout(() => {
                    this.lockApplication();
                }, this.timeoutDuration);
                
                this.lastActivityTime = Date.now();
            }
            
            resetTimer() {
                if (!this.isLocked) {
                    this.startTimer();
                }
            }
            
            clearTimer() {
                if (this.timeoutId) {
                    clearTimeout(this.timeoutId);
                    this.timeoutId = null;
                }
            }
            
            lockApplication() {
                console.log('ìë™ ì ê¸ˆ í™œì„±í™”: ì¼ì • ì‹œê°„ ë™ì•ˆ í™œë™ì´ ì—†ì–´ ì ê¸ˆ ì²˜ë¦¬ë©ë‹ˆë‹¤.');
                this.isLocked = true;
                this.clearTimer();
                
                // ë©”ì¸ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
                const mainContent = document.querySelector('.main-content');
                if (mainContent) {
                    mainContent.style.display = 'none';
                }
                
                // ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ í‘œì‹œ
                const passwordModal = document.getElementById('passwordModal');
                if (passwordModal) {
                    passwordModal.style.display = 'flex';
                    
                    // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™” ë° í¬ì»¤ìŠ¤
                    const passwordInput = document.getElementById('passwordInput');
                    if (passwordInput) {
                        passwordInput.value = '';
                        passwordInput.focus();
                    }
                    
                    // ì—ëŸ¬ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
                    const passwordError = document.getElementById('passwordError');
                    if (passwordError) {
                        passwordError.style.display = 'none';
                    }
                }
                
                // ì ê¸ˆ ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ (ì„ íƒì‚¬í•­)
                this.showLockNotification();
            }
            
            unlockApplication() {
                console.log('ìë™ ì ê¸ˆ í•´ì œ: ì •ìƒì ìœ¼ë¡œ ì ê¸ˆì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                this.isLocked = false;
                this.startTimer(); // íƒ€ì´ë¨¸ ì¬ì‹œì‘
            }
            
            showLockNotification() {
                // ì„ì‹œ ì•Œë¦¼ div ìƒì„±
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #f44336;
                    color: white;
                    padding: 15px 20px;
                    border-radius: 5px;
                    z-index: 10000;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
                    font-size: 14px;
                    font-weight: bold;
                `;
                notification.textContent = 'ë³´ì•ˆì„ ìœ„í•´ ìë™ìœ¼ë¡œ ì ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤.';
                
                document.body.appendChild(notification);
                
                // 3ì´ˆ í›„ ì•Œë¦¼ ì œê±°
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 3000);
            }
            
            // íƒ€ì„ì•„ì›ƒ ì‹œê°„ ë³€ê²½ ë©”ì„œë“œ
            setTimeoutDuration(minutes) {
                this.timeoutDuration = minutes * 60 * 1000;
                console.log(`ìë™ ì ê¸ˆ ì‹œê°„ì´ ${minutes}ë¶„ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                if (!this.isLocked) {
                    this.startTimer(); // ìƒˆë¡œìš´ ì‹œê°„ìœ¼ë¡œ íƒ€ì´ë¨¸ ì¬ì‹œì‘
                }
            }
            
            // ë‚¨ì€ ì‹œê°„ í™•ì¸ ë©”ì„œë“œ (ë””ë²„ê¹…ìš©)
            getRemainingTime() {
                if (this.isLocked) return 0;
                const elapsed = Date.now() - this.lastActivityTime;
                const remaining = Math.max(0, this.timeoutDuration - elapsed);
                return Math.ceil(remaining / 1000); // ì´ˆ ë‹¨ìœ„ë¡œ ë°˜í™˜
            }
        }
        
        // ì „ì—­ ìë™ ì ê¸ˆ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (í˜ì´ì§€ ë¡œë“œ í›„)
        let autoLockManager = null;
        
        // ìë™ ì ê¸ˆ ì‹œê°„ ì„¤ì • í•¨ìˆ˜ (ì½˜ì†”ì—ì„œ ì‚¬ìš©)
        function setAutoLockTime(minutes) {
            if (autoLockManager) {
                autoLockManager.setTimeoutDuration(minutes);
                return `ìë™ ì ê¸ˆ ì‹œê°„ì´ ${minutes}ë¶„ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`;
            } else {
                return 'ìë™ ì ê¸ˆ ë§¤ë‹ˆì €ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
            }
        }
        
        // ìë™ ì ê¸ˆ ìƒíƒœ í™•ì¸ í•¨ìˆ˜ (ì½˜ì†”ì—ì„œ ì‚¬ìš©)
        function getAutoLockStatus() {
            if (autoLockManager) {
                const remaining = autoLockManager.getRemainingTime();
                const minutes = Math.floor(remaining / 60);
                const seconds = remaining % 60;
                return {
                    isLocked: autoLockManager.isLocked,
                    remainingTime: `${minutes}ë¶„ ${seconds}ì´ˆ`,
                    remainingSeconds: remaining
                };
            } else {
                return 'ìë™ ì ê¸ˆ ë§¤ë‹ˆì €ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
            }
        }
        
        // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ
        window.setAutoLockTime = setAutoLockTime;
        window.getAutoLockStatus = getAutoLockStatus;
        
    </script>
    </div> <!-- main-content ë‹«ëŠ” íƒœê·¸ -->
</body>
</html>

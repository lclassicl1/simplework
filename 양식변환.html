<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—…ë¬´ ë„ìš°ë¯¸</title>
    <!-- SheetJS ìŠ¤íƒ€ì¼ë§ ì§€ì› ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
    <!-- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ -->
    <script src="js/utils.js"></script>
    <!-- ì—‘ì…€ ê´€ë¦¬ ëª¨ë“ˆ -->
    <script src="js/excel-manager.js"></script>
    <!-- ëŒ€ë¦¬ì  ì„¤ì • ë°ì´í„° -->
    <script src="js/agencies-config.js"></script>
    <!-- ì•± ì„¤ì • ë°ì´í„° (ì‚¬ì´íŠ¸, ìƒìˆ˜ ë“±) -->
    <script src="js/app-config.js"></script>
    <!-- í…œí”Œë¦¿ ì„¤ì • ë°ì´í„° (TELECOM_CONFIG) -->
    <script src="js/templates-config.js"></script>
    <!-- ëª¨ë¸ ìƒ‰ìƒ ì„¤ì • ë°ì´í„° -->
    <script src="js/model-colors-config.js"></script>
    <style>
        /* ì¶œì‹œìƒ‰ìƒ ê²€ìƒ‰ ê²°ê³¼ ìŠ¤íƒ€ì¼ */
        .model-result:hover {
            background-color: #f5f5f5;
        }

        .model-result:last-child {
            border-bottom: none !important;
        }

        /* ìƒ‰ìƒ ì›í˜• ìŠ¤íƒ€ì¼ */
        .color-dot {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
            border: 1px solid #ddd;
            vertical-align: middle;
        }

        /* ê²€ìƒ‰ ê²°ê³¼ ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        #modelSearchResults::-webkit-scrollbar {
            width: 8px;
        }

        #modelSearchResults::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        #modelSearchResults::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        #modelSearchResults::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Toast Notification Styles */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
            font-size: 14px;
            font-weight: 500;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }

        .layout-container {
            display: flex;
            gap: 20px;
        }

        .input-column {
            flex: 1;
        }

        .output-column {
            flex: 1;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        select, textarea, input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        select {
            background-color: white;
            cursor: pointer;
        }

        textarea {
            resize: vertical;
        }

        .input-textarea {
            min-height: 300px;
        }

        .output-textarea {
            min-height: 300px;
        }
        
        /* ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ ì „ìš© textarea ìŠ¤íƒ€ì¼ */
        .drblack-request-textarea {
            min-height: 150px;  /* ê¸°ì¡´ ë†’ì´ì˜ ì ˆë°˜ */
            height: 150px;      /* ê³ ì • ë†’ì´ ì„¤ì • */
            resize: vertical;   /* ì„¸ë¡œ í¬ê¸° ì¡°ì ˆë§Œ ê°€ëŠ¥í•˜ë„ë¡ */
        }

        /* ì˜¤ì•¤í‹° ì‹ ì¡°ìš”ì²­ ì „ìš© textarea ìŠ¤íƒ€ì¼ */
        #ontRequestText {
            height: 120px !important;
            min-height: 120px;
            resize: vertical;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #convertBtn {
            background-color: #4CAF50;
            color: white;
            flex: 2;
        }

        #convertBtn:hover {
            background-color: #45a049;
        }

        #copyBtn {
            background-color: #2196F3;
            color: white;
            flex: 1;
        }

        #copyBtn:hover {
            background-color: #0b7dda;
        }

        #clearBtn {
            background-color: #f44336;
            color: white;
            flex: 1;
        }

        #clearBtn:hover {
            background-color: #d32f2f;
        }

        #outputText {
            background-color: #f9f9f9;
        }

        .output-section {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }

        .output-section h3 {
            margin-bottom: 10px;
            color: #333;
        }
        
        /* URL ì„ íƒë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .url-container {
            margin-bottom: 20px;
            width: 50%;
            margin-right: auto;
            margin-left: 0;
        }
        
        .url-select {
            width: auto;
            min-width: 200px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            background-color: #f8f9fa;
            cursor: pointer;
        }
        
        /* ëŒ€ë¦¬ì  ë©”ëª¨ íŒì—… ìŠ¤íƒ€ì¼ */
        .info-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 14px;
            cursor: pointer;
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
        }
        
        .info-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .popup-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .popup-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        /* ì´ë ¥ ëª©ë¡ ìŠ¤íƒ€ì¼ */
        .history-list {
            margin: 10px 0;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .history-item {
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .history-item:hover {
            background-color: #f5f5f5;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .history-name {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .history-phone {
            color: #555;
            flex-grow: 1;
        }
        
        .history-time {
            color: #888;
            font-size: 0.9em;
        }
        
        .history-details {
            margin: 5px 0;
            color: #333;
        }
        
        .history-model {
            display: inline-block;
            margin-right: 10px;
        }
        
        .history-plan {
            color: #2c7be5;
        }
        
        .history-footer {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
            color: #666;
        }
        
        .no-history {
            text-align: center;
            padding: 20px;
            color: #888;
        }
        
        .history-actions {
            text-align: right;
            margin-top: 15px;
        }
        
        .btn-clear-history {
            background-color: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .btn-clear-history:hover {
            background-color: #cc0000;
        }
        
        .popup-close {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
            color: #666;
        }
        
        .popup-title {
            margin-top: 0;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .memo-content {
            white-space: pre-line;
            line-height: 1.5;
        }
        
        /* í‚¤-ê°’ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .key-value-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }
        
        .key-value-table th {
            background-color: #f5f5f5;
            padding: 6px 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #ddd;
            width: 30%;
            font-size: 12px;
        }
        
        .key-value-table td {
            padding: 5px 8px;
            border: 1px solid #ddd;
            cursor: pointer;
            position: relative;
            transition: background-color 0.2s;
            font-size: 13px;
            line-height: 1.3;
        }
        
        .key-value-table td:hover {
            background-color: #f0f8ff;
        }
        
        .key-value-table td::after {
            content: "í´ë¦­í•˜ì—¬ ë³µì‚¬";
            position: absolute;
            right: 8px;
            color: #999;
            font-size: 10px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .key-value-table td:hover::after {
            opacity: 1;
        }
        
        .key-value-table td.copied {
            background-color: #e6ffe6;
        }
        
        .key-value-table td.copied::after {
            content: "ë³µì‚¬ë¨!";
            color: #4CAF50;
            opacity: 1;
            font-size: 10px;
        }
        
        .copy-notice {
            text-align: center;
            margin-bottom: 10px;
            color: #666;
            font-style: italic;
            font-size: 12px;
        }

        @media (max-width: 900px) {
            .layout-container {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }

        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ */
        .output-textarea {
            width: 100%;
            min-height: 200px;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: 'Nanum Gothic', sans-serif;
            font-size: 14px;
            resize: vertical;
        }
        
        /* ACT íƒë°°ìš© ì‘ì€ textarea */
        .act-stock-textarea {
            min-height: 100px !important;
            height: 100px !important;
        }

        /* ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        #passwordModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .password-modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            text-align: center;
            min-width: 300px;
        }

        .password-modal-content h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .password-input {
            width: 200px;
            padding: 15px;
            font-size: 18px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
            letter-spacing: 3px;
        }

        .password-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        .password-submit {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }

        .password-submit:hover {
            background-color: #45a049;
        }

        .password-error {
            color: #f44336;
            margin-top: 10px;
            font-size: 14px;
        }

        .main-content {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ëª¨ë‹¬ -->
    <div id="passwordModal">
        <div class="password-modal-content">
            <h2>ğŸ”’ ì ‘ê·¼ ì¸ì¦</h2>
            <p>4ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
            <input type="password" id="passwordInput" class="password-input" maxlength="4" placeholder="****" autocomplete="off">
            <br>
            <button onclick="checkPassword()" class="password-submit">í™•ì¸</button>
            <div id="passwordError" class="password-error" style="display: none;"></div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="main-content">
    <div class="container">
        <h1>í•œê²°ì´ ì—…ë¬´ ë„ìš°ë¯¸</h1>
        
        <div class="url-container" style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px; flex-wrap: nowrap; width: 100%;">
            <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                <label for="usefulUrls" style="font-size: 14px; color: #555;">ìœ ìš©í•œ ì‚¬ì´íŠ¸:</label>
                <select id="usefulUrls" onchange="openSelectedUrl()" style="min-width: 200px; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <!-- ì‚¬ì´íŠ¸ ëª©ë¡ì€ ì´ê³³ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </select>
            </div>
            
                          <div style="display: flex; flex-direction: column; gap: 8px; margin-left: 20px;">
                  <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                      <label for="excelFile" style="font-size: 14px; color: #555;">ì–´ë“œë¯¼ ì—‘ì…€ ì²¨ë¶€ë¡œ ì ‘ìˆ˜í™•ì¸/ì‹ ì¡°ìš”ì²­ ì–‘ì‹ ë§Œë“¤ê¸°:</label>
                      <input type="file" id="excelFile" accept=".xlsx, .xls" style="font-size: 14px;"/>
                      <span id="extractCount" style="font-size: 14px; color: #2196F3; margin-left: 10px; font-weight: bold;"></span>
                  </div>
                  <div style="display: flex; flex-direction: column; gap: 5px;">
                      <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap;">
                          <label for="excelFile2" style="font-size: 14px; color: #555;">ì–´ë“œë¯¼ ì—‘ì…€ ì²¨ë¶€ë¡œ ëŒ€ë¦¬ì ë³„ ë°°ì†¡ìš”ì²­ ì—‘ì…€ ìƒì„±(ëŒ€ë¦¬ì  ë¨¼ì € ì„ íƒ í•„ìˆ˜)</label>
                          <input type="file" id="excelFile2" accept=".xlsx, .xls" style="font-size: 14px;"/>
                          <span id="extractCount2" style="font-size: 14px; color: #e91e63; margin-left: 10px; font-weight: bold;"></span>
                      </div>
                      <div style="margin-left: 5px;">
                          <button id="downloadDeliveryBtn" onclick="downloadDeliveryExcel()" style="display: none; background-color: #4CAF50; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">ë°°ì†¡ìš”ì²­ì–‘ì‹ ë‹¤ìš´ë¡œë“œ</button>
                      </div>
                  </div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 5px; white-space: nowrap; margin-left: auto;">
                <label for="modelSearch" style="font-size: 14px; color: #555;">ì¶œì‹œìƒ‰ìƒ ê²€ìƒ‰:</label>
                <div style="position: relative; min-width: 250px;">
                    <input type="text" id="modelSearch" 
                           placeholder="ì˜ˆ: ì•„ì´í°16, S24" 
                           style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                    <div id="modelSearchResults" style="display: none; position: absolute; top: 100%; left: 0; right: 0; 
                          background: white; border: 1px solid #ddd; border-radius: 4px; max-height: 300px; 
                          overflow-y: auto; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                    </div>
                </div>
            </div>
        </div>
        
        <div class="layout-container">
            <!-- ì…ë ¥ ì»¨í…Œì´ë„ˆ (ì™¼ìª½ ì˜ì—­) -->
            <div class="input-column">
                <div class="form-row">
                    <div class="form-group">
                        <label for="telecom">í†µì‹ ì‚¬ ì„ íƒ:</label>
                        <select id="telecom" onchange="updateAgencies()">
                            <option value="">í†µì‹ ì‚¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="SK">SK</option>
                            <option value="KT">KT</option>
                            <option value="LG">LG</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="agency">ëŒ€ë¦¬ì  ì„ íƒ:</label>
                        <div style="display: flex; align-items: center;">
                            <select id="agency" disabled>
                                <option value="">ëŒ€ë¦¬ì ì„ ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                            <button type="button" id="agencyInfoBtn" class="info-button" onclick="showAgencyInfo()" disabled>i</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="deviceSerial">ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸:</label>
                        <input type="text" id="deviceSerial" class="form-control" placeholder="ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    
                    <div class="form-group">
                        <label for="simSerial">ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸:</label>
                        <input type="text" id="simSerial" class="form-control" placeholder="ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="inputText">ì›ë³¸ í…ìŠ¤íŠ¸:</label>
                    <textarea id="inputText" class="input-textarea" placeholder="ì—¬ê¸°ì— ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                
                <div class="button-group">
                    <button id="convertBtn" onclick="convertFormat()">ë³€í™˜í•˜ê¸°</button>
                    <button id="historyBtn" onclick="HistoryManager.openHistoryPopup()">ë³€í™˜ë‚´ì—­ì¡°íšŒ</button>
                    <button id="clearBtn" onclick="clearAll()">ëª¨ë‘ ì§€ìš°ê¸°</button>
                </div>
            </div>
            
            <!-- ì¶œë ¥ ì»¨í…Œì´ë„ˆ (ì˜¤ë¥¸ìª½ ì˜ì—­) -->
            <div class="output-column">
                <div id="outputContainer" style="display: block;">
                    <!-- ëŸ­ìŠ¤ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ/ìš°ì£¼íŒ¨ìŠ¤) -->
                    <div id="luxExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="luxRequestText">ëŸ­ìŠ¤ ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxStockText">ëŸ­ìŠ¤ ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxMemoText">ëŸ­ìŠ¤ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxUniverseText">ëŸ­ìŠ¤ ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹:</label>
                            <textarea id="luxUniverseText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- íë¸Œ ì „ìš© ì¶”ê°€ textarea (ì¬ê³ /ê°œí†µ/ìš°ì£¼íŒ¨ìŠ¤) -->
                    <div id="cubeExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="cubeStockText">íë¸Œ ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="cubeStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="cubeOpenText">íë¸Œ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="cubeOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="cubeUniverseText">íë¸Œ ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹:</label>
                            <textarea id="cubeUniverseText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë“œë¸”ë™ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°/ì¬ê³ /ê°œí†µ) -->
                    <div id="dblackExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="dblackRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    <style>
                        #luxRequestText {
                            height: 130px !important;
                            min-height: 130px;
                            resize: vertical;
                        }
                        #luxStockText {
                            height: 110px !important;
                            min-height: 110px;
                            resize: vertical;
                        }
                        #luxMemoText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #luxUniverseText {
                            height: 120px !important;
                            min-height: 120px;
                            resize: vertical;
                        }
                        
                        /* íë¸Œ textarea ìŠ¤íƒ€ì¼ */
                        #cubeStockText {
                            height: 130px !important;
                            min-height: 130px;
                            resize: vertical;
                        }
                        #cubeOpenText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #cubeUniverseText {
                            height: 120px !important;
                            min-height: 120px;
                            resize: vertical;
                        }
                        /* ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ textarea ìŠ¤íƒ€ì¼ */
                        #dblackRequestText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #outputText1 {
                            height: 170px !important;
                            min-height: 170px;
                        }
                        
                        /* íœ´ë„· textarea ìŠ¤íƒ€ì¼ */
                        #hunetConfirmText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #hunetDeliveryText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        #hunetOpenText {
                            height: 150px !important;
                            min-height: 150px;
                            resize: vertical;
                        }
                        
                        /* ë°€ë¦¬ì–¸ textarea ìŠ¤íƒ€ì¼ */
                        #millionRequestText {
                            height: 100px !important;
                            min-height: 100px;
                            resize: vertical;
                        }
                        
                        /* ë°€ë¦¬ì–¸ ë°°ì •ìš”ì²­ textarea ìŠ¤íƒ€ì¼ (ì ˆë°˜ í¬ê¸°) */
                        #millionStockText {
                            height: 100px !important;
                            min-height: 100px;
                            resize: vertical;
                        }
                        
                        /* í•œì˜¬ ì ‘ìˆ˜í™•ì¸ textarea ìŠ¤íƒ€ì¼ (ì ˆë°˜ í¬ê¸°) */
                        #hanolConfirmText {
                            height: 70px !important;
                            min-height: 70px;
                            resize: vertical;
                        }
                    </style>
                    <div id="singleOutputContainer">
                        <div class="form-group">
                            <label id="outputTextLabel" for="outputText">ë³€í™˜ëœ í…ìŠ¤íŠ¸:</label>
                            <textarea id="outputText" class="output-textarea"></textarea>
                        </div>
                    </div>
                    
                    <div id="splitOutputContainer" style="display: none;">
                    </div>
                    
                    <!-- ACT(íƒë°°) ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸/ê°œí†µìš”ì²­) -->
                    <div id="actExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="actStockText">ACT(íƒë°°) ì ‘ìˆ˜í™•ì¸ì–‘ì‹:</label>
                            <textarea id="actStockText" class="output-textarea compact-textarea act-stock-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="actOpenText">ACT(íƒë°°) ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="actOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë¹„ì•¤ì»´ ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸&ì‹ ì¡°ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="bncomExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="bncomStockText">ë¹„ì•¤ì»´ ì ‘ìˆ˜í™•ì¸&ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="bncomStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="bncomOpenText">ë¹„ì•¤ì»´ ê°œí†µìš”ì²­:</label>
                            <textarea id="bncomOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- íœ´ë„· ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸/ë°°ì†¡ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="hunetExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="hunetConfirmText">íœ´ë„· ì ‘ìˆ˜í™•ì¸ì–‘ì‹:</label>
                            <textarea id="hunetConfirmText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hunetDeliveryText">íœ´ë„· ë°°ì†¡ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hunetDeliveryText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hunetOpenText">íœ´ë„· ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hunetOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ë°€ë¦¬ì–¸ ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°ìš”ì²­/ë°°ì •ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="millionExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="millionRequestText">ë°€ë¦¬ì–¸ ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="millionRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="millionStockText">ë°€ë¦¬ì–¸ ë°°ì •ìš”ì²­:</label>
                            <textarea id="millionStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="millionMemoText">ë°€ë¦¬ì–¸ ê°œí†µìš”ì²­:</label>
                            <textarea id="millionMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ì˜¤ì•¤í‹° ì „ìš© ì¶”ê°€ textarea (ì‹ ì¡°ìš”ì²­/ë°°ì •ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="ontExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="ontRequestText">ì˜¤ì•¤í‹° ì‹ ì¡°ìš”ì²­:</label>
                            <textarea id="ontRequestText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="ontStockText">ì˜¤ì•¤í‹° ë°°ì •ìš”ì²­:</label>
                            <textarea id="ontStockText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="ontMemoText">ì˜¤ì•¤í‹° ê°œí†µìš”ì²­:</label>
                            <textarea id="ontMemoText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ì¥ì²œ ì „ìš© ì¶”ê°€ textarea (ë°°ì†¡ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="jangcheonExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="jangcheonDeliveryText">ì¥ì²œ ë°°ì†¡ìš”ì²­:</label>
                            <textarea id="jangcheonDeliveryText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="jangcheonOpenText">ì¥ì²œ ê°œí†µìš”ì²­:</label>
                            <textarea id="jangcheonOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- í•œì˜¬ ì „ìš© ì¶”ê°€ textarea (ì ‘ìˆ˜í™•ì¸/ë°°ì†¡ìš”ì²­/ê°œí†µìš”ì²­) -->
                    <div id="hanolExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="hanolConfirmText">í•œì˜¬ ì ‘ìˆ˜í™•ì¸ì–‘ì‹:</label>
                            <textarea id="hanolConfirmText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hanolDeliveryText">í•œì˜¬ ë°°ì†¡ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hanolDeliveryText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hanolOpenText">í•œì˜¬ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="hanolOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <!-- ì½”ì›¨ì–´ ì „ìš© ì¶”ê°€ textarea (ê°œí†µìš”ì²­/ìš°ì£¼íŒ¨ìŠ¤) -->
                    <div id="cowareExtraOutputs" style="display:none;">
                        <div class="form-group">
                            <label for="cowareOpenText">ì½”ì›¨ì–´ ê°œí†µìš”ì²­ ì–‘ì‹:</label>
                            <textarea id="cowareOpenText" class="output-textarea compact-textarea"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="cowareSpacePassText">ì½”ì›¨ì–´ ìš°ì£¼íŒ¨ìŠ¤ ì–‘ì‹:</label>
                            <textarea id="cowareSpacePassText" class="output-textarea compact-textarea"></textarea>
                        </div>
                    </div>
                    
                    <div id="keyValueTableContainer" style="display: none;">
                        <div class="copy-notice">ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.</div>
                        <table class="key-value-table" id="keyValueTable">
                            <tbody>
                                <!-- í‚¤-ê°’ í–‰ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- ì–‘ì‹ì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš°ë¥¼ ìœ„í•œ í…œí”Œë¦¿ -->
                <div id="splitOutputTemplate" style="display: none;">
                    <div class="output-section">
                        <h3>ì¬ê³ ìš”ì²­:</h3>
                        <textarea id="outputText1" class="output-textarea"></textarea>
                    </div>
                    <div class="output-section">
                        <h3>ê°œí†µìš”ì²­:</h3>
                        <textarea id="outputText2" class="output-textarea"></textarea>
                    </div>
                </div>
                
                <!-- í‚¤-ê°’ í…Œì´ë¸” í…œí”Œë¦¿ -->
                <div id="keyValueTableTemplate" style="display: none;">
                    <div class="copy-notice">ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.</div>
                    <table class="key-value-table" id="keyValueTable">
                        <tbody>
                            <!-- í‚¤-ê°’ í–‰ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast">í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</div>
    
    <!-- ë³€í™˜ ì´ë ¥ íŒì—… -->
    <div id="historyPopup" class="popup-overlay">
        <div class="popup-content" style="max-width: 800px;">
                            <span class="popup-close" onclick="HistoryManager.closeHistoryPopup()">&times;</span>
            <h3 class="popup-title">ë³€í™˜ ì´ë ¥</h3>
            <div id="historyList" class="history-list">
                <!-- ì´ë ¥ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            <div class="history-actions">
                <button onclick="HistoryManager.clearHistory()" class="btn-clear-history">ì „ì²´ ì‚­ì œ</button>
            </div>
        </div>
    </div>
    
    <!-- ëŒ€ë¦¬ì  ë©”ëª¨ íŒì—… -->
    <div id="memoPopup" class="popup-overlay">
        <div class="popup-content">
            <span class="popup-close" onclick="closeAgencyInfo()">&times;</span>
            <h3 class="popup-title" id="popupTitle">ëŒ€ë¦¬ì  ì—…ë¬´ ë©”ëª¨</h3>
            <div class="memo-content" id="memoContent"></div>
        </div>
    </div>
    
    <script>
        // í…œí”Œë¦¿ ê´€ë¦¬ í´ë˜ìŠ¤
        class TemplateManager {
            static getTemplate(telecom, agency) {
                const agencyConfig = TELECOM_CONFIG[telecom]?.agencies[agency];
                if (!agencyConfig) return null;
                
                return agencyConfig.templates || agencyConfig.template;
            }

            static applyTemplate(telecom, agency, customerInfo) {
                const template = this.getTemplate(telecom, agency);
                if (!template) throw new Error('í…œí”Œë¦¿ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');

                const agencyConfig = TELECOM_CONFIG[telecom].agencies[agency];
                
                switch(agencyConfig.outputType) {
                    case 'split':
                        return {
                            stockRequest: template.stockRequest(customerInfo),
                            openRequest: template.openRequest(customerInfo)
                        };
                    case 'multi':
                        // íœ´ë„·ê³¼ ì˜¤ì•¤í‹°ì˜ ê²½ìš° íŠ¹ë³„í•œ ì²˜ë¦¬
                        if (agency === 'ì œì´/íœ´ë„·') {
                            return {
                                confirm: template.confirm(customerInfo),
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else if (agency === 'ì˜¤ì•¤í‹°') {
                            return {
                                request: template.request(customerInfo),
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else if (agency === 'ì¥ì²œ') {
                            return {
                                delivery: template.delivery(customerInfo),
                                open: template.open(customerInfo)
                            };
                        } else if (agency === 'ëŸ­ìŠ¤') {
                            return {
                                request: template.request(customerInfo),
                                stock: template.delivery(customerInfo),  // ë°°ì†¡/ì¬ê³  ìš”ì²­ì„œë¥¼ ì¬ê³ ìš”ì²­ì–‘ì‹ìœ¼ë¡œ
                                open: template.open(customerInfo),       // ê°œí†µìš”ì²­ì–‘ì‹
                                universe: template.universe(customerInfo) // ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹
                            };
                        } else if (agency === 'íë¸Œ') {
                            return {
                                stock: template.stockRequest(customerInfo),   // ì¬ê³ ìš”ì²­
                                open: template.openRequest(customerInfo),     // ê°œí†µìš”ì²­
                                universe: template.universe(customerInfo)     // ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹
                            };
                        } else if (agency === 'í•œì˜¬') {
                            return {
                                confirm: template.confirm(customerInfo),   // ì ‘ìˆ˜í™•ì¸ì–‘ì‹
                                delivery: template.delivery(customerInfo), // ë°°ì†¡ìš”ì²­ì–‘ì‹
                                open: template.open(customerInfo)          // ê°œí†µìš”ì²­ì–‘ì‹
                            };
                        } else if (agency === 'ì½”ì›¨ì–´') {
                            return {
                                openRequest: template.openRequest(customerInfo),   // ê°œí†µìš”ì²­ì–‘ì‹
                                spacePass: template.spacePass(customerInfo)        // ìš°ì£¼íŒ¨ìŠ¤ì–‘ì‹
                            };
                    } else {
                            return {
                                request: template.request(customerInfo),
                                stock: template.stock(customerInfo),
                                memo: template.memo(customerInfo)
                            };
                        }
                    case 'table':
                        return template(customerInfo);
                    default:
                        return template(customerInfo);
                }
            }
        }

        // ì¶œë ¥ ê´€ë¦¬ í´ë˜ìŠ¤
        class OutputManager {
            static showOutput(result, outputType, telecom, agency) {
                // ëª¨ë“  ì¶œë ¥ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
                this.hideAllContainers();
                
                switch(outputType) {
                    case 'split':
                        this.showSplitOutput(result);
                        break;
                    case 'multi':
                        this.showMultiOutput(result, agency);
                        break;
                    case 'table':
                        this.showTableOutput(result);
                        break;
                    default:
                        this.showSingleOutput(result);
                }
            }

            static hideAllContainers() {
                const containers = [
                    'luxExtraOutputs',
                    'dblackExtraOutputs',
                    'singleOutputContainer',
                    'splitOutputContainer',
                    'keyValueTableContainer',
                    'actExtraOutputs',
                    'bncomExtraOutputs',
                    'hunetExtraOutputs',
                    'millionExtraOutputs',
                    'ontExtraOutputs',
                    'jangcheonExtraOutputs',
                    'hanolExtraOutputs',
                    'cowareExtraOutputs'
                ];
                
                containers.forEach(id => {
                    const container = document.getElementById(id);
                    if (container) container.style.display = 'none';
                });
                
                // íë¸Œ ì»¨í…Œì´ë„ˆë„ ìˆ¨ê¸°ê¸°
                const cubeContainer = document.getElementById('cubeExtraOutputs');
                if (cubeContainer) cubeContainer.style.display = 'none';
                
                // ì¶”ê°€ í…ìŠ¤íŠ¸ div ì œê±°
                const additionalTextDiv = document.getElementById('additionalTextDiv');
                if (additionalTextDiv) {
                    additionalTextDiv.remove();
                }
            }

            static showSplitOutput(result) {
                const container = document.getElementById('splitOutputContainer');
                if (!container) return;

                // í˜„ì¬ ì„ íƒëœ ëŒ€ë¦¬ì  ê°€ì ¸ì˜¤ê¸°
                const agencySelect = document.getElementById('agency');
                const selectedAgency = agencySelect ? agencySelect.value : '';

                // ì¹´íŒŒ, ì‚¼ë³´(ì˜¨ë¼ì¸), ì´ì•¤í‹°ì¼ ë•Œ íŠ¹ë³„ ë¼ë²¨ ì‚¬ìš©
                let firstLabel = 'ì ‘ìˆ˜í™•ì¸';
                if (selectedAgency === 'ì¹´íŒŒ') {
                    firstLabel = 'ë°°ì†¡ìš”ì²­';
                } else if (selectedAgency === 'ì‚¼ë³´(ì˜¨ë¼ì¸)') {
                    firstLabel = 'ì¬ê³ ìš”ì²­';
                } else if (selectedAgency === 'ì´ì•¤í‹°') {
                    firstLabel = 'ë°°ì†¡ìš”ì²­';
                }

                container.style.display = 'block';
                container.innerHTML = `
                    <div class="form-group">
                        <label for="outputText1">${selectedAgency} ${firstLabel}:</label>
                        <textarea id="outputText1" class="output-textarea">${result.stockRequest || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="outputText2">${selectedAgency} ê°œí†µìš”ì²­:</label>
                        <textarea id="outputText2" class="output-textarea">${result.openRequest || ''}</textarea>
                    </div>
                `;
            }

            static showMultiOutput(result, agency) {
                let container;
                
                // ëŒ€ë¦¬ì ì— ë”°ë¥¸ ì»¨í…Œì´ë„ˆ ì„ íƒ
                if (agency === 'ë“œë¸”ë™') {
                    container = document.getElementById('dblackExtraOutputs');
                } else if (agency === 'ì œì´/íœ´ë„·') {
                    container = document.getElementById('hunetExtraOutputs');
                } else if (agency === 'ë°€ë¦¬ì–¸') {
                    container = document.getElementById('millionExtraOutputs');
                } else if (agency === 'ì˜¤ì•¤í‹°') {
                    container = document.getElementById('ontExtraOutputs');
                } else if (agency === 'ì¥ì²œ') {
                    container = document.getElementById('jangcheonExtraOutputs');
                } else if (agency === 'í•œì˜¬') {
                    container = document.getElementById('hanolExtraOutputs');
                } else if (agency === 'ëŸ­ìŠ¤') {
                    container = document.getElementById('luxExtraOutputs');
                } else if (agency === 'íë¸Œ') {
                    container = document.getElementById('cubeExtraOutputs');
                } else if (agency === 'ì½”ì›¨ì–´') {
                    container = document.getElementById('cowareExtraOutputs');
                } else {
                    container = document.getElementById('luxExtraOutputs');
                }
                
                if (!container) return;
                container.style.display = 'block';

                if (agency === 'ë“œë¸”ë™') {
                    // ë“œë¸”ë™ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    container.innerHTML = `
                        <div class="form-group">
                            <label for="dblackRequestText">ë“œë¸”ë™ ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackRequestText" class="output-textarea compact-textarea">${result.request || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackStockText">ë“œë¸”ë™ ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackStockText" class="output-textarea compact-textarea">${result.stock || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="dblackMemoText">ë“œë¸”ë™ ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="dblackMemoText" class="output-textarea compact-textarea">${result.memo || ''}</textarea>
                        </div>
                    `;
                } else if (agency === 'ì œì´/íœ´ë„·') {
                    // íœ´ë„· ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (3ê°œ textarea)
                    const confirmText = document.getElementById('hunetConfirmText');
                    const deliveryText = document.getElementById('hunetDeliveryText');
                    const openText = document.getElementById('hunetOpenText');
                    
                    if (confirmText) confirmText.value = result.confirm || '';
                    if (deliveryText) deliveryText.value = result.delivery || '';
                    if (openText) openText.value = result.open || '';
                } else if (agency === 'ë°€ë¦¬ì–¸') {
                    // ë°€ë¦¬ì–¸ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const requestText = document.getElementById('millionRequestText');
                    const stockText = document.getElementById('millionStockText');
                    const memoText = document.getElementById('millionMemoText');
                    
                    if (requestText) requestText.value = result.request || '';
                    if (stockText) stockText.value = result.stock || '';
                    if (memoText) memoText.value = result.memo || '';
                } else if (agency === 'ì˜¤ì•¤í‹°') {
                    // ì˜¤ì•¤í‹° ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const requestText = document.getElementById('ontRequestText');
                    const stockText = document.getElementById('ontStockText');
                    const memoText = document.getElementById('ontMemoText');
                    
                    if (requestText) requestText.value = result.request || '';
                    if (stockText) stockText.value = result.delivery || '';
                    if (memoText) memoText.value = result.open || '';
                } else if (agency === 'ì¥ì²œ') {
                    // ì¥ì²œ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬
                    const deliveryText = document.getElementById('jangcheonDeliveryText');
                    const openText = document.getElementById('jangcheonOpenText');
                    
                    if (deliveryText) deliveryText.value = result.delivery || '';
                    if (openText) openText.value = result.open || '';
                } else if (agency === 'í•œì˜¬') {
                    // í•œì˜¬ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (3ê°œ textarea)
                    const confirmText = document.getElementById('hanolConfirmText');
                    const deliveryText = document.getElementById('hanolDeliveryText');
                    const openText = document.getElementById('hanolOpenText');
                    
                    if (confirmText) confirmText.value = result.confirm || '';
                    if (deliveryText) deliveryText.value = result.delivery || '';
                    if (openText) openText.value = result.open || '';
                } else if (agency === 'ëŸ­ìŠ¤') {
                    // ëŸ­ìŠ¤ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (4ê°œ textarea)
                    const requestText = document.getElementById('luxRequestText');
                    const stockText = document.getElementById('luxStockText');
                    const openText = document.getElementById('luxMemoText');
                    const universeText = document.getElementById('luxUniverseText');
                    
                    if (requestText) requestText.value = result.request || '';
                    if (stockText) stockText.value = result.stock || '';
                    if (openText) openText.value = result.open || '';
                    if (universeText) universeText.value = result.universe || '';
                } else if (agency === 'íë¸Œ') {
                    // íë¸Œ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (3ê°œ textarea)
                    const stockText = document.getElementById('cubeStockText');
                    const openText = document.getElementById('cubeOpenText');
                    const universeText = document.getElementById('cubeUniverseText');
                    
                    if (stockText) stockText.value = result.stock || '';
                    if (openText) openText.value = result.open || '';
                    if (universeText) universeText.value = result.universe || '';
                } else if (agency === 'ì½”ì›¨ì–´') {
                    // ì½”ì›¨ì–´ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (2ê°œ textarea)
                    const openText = document.getElementById('cowareOpenText');
                    const spacePassText = document.getElementById('cowareSpacePassText');
                    
                    if (openText) openText.value = result.openRequest || '';
                    if (spacePassText) spacePassText.value = result.spacePass || '';
                } else {
                    // ê¸°íƒ€ ëŒ€ë¦¬ì ìš© ì¶œë ¥ ì²˜ë¦¬ (ê¸°ë³¸ ëŸ­ìŠ¤ í˜•íƒœ)
                    container.innerHTML = `
                        <div class="form-group">
                            <label for="luxRequestText">ì‹ ì¡°ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxRequestText" class="output-textarea compact-textarea">${result.request || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxStockText">ì¬ê³ ìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxStockText" class="output-textarea compact-textarea">${result.stock || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label for="luxMemoText">ê°œí†µìš”ì²­ì–‘ì‹:</label>
                            <textarea id="luxMemoText" class="output-textarea compact-textarea">${result.open || ''}</textarea>
                        </div>
                    `;
                }
            }

            static showTableOutput(result) {
                const container = document.getElementById('keyValueTableContainer');
                if (!container) return;

                container.style.display = 'block';
                // í…Œì´ë¸” ì¶œë ¥ ë¡œì§ êµ¬í˜„ - result.tableDataë¥¼ ì „ë‹¬
                createKeyValueTable(result.tableData || result);
                
                // additionalTextê°€ ìˆìœ¼ë©´ í…Œì´ë¸” ì•„ë˜ì— í‘œì‹œ
                if (result.additionalText) {
                    let additionalTextDiv = document.getElementById('additionalTextDiv');
                    if (!additionalTextDiv) {
                        additionalTextDiv = document.createElement('div');
                        additionalTextDiv.id = 'additionalTextDiv';
                        additionalTextDiv.style.cssText = `
                            margin-top: 20px;
                            padding: 15px;
                            background-color: #f8f9fa;
                            border: 1px solid #e9ecef;
                            border-radius: 5px;
                            white-space: pre-line;
                            font-family: 'Nanum Gothic', sans-serif;
                            line-height: 1.5;
                        `;
                        container.appendChild(additionalTextDiv);
                    }
                    additionalTextDiv.textContent = result.additionalText;
                }
            }

            static showSingleOutput(result) {
                const container = document.getElementById('singleOutputContainer');
                if (!container) return;

                container.style.display = 'block';
                document.getElementById('outputText').value = result;
            }
        }

        // í†µì‹ ì‚¬ ì„ íƒì— ë”°ë¼ ëŒ€ë¦¬ì  ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateAgencies() {
            const telecomSelect = document.getElementById('telecom');
            const agencySelect = document.getElementById('agency');
            const agencyInfoBtn = document.getElementById('agencyInfoBtn');
            
            // ëŒ€ë¦¬ì  ì„ íƒ ì´ˆê¸°í™”
            agencySelect.innerHTML = '<option value="">ëŒ€ë¦¬ì ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            agencySelect.disabled = true;
            agencyInfoBtn.disabled = true;
            
            const selectedTelecom = telecomSelect.value;
            
            if (selectedTelecom) {
                // ì„ íƒëœ í†µì‹ ì‚¬ì— í•´ë‹¹í•˜ëŠ” ëŒ€ë¦¬ì  ëª©ë¡ ì¶”ê°€
                agencies[selectedTelecom].forEach(agency => {
                    const option = document.createElement('option');
                    option.value = agency;
                    option.textContent = agency;
                    agencySelect.appendChild(option);
                });
                
                // ëŒ€ë¦¬ì  ì„ íƒ í™œì„±í™”
                agencySelect.disabled = false;
                agencyInfoBtn.disabled = false;
            }
        }

        // ì–‘ì‹ ë³€í™˜ í•¨ìˆ˜
        function convertFormat() {
            // ì¶œë ¥ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
            const outputContainer = document.getElementById('outputContainer');
            const singleOutputContainer = document.getElementById('singleOutputContainer');
            const splitOutputContainer = document.getElementById('splitOutputContainer');
            const luxExtraOutputs = document.getElementById('luxExtraOutputs');
            const dblackExtraOutputs = document.getElementById('dblackExtraOutputs');
            const actExtraOutputs = document.getElementById('actExtraOutputs');
            const bncomExtraOutputs = document.getElementById('bncomExtraOutputs');
            const hunetExtraOutputs = document.getElementById('hunetExtraOutputs');
            const millionExtraOutputs = document.getElementById('millionExtraOutputs');
            const ontExtraOutputs = document.getElementById('ontExtraOutputs');
            const keyValueTableContainer = document.getElementById('keyValueTableContainer');
            
            // ëª¨ë“  ì¶œë ¥ ì»¨í…Œì´ë„ˆ ìˆ¨ê¸°ê¸° (TextareaManager ì‚¬ìš©)
            if (splitOutputContainer) splitOutputContainer.style.display = 'none';
            if (keyValueTableContainer) keyValueTableContainer.style.display = 'none';
            
            // TextareaManagerë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ExtraOutputs ìˆ¨ê¸°ê¸° ë° textarea ì´ˆê¸°í™”
            TextareaManager.hideAllExtraOutputs();
            TextareaManager.clearAllTextareas();
            
            // ê¸°ë³¸ ì¶œë ¥ ì»¨í…Œì´ë„ˆ í‘œì‹œ
            if (singleOutputContainer) singleOutputContainer.style.display = 'block';
            
            // ëª¨ë“  DOM ìš”ì†Œ ì°¸ì¡° ê°€ì ¸ì˜¤ê¸°
            const agencySelect = document.getElementById('agency');
            const inputText = document.getElementById('inputText');
            const telecomSelect = document.getElementById('telecom');
            const deviceSerialInput = document.getElementById('deviceSerial');
            const simSerialInput = document.getElementById('simSerial');
            
            // ì„ íƒëœ ê°’ ê°€ì ¸ì˜¤ê¸°
            const selectedTelecom = telecomSelect ? telecomSelect.value : '';
            const selectedAgency = agencySelect ? agencySelect.value : '';
            
            // ì…ë ¥ê°’ ê²€ì¦
            if (!selectedTelecom || !selectedAgency) {
                alert('í†µì‹ ì‚¬ì™€ ëŒ€ë¦¬ì ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                // ê³ ê° ì •ë³´ ì¶”ì¶œ
                const customerInfo = extractCustomerInfo(inputText.value || '');
            
            // ë‹¨ë§ê¸° ì¼ë ¨ë²ˆí˜¸ì™€ ìœ ì‹¬ ì¼ë ¨ë²ˆí˜¸ ì¶”ê°€
            if (deviceSerialInput && deviceSerialInput.value.trim()) {
                customerInfo['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] = deviceSerialInput.value.trim();
            }
            if (simSerialInput && simSerialInput.value.trim()) {
                customerInfo['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] = simSerialInput.value.trim();
            }
            
                console.log('ì¶”ì¶œëœ ê³ ê° ì •ë³´:', customerInfo);
                console.table(customerInfo);
                
                // KT ëŒ€ë¦¬ì  ì•½ì • ì²´í¬
                if (selectedTelecom === 'KT') {
                    const ê³µì‹œì„ ì•½ì—¬ë¶€ = customerInfo['ê³µì‹œì„ ì•½ì—¬ë¶€'] || customerInfo['í• ì¸ìœ í˜•'] || '';
                    const ì•½ì •ê°œì›”ìˆ˜ = customerInfo['ì•½ì •ê°œì›”ìˆ˜'] || '';
                    
                    if (ê³µì‹œì„ ì•½ì—¬ë¶€ === 'ì„ íƒì•½ì •' && ì•½ì •ê°œì›”ìˆ˜ === '12ê°œì›”') {
                        alert('KT ëŒ€ë¦¬ì ì€ ì„ íƒì•½ì • 24ê°œì›”ë§Œ ì§„í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì–´ë“œë¯¼ ë©”ëª¨ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
                    }
                }
                
                // í•„ìˆ˜ í•­ëª© ì²´í¬ ë° alert í‘œì‹œ
                const requiredFields = ['ê°€ì…ìœ í˜•', 'í• ì¸ìœ í˜•', 'ìœ ì‹¬', 'ìš”ê¸ˆì œ', 'ì•½ì •ê°œì›”ìˆ˜', 'ìµœì¢…êµ¬ë§¤ê°€', 'ìš©ëŸ‰', 'ëª¨ë¸ì œì¡°ì‚¬', 'í˜„ì¬í†µì‹ ì‚¬'];
                const emptyFields = [];
                
                requiredFields.forEach(field => {
                    if (!customerInfo[field] || customerInfo[field].trim() === '') {
                        emptyFields.push(field);
                    }
                });
                
                // ë¯¸ì„±ë…„ìì¸ ê²½ìš° ë²•ì •ëŒ€ë¦¬ì¸ ì •ë³´ í•„ìˆ˜ ì²´í¬
                if (customerInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] === 'Y') {
                    const guardianFields = ['ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„', 'ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜', 'ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'];
                    const emptyGuardianFields = [];
                    
                    guardianFields.forEach(field => {
                        if (!customerInfo[field] || customerInfo[field].trim() === '') {
                            emptyGuardianFields.push(field);
                        }
                    });
                    
                    if (emptyGuardianFields.length > 0) {
                        const missingGuardianItems = emptyGuardianFields.join(', ');
                        alert(`ë¯¸ì„±ë…„ì ê³ ê°ì…ë‹ˆë‹¤. ë‹¤ìŒ ë²•ì •ëŒ€ë¦¬ì¸ ì •ë³´ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤: ${missingGuardianItems}\n ì–´ë“œë¯¼ ë©”ëª¨ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.`);
                    }
                }
                
                if (emptyFields.length > 0) {
                    const missingItems = emptyFields.join(', ');
                    alert(`ë‹¤ìŒ í•­ëª©ë“¤ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤: ${missingItems}\n ì–´ë“œë¯¼ ë©”ëª¨ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.`);
                }
                
                // ìƒˆë¡œìš´ êµ¬ì¡°ì˜ í…œí”Œë¦¿ ì‹œìŠ¤í…œ ì‚¬ìš© ì‹œë„
                let result;
                let outputType;
                
                if (TELECOM_CONFIG[selectedTelecom]?.agencies[selectedAgency]) {
                    // ìƒˆë¡œìš´ êµ¬ì¡° ì‚¬ìš©
                    const agencyConfig = TELECOM_CONFIG[selectedTelecom].agencies[selectedAgency];
                    result = TemplateManager.applyTemplate(selectedTelecom, selectedAgency, customerInfo);
                    outputType = agencyConfig.outputType;
                    
                    // ê²°ê³¼ ì¶œë ¥
                    OutputManager.showOutput(result, outputType, selectedTelecom, selectedAgency);
                } else {
                    // TELECOM_CONFIGì— ì—†ëŠ” ëŒ€ë¦¬ì ì€ ì˜¤ë¥˜ ì²˜ë¦¬
                    throw new Error(`ì„ íƒí•˜ì‹  ëŒ€ë¦¬ì  (${selectedAgency})ì— ëŒ€í•œ í…œí”Œë¦¿ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. TELECOM_CONFIGì— ì¶”ê°€ê°€ í•„ìš”í•©ë‹ˆë‹¤.`);
                }
                
                // ë³€í™˜ ì´ë ¥ ì €ì¥ (HistoryManager ì‚¬ìš©)
                if (HistoryManager && HistoryManager.saveToHistory) {
                    HistoryManager.saveToHistory(customerInfo, selectedTelecom, selectedAgency);
                }
                    
                    // ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
                    setupDoubleClickCopy();
                
            } catch (error) {
                console.error('ë³€í™˜ ì¤‘ ì˜¤ë¥˜:', error);
                alert('ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
        
        // í‚¤-ê°’ í…Œì´ë¸” ìƒì„± í•¨ìˆ˜
        function createKeyValueTable(customerInfo) {
            const tableBody = document.querySelector('#keyValueTable tbody');
            tableBody.innerHTML = ''; // í…Œì´ë¸” ì´ˆê¸°í™”
            
            // í˜„ì¬ ì„ íƒëœ ëŒ€ë¦¬ì  í™•ì¸
            const agencySelect = document.getElementById('agency');
            const selectedAgency = agencySelect ? agencySelect.value : '';
            
            // ê¸°ë³¸ ì •ë³´ ì²˜ë¦¬ (ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ê°’ ì„ íƒ)
            const processedInfo = {
                'ê°€ì…ìëª…': customerInfo['ê°€ì…ìëª…'] || customerInfo['ê³ ê°ëª…'] || '',
                'ê°œí†µë²ˆí˜¸': customerInfo['ê°œí†µë²ˆí˜¸'] || customerInfo['ì „í™”ë²ˆí˜¸'] || '',
                'ì£¼ë¯¼ë²ˆí˜¸': customerInfo['ì£¼ë¯¼ë²ˆí˜¸'] || customerInfo['ìƒë…„ì›”ì¼'] || '',
                'ëª¨ë¸ëª…': customerInfo['ëª¨ë¸ëª…'] || '',
                'ìš©ëŸ‰': customerInfo['ìš©ëŸ‰'] || '',
                'ìƒ‰ìƒ': customerInfo['ìƒ‰ìƒ'] || '',
                'ê°€ì…ìœ í˜•': customerInfo['ê°€ì…ìœ í˜•'] || '',
                'í• ì¸ìœ í˜•': customerInfo['í• ì¸ìœ í˜•'] || '',
                'ì•½ì •ê°œì›”ìˆ˜': customerInfo['ì•½ì •ê°œì›”ìˆ˜'] || '',
                'ìš”ê¸ˆì œ': customerInfo['ìš”ê¸ˆì œ'] || '',
                'í• ë¶€í˜„ê¸ˆì—¬ë¶€': customerInfo['í• ë¶€í˜„ê¸ˆì—¬ë¶€'] || '',
                'í• ë¶€ê°œì›”ìˆ˜': customerInfo['í• ë¶€ê°œì›”ìˆ˜'] || '',
                'í˜„ì¬í†µì‹ ì‚¬': customerInfo['í˜„ì¬í†µì‹ ì‚¬'] || '',
                'ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸': customerInfo['ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸'] || '',
                'ìœ ì‹¬': customerInfo['ìœ ì‹¬'] || '',
                'ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸': customerInfo['ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'] || '',
                'ì¶œê³ ê°€': customerInfo['ì¶œê³ ê°€'] || '',
                'ê³µì‹œì§€ì›ê¸ˆ': customerInfo['ê³µì‹œ'] || '',
                'ì¶”ê°€ì§€ì›ê¸ˆ': customerInfo['ì¶”ì§€'] || '',
                'ì „í™˜ì§€ì›ê¸ˆ': customerInfo['ì „í™˜ì§€ì›ê¸ˆ'] || '',
                'í”„ë¦¬í• ë¶€': customerInfo['í”„ë¦¬í• ë¶€'] || '',
                'ìµœì¢…êµ¬ë§¤ê°€': customerInfo['ìµœì¢…êµ¬ë§¤ê°€'] || '',
                'ë¶€ê°€ì„œë¹„ìŠ¤': customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤'] || '',
                'ë¶€ê°€ì„œë¹„ìŠ¤2': customerInfo['ë¶€ê°€ì„œë¹„ìŠ¤2'] || '',
                'ë³´í—˜': customerInfo['ë³´í—˜'] || '',
                'ë°°ì†¡ì£¼ì†Œì§€': customerInfo['ë°°ì†¡ì£¼ì†Œì§€'] || customerInfo['íƒë°°ì£¼ì†Œ'] || '',
                'ë¯¸ì„±ë…„ìì—¬ë¶€': customerInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„'] || customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ëª…'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜'] || '',
                'ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸': customerInfo['ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'] || ''
            };
            
            // í…Œì´ë¸”ì— í‘œì‹œí•  í•„ë“œ ìˆœì„œ ì •ì˜
            const basicFields = [
                'ê°€ì…ìëª…', 'ê°œí†µë²ˆí˜¸', 'ì£¼ë¯¼ë²ˆí˜¸', 'ëª¨ë¸ëª…', 'ìš©ëŸ‰', 'ìƒ‰ìƒ',
                'ê°€ì…ìœ í˜•', 'í• ì¸ìœ í˜•', 'ì•½ì •ê°œì›”ìˆ˜', 'ìš”ê¸ˆì œ', 
                'í• ë¶€í˜„ê¸ˆì—¬ë¶€', 'í• ë¶€ê°œì›”ìˆ˜', 'í˜„ì¬í†µì‹ ì‚¬'
            ];
            
            const deviceFields = [
                'ë‹¨ë§ê¸°ì¼ë ¨ë²ˆí˜¸', 'ìœ ì‹¬', 'ìœ ì‹¬ì¼ë ¨ë²ˆí˜¸'
            ];
            
            const priceFields = [
                'ì¶œê³ ê°€', 'ê³µì‹œì§€ì›ê¸ˆ', 'ì¶”ê°€ì§€ì›ê¸ˆ', 'ì „í™˜ì§€ì›ê¸ˆ', 
                'í”„ë¦¬í• ë¶€', 'ìµœì¢…êµ¬ë§¤ê°€'
            ];
            
            const additionalFields = [
                'ë¶€ê°€ì„œë¹„ìŠ¤', 'ë¶€ê°€ì„œë¹„ìŠ¤2', 'ë³´í—˜', 'ë°°ì†¡ì£¼ì†Œì§€'
            ];
            
            const minorFields = [
                'ë¯¸ì„±ë…„ìì—¬ë¶€', 'ë²•ì •ëŒ€ë¦¬ì¸ì´ë¦„', 'ë²•ì •ëŒ€ë¦¬ì¸ì—°ë½ì²˜', 'ë²•ì •ëŒ€ë¦¬ì¸ì£¼ë¯¼ë²ˆí˜¸'
            ];
            
            // ê¸°ë³¸ ì •ë³´ í•„ë“œ ì¶”ê°€
            basicFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ë‹¨ë§ê¸° ì •ë³´ í•„ë“œ ì¶”ê°€
            deviceFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ê°€ê²© ì •ë³´ í•„ë“œ ì¶”ê°€ (ë¹ˆ ê°’ì´ì–´ë„ í‘œì‹œ)
            priceFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                addTableRow(tableBody, fieldName, value || '');
            });
            
            // ì¶”ê°€ ì •ë³´ í•„ë“œ ì¶”ê°€
            additionalFields.forEach(fieldName => {
                const value = processedInfo[fieldName];
                if (value !== undefined && value !== null && value !== '') {
                    addTableRow(tableBody, fieldName, value);
                }
            });
            
            // ë¯¸ì„±ë…„ìì¸ ê²½ìš° ë²•ì •ëŒ€ë¦¬ì¸ ì •ë³´ ì¶”ê°€
            if (processedInfo['ë¯¸ì„±ë…„ìì—¬ë¶€'] === 'Y') {
                minorFields.forEach(fieldName => {
                    const value = processedInfo[fieldName];
                    if (value !== undefined && value !== null && value !== '') {
                        addTableRow(tableBody, fieldName, value);
                    }
                });
            }
            
            // ì¶”ê°€ í…Œì´ë¸” ì•ˆë‚´ë¬¸ í‘œì‹œ
            const copyNoticeDiv = document.querySelector('.copy-notice');
            if (copyNoticeDiv) {
                copyNoticeDiv.textContent = `${selectedAgency} - ê° í•­ëª©ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê°’ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.`;
            }
        }
        
        // í‚¤-ê°’ í…Œì´ë¸”ì— í–‰ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
        function addTableRow(tableBody, key, value) {
            const row = document.createElement('tr');
            
            const keyCell = document.createElement('td');
            keyCell.className = 'key-cell';
            keyCell.textContent = key;
            
            const valueCell = document.createElement('td');
            valueCell.className = 'value-cell';
            valueCell.textContent = value;
            valueCell.setAttribute('data-value', value);
            valueCell.onclick = function() {
                copyToClipboardWithFeedback(this.getAttribute('data-value'), this);
            };
            
            row.appendChild(keyCell);
            row.appendChild(valueCell);
            tableBody.appendChild(row);
        }
        
        
        
        // ë³€í™˜ ì´ë ¥ ê´€ë ¨ í•¨ìˆ˜ë“¤ì€ HistoryManagerì—ì„œ ê´€ë¦¬ë©ë‹ˆë‹¤.
        
        // ëŒ€ë¦¬ì  ì •ë³´ íŒì—… í•¨ìˆ˜
        function showAgencyInfo() {
            const telecomSelect = document.getElementById('telecom');
            const agencySelect = document.getElementById('agency');
            const selectedTelecom = telecomSelect.value;
            const selectedAgency = agencySelect.value;
            
            if (!selectedTelecom || !selectedAgency) {
                alert('í†µì‹ ì‚¬ì™€ ëŒ€ë¦¬ì ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const popup = document.getElementById('memoPopup');
            const popupTitle = document.getElementById('popupTitle');
            const popupContent = document.getElementById('memoContent');
            
            // íŒì—… ì œëª© ì„¤ì •
            popupTitle.textContent = `${selectedAgency} ì—…ë¬´ ë©”ëª¨`;
            
            // íŒì—… ë‚´ìš© ì„¤ì •
            if (agencyMemos[selectedTelecom] && agencyMemos[selectedTelecom][selectedAgency]) {
                popupContent.textContent = agencyMemos[selectedTelecom][selectedAgency];
            } else {
                popupContent.textContent = 'í•´ë‹¹ ëŒ€ë¦¬ì ì— ëŒ€í•œ ì—…ë¬´ ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.';
            }
            
            // íŒì—… í‘œì‹œ
            popup.style.display = 'flex';
        }
        
        // ëŒ€ë¦¬ì  ì •ë³´ íŒì—… ë‹«ê¸° í•¨ìˆ˜
        function closeAgencyInfo() {
            const popup = document.getElementById('memoPopup');
            popup.style.display = 'none';
        }
        // ESC í‚¤ë¡œ íŒì—… ë‹«ê¸°
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeAgencyInfo();
                if (HistoryManager && HistoryManager.closeHistoryPopup) {
                    HistoryManager.closeHistoryPopup();
                }
            }
        });
        
        // íŒì—… ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('memoPopup').addEventListener('click', function(event) {
            if (event.target === this) {
                closeAgencyInfo();
            }
        });
        
        // ì´ë ¥ íŒì—… ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('historyPopup').addEventListener('click', function(event) {
            if (event.target === this) {
                if (HistoryManager && HistoryManager.closeHistoryPopup) {
                    HistoryManager.closeHistoryPopup();
                }
            }
        });     


        
        // utils.jsì—ì„œ ì œê³µí•˜ëŠ” í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
        if (typeof initializeModelDatabase === 'function') {
            initializeModelDatabase();
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ìë™ ì ê¸ˆ ê¸°ëŠ¥ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            // ë©”ì¸ ì½˜í…ì¸ ê°€ í‘œì‹œëœ ìƒíƒœì¼ ë•Œë§Œ ìë™ ì ê¸ˆ ì‹œì‘
            const mainContent = document.querySelector('.main-content');
            const passwordModal = document.getElementById('passwordModal');
            
            if (mainContent && mainContent.style.display !== 'none' && 
                passwordModal && passwordModal.style.display === 'none') {
                // ìë™ ì ê¸ˆ ë§¤ë‹ˆì € ì‹œì‘
                autoLockManager = new AutoLockManager();
                console.log(`ìë™ ì ê¸ˆ ê¸°ëŠ¥ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. (${AUTO_LOCK_TIMEOUT_MINUTES}ë¶„ í›„ ìë™ ì ê¸ˆ)`);
            }
        });
        
        document.addEventListener('DOMContentLoaded', function() {
            // ì´ˆê¸° í…ìŠ¤íŠ¸ì—ë¦¬ì–´ì— ë”ë¸”í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
            setupDoubleClickCopy();
            
            // ì¶œì‹œìƒ‰ìƒ ê²€ìƒ‰ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const searchInput = document.getElementById('modelSearch');
            const searchResults = document.getElementById('modelSearchResults');
            
            if (searchInput) {
                // ì…ë ¥ ì´ë²¤íŠ¸
                searchInput.addEventListener('input', (e) => {
                    const results = searchModelColors(e.target.value);
                    displayModelColorResults(results);
                });
                
                // í¬ì»¤ìŠ¤ ì•„ì›ƒ ì‹œ ì•½ê°„ì˜ ì§€ì—° í›„ ê²°ê³¼ì°½ ìˆ¨ê¸°ê¸°
                searchInput.addEventListener('blur', () => {
                    setTimeout(() => {
                        searchResults.style.display = 'none';
                    }, 200);
                });
                
                // ì™¸ë¶€ í´ë¦­ ì‹œ ê²°ê³¼ì°½ ìˆ¨ê¸°ê¸°
                document.addEventListener('click', (e) => {
                    if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                        searchResults.style.display = 'none';
                    }
                });
            }
            
            // ì´ˆê¸°í™” ë©”ì‹œì§€ ì¶”ê°€
            const outputText = document.getElementById('outputText');
            if (outputText) {
                outputText.placeholder = 'ì—¬ê¸°ì— ë³€í™˜ëœ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤. ë”ë¸”í´ë¦­í•˜ë©´ ë³µì‚¬ë©ë‹ˆë‹¤.';
                // í´ë˜ìŠ¤ ì¶”ê°€
                outputText.classList.add('output-textarea');
            }
            
            // ì…ë ¥ í…ìŠ¤íŠ¸ì—ë¦¬ì–´ì— í´ë˜ìŠ¤ ì¶”ê°€
            const inputText = document.getElementById('inputText');
            if (inputText) {
                inputText.classList.add('input-textarea');
            }
        });

        function setupEventListeners() {
            document.getElementById('convertBtn').addEventListener('click', handleConvert);
            document.getElementById('copyBtn').addEventListener('click', handleCopy);
            document.getElementById('clearBtn').addEventListener('click', handleClear);
            
            // ì´ë²¤íŠ¸ ìœ„ì„ ì‚¬ìš©
            document.getElementById('outputContainer').addEventListener('dblclick', handleDoubleClick);
        }
        // ì´ë²¤íŠ¸ ê´€ë¦¬ í´ë˜ìŠ¤
        class EventManager {
            static init() {
                this.setupTelecomEvents();
                this.setupAgencyEvents();
                this.setupConversionEvents();
                this.setupCopyEvents();
            }

            static setupTelecomEvents() {
                const telecomSelect = document.getElementById('telecom');
                if (telecomSelect) {
                    telecomSelect.addEventListener('change', () => {
                        updateAgencies();
                        this.clearOutputs();
                    });
                }
            }

            static setupAgencyEvents() {
                const agencySelect = document.getElementById('agency');
                if (agencySelect) {
                    agencySelect.addEventListener('change', () => {
                        const agencyInfoBtn = document.getElementById('agencyInfoBtn');
                        if (agencyInfoBtn) {
                            agencyInfoBtn.disabled = !agencySelect.value;
                        }
                        this.clearOutputs();
                    });
                }
            }

            static setupConversionEvents() {
                const convertBtn = document.getElementById('convertBtn');
                if (convertBtn) {
                    convertBtn.addEventListener('click', () => {
                        convertFormat();
                    });
                }
            }

            static setupCopyEvents() {
                const copyBtn = document.getElementById('copyBtn');
                if (copyBtn) {
                    copyBtn.addEventListener('click', () => {
                        handleCopy();
                    });
                }
            }

            static clearOutputs() {
                OutputManager.hideAllContainers();
            }
        }



        // ìë™ ì ê¸ˆ ê¸°ëŠ¥ í´ë˜ìŠ¤
        class AutoLockManager {
            constructor(timeoutMinutes = AUTO_LOCK_TIMEOUT_MINUTES) { // ìƒìˆ˜ ì‚¬ìš©
                this.timeoutDuration = timeoutMinutes * 60 * 1000; // ë°€ë¦¬ì´ˆë¡œ ë³€í™˜
                this.timeoutId = null;
                this.isLocked = false;
                this.lastActivityTime = Date.now();
                
                // í™œë™ ê°ì§€ ì´ë²¤íŠ¸ë“¤
                this.activityEvents = [
                    'mousedown', 'mousemove', 'keypress', 'scroll', 
                    'touchstart', 'click', 'keydown', 'input', 'change'
                ];
                
                this.init();
            }
            
            init() {
                console.log(`ìë™ ì ê¸ˆ ê¸°ëŠ¥ ì´ˆê¸°í™”: ${this.timeoutDuration / 60000}ë¶„ í›„ ìë™ ì ê¸ˆ`);
                this.setupActivityListeners();
                this.startTimer();
            }
            
            setupActivityListeners() {
                // ëª¨ë“  í™œë™ ì´ë²¤íŠ¸ì— ëŒ€í•´ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
                this.activityEvents.forEach(event => {
                    document.addEventListener(event, () => {
                        this.resetTimer();
                    }, true);
                });
                
                // ì°½ í¬ì»¤ìŠ¤ ì´ë²¤íŠ¸ë„ ì¶”ê°€
                window.addEventListener('focus', () => {
                    this.resetTimer();
                });
            }
            
            startTimer() {
                this.clearTimer();
                this.timeoutId = setTimeout(() => {
                    this.lockApplication();
                }, this.timeoutDuration);
                
                this.lastActivityTime = Date.now();
            }
            
            resetTimer() {
                if (!this.isLocked) {
                    this.startTimer();
                }
            }
            
            clearTimer() {
                if (this.timeoutId) {
                    clearTimeout(this.timeoutId);
                    this.timeoutId = null;
                }
            }
            
            lockApplication() {
                console.log('ìë™ ì ê¸ˆ í™œì„±í™”: ì¼ì • ì‹œê°„ ë™ì•ˆ í™œë™ì´ ì—†ì–´ ì ê¸ˆ ì²˜ë¦¬ë©ë‹ˆë‹¤.');
                this.isLocked = true;
                this.clearTimer();
                
                // ë©”ì¸ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
                const mainContent = document.querySelector('.main-content');
                if (mainContent) {
                    mainContent.style.display = 'none';
                }
                
                // ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ í‘œì‹œ
                const passwordModal = document.getElementById('passwordModal');
                if (passwordModal) {
                    passwordModal.style.display = 'flex';
                    
                    // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™” ë° í¬ì»¤ìŠ¤
                    const passwordInput = document.getElementById('passwordInput');
                    if (passwordInput) {
                        passwordInput.value = '';
                        passwordInput.focus();
                    }
                    
                    // ì—ëŸ¬ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
                    const passwordError = document.getElementById('passwordError');
                    if (passwordError) {
                        passwordError.style.display = 'none';
                    }
                }
                
                // ì ê¸ˆ ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ (ì„ íƒì‚¬í•­)
                this.showLockNotification();
            }
            
            unlockApplication() {
                console.log('ìë™ ì ê¸ˆ í•´ì œ: ì •ìƒì ìœ¼ë¡œ ì ê¸ˆì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                this.isLocked = false;
                this.startTimer(); // íƒ€ì´ë¨¸ ì¬ì‹œì‘
            }
            
            showLockNotification() {
                // ì„ì‹œ ì•Œë¦¼ div ìƒì„±
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #f44336;
                    color: white;
                    padding: 15px 20px;
                    border-radius: 5px;
                    z-index: 10000;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
                    font-size: 14px;
                    font-weight: bold;
                `;
                notification.textContent = 'ë³´ì•ˆì„ ìœ„í•´ ìë™ìœ¼ë¡œ ì ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤.';
                
                document.body.appendChild(notification);
                
                // 3ì´ˆ í›„ ì•Œë¦¼ ì œê±°
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 3000);
            }
            
            // íƒ€ì„ì•„ì›ƒ ì‹œê°„ ë³€ê²½ ë©”ì„œë“œ
            setTimeoutDuration(minutes) {
                this.timeoutDuration = minutes * 60 * 1000;
                console.log(`ìë™ ì ê¸ˆ ì‹œê°„ì´ ${minutes}ë¶„ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                if (!this.isLocked) {
                    this.startTimer(); // ìƒˆë¡œìš´ ì‹œê°„ìœ¼ë¡œ íƒ€ì´ë¨¸ ì¬ì‹œì‘
                }
            }
            
            // ë‚¨ì€ ì‹œê°„ í™•ì¸ ë©”ì„œë“œ (ë””ë²„ê¹…ìš©)
            getRemainingTime() {
                if (this.isLocked) return 0;
                const elapsed = Date.now() - this.lastActivityTime;
                const remaining = Math.max(0, this.timeoutDuration - elapsed);
                return Math.ceil(remaining / 1000); // ì´ˆ ë‹¨ìœ„ë¡œ ë°˜í™˜
            }
        }
        
        // ì „ì—­ ìë™ ì ê¸ˆ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (í˜ì´ì§€ ë¡œë“œ í›„)
        let autoLockManager = null;
        
        // ìë™ ì ê¸ˆ ì‹œê°„ ì„¤ì • í•¨ìˆ˜ (ì½˜ì†”ì—ì„œ ì‚¬ìš©)
        function setAutoLockTime(minutes) {
            if (autoLockManager) {
                autoLockManager.setTimeoutDuration(minutes);
                return `ìë™ ì ê¸ˆ ì‹œê°„ì´ ${minutes}ë¶„ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`;
            } else {
                return 'ìë™ ì ê¸ˆ ë§¤ë‹ˆì €ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
            }
        }
        
        // ìë™ ì ê¸ˆ ìƒíƒœ í™•ì¸ í•¨ìˆ˜ (ì½˜ì†”ì—ì„œ ì‚¬ìš©)
        function getAutoLockStatus() {
            if (autoLockManager) {
                const remaining = autoLockManager.getRemainingTime();
                const minutes = Math.floor(remaining / 60);
                const seconds = remaining % 60;
                return {
                    isLocked: autoLockManager.isLocked,
                    remainingTime: `${minutes}ë¶„ ${seconds}ì´ˆ`,
                    remainingSeconds: remaining
                };
            } else {
                return 'ìë™ ì ê¸ˆ ë§¤ë‹ˆì €ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
            }
        }
        
        // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ
        window.setAutoLockTime = setAutoLockTime;
        window.getAutoLockStatus = getAutoLockStatus;
    </script>
    </div> <!-- main-content ë‹«ëŠ” íƒœê·¸ -->
</body>
</html>
